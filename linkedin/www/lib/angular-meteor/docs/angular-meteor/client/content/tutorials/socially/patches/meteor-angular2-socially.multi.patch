From 25e919cb653a7379a2891b4856925c72e7068ffd Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 16:57:38 +0300
Subject: [PATCH 001/166] Creates tutorial app.

---
 .meteor/.finished-upgraders | 12 +++++++++
 .meteor/.id                 |  7 +++++
 .meteor/packages            | 20 ++++++++++++++
 .meteor/platforms           |  2 ++
 .meteor/release             |  1 +
 .meteor/versions            | 66 +++++++++++++++++++++++++++++++++++++++++++++
 6 files changed, 108 insertions(+)
 create mode 100644 .meteor/.finished-upgraders
 create mode 100644 .meteor/.id
 create mode 100644 .meteor/packages
 create mode 100644 .meteor/platforms
 create mode 100644 .meteor/release
 create mode 100644 .meteor/versions

diff --git a/.meteor/.finished-upgraders b/.meteor/.finished-upgraders
new file mode 100644
index 0000000..61ee313
--- /dev/null
+++ b/.meteor/.finished-upgraders
@@ -0,0 +1,12 @@
+# This file contains information which helps Meteor properly upgrade your
+# app when you run 'meteor update'. You should check it into version control
+# with your project.
+
+notices-for-0.9.0
+notices-for-0.9.1
+0.9.4-platform-file
+notices-for-facebook-graph-api-2
+1.2.0-standard-minifiers-package
+1.2.0-meteor-platform-split
+1.2.0-cordova-changes
+1.2.0-breaking-changes
diff --git a/.meteor/.id b/.meteor/.id
new file mode 100644
index 0000000..7969a61
--- /dev/null
+++ b/.meteor/.id
@@ -0,0 +1,7 @@
+# This file contains a token that is unique to your project.
+# Check it into your repository along with the rest of this directory.
+# It can be used for purposes such as:
+#   - ensuring you don't accidentally deploy one app on top of another
+#   - providing package authors with aggregated statistics
+
+pk1ynrhdqnbzrnlqkz
diff --git a/.meteor/packages b/.meteor/packages
new file mode 100644
index 0000000..a9f8340
--- /dev/null
+++ b/.meteor/packages
@@ -0,0 +1,20 @@
+# Meteor packages used by this project, one per line.
+# Check this file (and the other files in this directory) into your repository.
+#
+# 'meteor add' and 'meteor remove' will edit this file for you,
+# but you can also edit it by hand.
+
+meteor-base             # Packages every Meteor app needs to have
+mobile-experience       # Packages for a great mobile UX
+mongo                   # The database Meteor supports right now
+blaze-html-templates    # Compile .html files into Meteor Blaze views
+session                 # Client-side reactive dictionary for your app
+jquery                  # Helpful client-side library
+tracker                 # Meteor's client-side reactive programming library
+
+standard-minifiers      # JS/CSS minifiers run for production mode
+es5-shim                # ECMAScript 5 compatibility for older browsers.
+ecmascript              # Enable ECMAScript2015+ syntax in app code
+
+autopublish             # Publish all data to the clients (for prototyping)
+insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/platforms b/.meteor/platforms
new file mode 100644
index 0000000..efeba1b
--- /dev/null
+++ b/.meteor/platforms
@@ -0,0 +1,2 @@
+server
+browser
diff --git a/.meteor/release b/.meteor/release
new file mode 100644
index 0000000..3a05e0a
--- /dev/null
+++ b/.meteor/release
@@ -0,0 +1 @@
+METEOR@1.2.1
diff --git a/.meteor/versions b/.meteor/versions
new file mode 100644
index 0000000..e378b68
--- /dev/null
+++ b/.meteor/versions
@@ -0,0 +1,66 @@
+autopublish@1.0.4
+autoupdate@1.2.3
+babel-compiler@5.8.24_1
+babel-runtime@0.1.4
+base64@1.0.4
+binary-heap@1.0.4
+blaze@2.1.3
+blaze-html-templates@1.0.1
+blaze-tools@1.0.4
+boilerplate-generator@1.0.4
+caching-compiler@1.0.0
+caching-html-compiler@1.0.1
+callback-hook@1.0.4
+check@1.0.6
+ddp@1.2.2
+ddp-client@1.2.1
+ddp-common@1.2.1
+ddp-server@1.2.1
+deps@1.0.9
+diff-sequence@1.0.1
+ecmascript@0.1.4
+ecmascript-collections@0.1.6
+ejson@1.0.7
+es5-shim@4.1.13
+fastclick@1.0.7
+geojson-utils@1.0.4
+hot-code-push@1.0.0
+html-tools@1.0.5
+htmljs@1.0.5
+http@1.1.1
+id-map@1.0.4
+insecure@1.0.4
+jquery@1.11.4
+launch-screen@1.0.4
+livedata@1.0.15
+logging@1.0.8
+meteor@1.1.7
+meteor-base@1.0.1
+minifiers@1.1.7
+minimongo@1.0.9
+mobile-experience@1.0.1
+mobile-status-bar@1.0.6
+mongo@1.1.1
+mongo-id@1.0.1
+npm-mongo@1.4.39_1
+observe-sequence@1.0.7
+ordered-dict@1.0.4
+promise@0.4.8
+random@1.0.4
+reactive-dict@1.1.1
+reactive-var@1.0.6
+reload@1.1.4
+retry@1.0.4
+routepolicy@1.0.6
+session@1.1.1
+spacebars@1.0.7
+spacebars-compiler@1.0.7
+standard-minifiers@1.0.0
+templating@1.1.3
+templating-tools@1.0.0
+tracker@1.0.8
+ui@1.0.8
+underscore@1.0.4
+url@1.0.5
+webapp@1.2.2
+webapp-hashing@1.0.5
-- 
2.5.4 (Apple Git-61)


From 379c8ad86a432ce76828dbbbb1704562539b900a Mon Sep 17 00:00:00 2001
From: Alex <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:01:41 +0300
Subject: [PATCH 002/166] Create README.md

---
 README.md | 2 ++
 1 file changed, 2 insertions(+)
 create mode 100644 README.md

diff --git a/README.md b/README.md
new file mode 100644
index 0000000..61fc3ee
--- /dev/null
+++ b/README.md
@@ -0,0 +1,2 @@
+# Angular2-Meteor Tutorial
+Tutorial is based on building Angular2 UI for a Meteor app called Socially.
-- 
2.5.4 (Apple Git-61)


From abbfd6305db554c8a0a92a6c37ad4f1420fc2fef Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:03:11 +0300
Subject: [PATCH 003/166] Step 0.1: add client/index.html

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.5.4 (Apple Git-61)


From b2a89ee6e4b5d8ee867e1ecd9742148ac6956d06 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:08:36 +0300
Subject: [PATCH 004/166] Step 0.2: add Angular2 package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..feb8272 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+urigo:angular2-meteor
-- 
2.5.4 (Apple Git-61)


From 544c87066bf4a3209bd57361dc054c1f0e8fcc57 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:09:47 +0300
Subject: [PATCH 005/166] Step 0.3: remove Blaze package

---
 .meteor/packages | 1 -
 1 file changed, 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index feb8272..c70808e 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -7,7 +7,6 @@
 meteor-base             # Packages every Meteor app needs to have
 mobile-experience       # Packages for a great mobile UX
 mongo                   # The database Meteor supports right now
-blaze-html-templates    # Compile .html files into Meteor Blaze views
 session                 # Client-side reactive dictionary for your app
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
-- 
2.5.4 (Apple Git-61)


From 4d40e0b1787b59da598fc752d1426fefa0173015 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:10:32 +0300
Subject: [PATCH 006/166] Step 0.4: remove ecmascript package

---
 .meteor/packages | 1 -
 1 file changed, 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index c70808e..2f89e25 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -13,7 +13,6 @@ tracker                 # Meteor's client-side reactive programming library
 
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
-ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
-- 
2.5.4 (Apple Git-61)


From 1e7db5b17c10b2f0992ac3d911948fd3d0d5d138 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:12:43 +0300
Subject: [PATCH 007/166] Step 0.5: create root component

---
 client/app.ts | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 client/app.ts

diff --git a/client/app.ts b/client/app.ts
new file mode 100644
index 0000000..687ed8d
--- /dev/null
+++ b/client/app.ts
@@ -0,0 +1,13 @@
+import {Component, View} from 'angular2/core';
+
+import {bootstrap} from 'angular2/platform/browser';
+
+@Component({
+    selector: 'app'
+})
+@View({
+    template: 'Hello World!'
+})
+class Socially { }
+
+bootstrap(Socially);
-- 
2.5.4 (Apple Git-61)


From 32228ff47c46b3a47289811cd3c964161890bacc Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:14:08 +0300
Subject: [PATCH 008/166] Step 0.6: load root component

---
 client/index.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index ef412ef..19d3bf1 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,4 @@
 <body>
-  <p>Nothing here</p>
+  <app></app>
+  <script>System.import('client/app');</script>
 </body>
-- 
2.5.4 (Apple Git-61)


From 80969a0f781449fa529c8e2b32eba34f62a93525 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:19:17 +0300
Subject: [PATCH 009/166] Step 0.7: remove index.html

---
 client/index.html | 4 ----
 1 file changed, 4 deletions(-)
 delete mode 100644 client/index.html

diff --git a/client/index.html b/client/index.html
deleted file mode 100644
index 19d3bf1..0000000
--- a/client/index.html
+++ /dev/null
@@ -1,4 +0,0 @@
-<body>
-  <app></app>
-  <script>System.import('client/app');</script>
-</body>
-- 
2.5.4 (Apple Git-61)


From 35060d963627ce8dce2f5cb3842f6db6309aaf44 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 6 Jan 2016 17:14:37 +0700
Subject: [PATCH 010/166] Step 0.8: add tsconfig.json with the typings

---
 tsconfig.json | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 tsconfig.json

diff --git a/tsconfig.json b/tsconfig.json
new file mode 100644
index 0000000..45aafe9
--- /dev/null
+++ b/tsconfig.json
@@ -0,0 +1,5 @@
+{
+  "files": [
+    "typings/angular2-meteor/angular2-meteor.d.ts"
+  ]
+}
-- 
2.5.4 (Apple Git-61)


From d552367dc3b6ac0a0d91814c81d341485559e1b2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 2 Feb 2016 15:46:45 +0700
Subject: [PATCH 011/166] Step 0.9: add main.d.ts to the config

---
 tsconfig.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tsconfig.json b/tsconfig.json
index 45aafe9..d32f0a4 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,5 +1,6 @@
 {
   "files": [
+    "typings/main.d.ts",
     "typings/angular2-meteor/angular2-meteor.d.ts"
   ]
 }
-- 
2.5.4 (Apple Git-61)


From 1dafe592edbd3870007c2f30a40239f2272307e7 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:21:40 +0300
Subject: [PATCH 012/166] Step 0.10: create app.html template

---
 client/app.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/app.html

diff --git a/client/app.html b/client/app.html
new file mode 100644
index 0000000..a9c8ddc
--- /dev/null
+++ b/client/app.html
@@ -0,0 +1 @@
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.5.4 (Apple Git-61)


From 58d1e1aa42f6580ac066a389af2ec017e18afe79 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:22:33 +0300
Subject: [PATCH 013/166] remove versions

---
 .meteor/versions | 66 --------------------------------------------------------
 1 file changed, 66 deletions(-)
 delete mode 100644 .meteor/versions

diff --git a/.meteor/versions b/.meteor/versions
deleted file mode 100644
index e378b68..0000000
--- a/.meteor/versions
+++ /dev/null
@@ -1,66 +0,0 @@
-autopublish@1.0.4
-autoupdate@1.2.3
-babel-compiler@5.8.24_1
-babel-runtime@0.1.4
-base64@1.0.4
-binary-heap@1.0.4
-blaze@2.1.3
-blaze-html-templates@1.0.1
-blaze-tools@1.0.4
-boilerplate-generator@1.0.4
-caching-compiler@1.0.0
-caching-html-compiler@1.0.1
-callback-hook@1.0.4
-check@1.0.6
-ddp@1.2.2
-ddp-client@1.2.1
-ddp-common@1.2.1
-ddp-server@1.2.1
-deps@1.0.9
-diff-sequence@1.0.1
-ecmascript@0.1.4
-ecmascript-collections@0.1.6
-ejson@1.0.7
-es5-shim@4.1.13
-fastclick@1.0.7
-geojson-utils@1.0.4
-hot-code-push@1.0.0
-html-tools@1.0.5
-htmljs@1.0.5
-http@1.1.1
-id-map@1.0.4
-insecure@1.0.4
-jquery@1.11.4
-launch-screen@1.0.4
-livedata@1.0.15
-logging@1.0.8
-meteor@1.1.7
-meteor-base@1.0.1
-minifiers@1.1.7
-minimongo@1.0.9
-mobile-experience@1.0.1
-mobile-status-bar@1.0.6
-mongo@1.1.1
-mongo-id@1.0.1
-npm-mongo@1.4.39_1
-observe-sequence@1.0.7
-ordered-dict@1.0.4
-promise@0.4.8
-random@1.0.4
-reactive-dict@1.1.1
-reactive-var@1.0.6
-reload@1.1.4
-retry@1.0.4
-routepolicy@1.0.6
-session@1.1.1
-spacebars@1.0.7
-spacebars-compiler@1.0.7
-standard-minifiers@1.0.0
-templating@1.1.3
-templating-tools@1.0.0
-tracker@1.0.8
-ui@1.0.8
-underscore@1.0.4
-url@1.0.5
-webapp@1.2.2
-webapp-hashing@1.0.5
-- 
2.5.4 (Apple Git-61)


From 039e9e2cb898831cd767f6473c9a32e30b00b877 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:23:10 +0300
Subject: [PATCH 014/166] Step 0.11: change inline template to templateUrl

---
 client/app.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/app.ts b/client/app.ts
index 687ed8d..341baa5 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -6,7 +6,7 @@ import {bootstrap} from 'angular2/platform/browser';
     selector: 'app'
 })
 @View({
-    template: 'Hello World!'
+    templateUrl: 'client/app.html'
 })
 class Socially { }
 
-- 
2.5.4 (Apple Git-61)


From 9bb97fc61b2feb0a8f44f36a8961f99672e69627 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:29:40 +0300
Subject: [PATCH 015/166] Step 1.1: add static HTML to the template

---
 client/app.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/app.html b/client/app.html
index a9c8ddc..dd1ef68 100644
--- a/client/app.html
+++ b/client/app.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.5.4 (Apple Git-61)


From 5f635c40e9f6a0a84f9cb75ce2b45aee9ead26ca Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:30:49 +0300
Subject: [PATCH 016/166] Step 2.1: use dynamic template with NgFor

---
 client/app.html | 23 +++++++++--------------
 1 file changed, 9 insertions(+), 14 deletions(-)

diff --git a/client/app.html b/client/app.html
index dd1ef68..d5876ba 100644
--- a/client/app.html
+++ b/client/app.html
@@ -1,14 +1,9 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div>
+  <ul>
+    <li *ngFor="#party of parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+      <p>{{party.location}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.5.4 (Apple Git-61)


From b1723e3c754cd30e34887008bdb25590548b1745 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:34:52 +0300
Subject: [PATCH 017/166] Step 2.2: load parties data into the app

---
 client/app.ts | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)

diff --git a/client/app.ts b/client/app.ts
index 341baa5..df3913d 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -8,6 +8,23 @@ import {bootstrap} from 'angular2/platform/browser';
 @View({
     templateUrl: 'client/app.html'
 })
-class Socially { }
+class Socially {
+    constructor () {
+        this.parties = [
+          {'name': 'Dubstep-Free Zone',
+           'description': 'Can we please just for an evening not listen to dubstep.',
+           'location': 'Palo Alto'
+          },
+          {'name': 'All dubstep all the time',
+           'description': 'Get it on!',
+           'location': 'Palo Alto'
+          },
+          {'name': 'Savage lounging',
+           'description': 'Leisure suit required. And only fiercest manners.',
+           'location': 'San Francisco'
+          }
+        ];
+    }
+}
 
 bootstrap(Socially);
-- 
2.5.4 (Apple Git-61)


From fae2b179702a89bc931548e308ccb1b6026420cb Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 17:36:13 +0300
Subject: [PATCH 018/166] Step 2.3: define parties property

---
 client/app.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/app.ts b/client/app.ts
index df3913d..4b840f0 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -9,6 +9,8 @@ import {bootstrap} from 'angular2/platform/browser';
     templateUrl: 'client/app.html'
 })
 class Socially {
+    parties: Array&lt;Object>;
+
     constructor () {
         this.parties = [
           {'name': 'Dubstep-Free Zone',
-- 
2.5.4 (Apple Git-61)


From 6e23ab48e98531a735c0edc904d0cb853b19ffb6 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 18:30:37 +0300
Subject: [PATCH 019/166] Step 3.1: add the parties collection

---
 collections/parties.ts | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 collections/parties.ts

diff --git a/collections/parties.ts b/collections/parties.ts
new file mode 100644
index 0000000..83fbd07
--- /dev/null
+++ b/collections/parties.ts
@@ -0,0 +1 @@
+export var Parties = new Mongo.Collection('parties');
-- 
2.5.4 (Apple Git-61)


From 16f606ec0f0edd842dfeffbbebfd57a146360aee Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 18:36:56 +0300
Subject: [PATCH 020/166] Step 3.2: import the parties collection

---
 client/app.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/app.ts b/client/app.ts
index 4b840f0..8a6ea55 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -2,6 +2,8 @@ import {Component, View} from 'angular2/core';
 
 import {bootstrap} from 'angular2/platform/browser';
 
+import {Parties} from 'collections/parties';
+
 @Component({
     selector: 'app'
 })
-- 
2.5.4 (Apple Git-61)


From 2af195c92bd238ad22db486f4443ed6a18f842df Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 19 Oct 2015 13:28:41 +0300
Subject: [PATCH 021/166] Step 3.3: fetch parties

---
 client/app.ts | 15 +--------------
 1 file changed, 1 insertion(+), 14 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 8a6ea55..ed7730b 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -14,20 +14,7 @@ class Socially {
     parties: Array&lt;Object>;
 
     constructor () {
-        this.parties = [
-          {'name': 'Dubstep-Free Zone',
-           'description': 'Can we please just for an evening not listen to dubstep.',
-           'location': 'Palo Alto'
-          },
-          {'name': 'All dubstep all the time',
-           'description': 'Get it on!',
-           'location': 'Palo Alto'
-          },
-          {'name': 'Savage lounging',
-           'description': 'Leisure suit required. And only fiercest manners.',
-           'location': 'San Francisco'
-          }
-        ];
+        this.parties = Parties.find().fetch();
     }
 }
 
-- 
2.5.4 (Apple Git-61)


From 2bf071f7c62aea7c69ddf8a9f81fab2c6648cfb4 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Sep 2015 18:47:23 +0300
Subject: [PATCH 022/166] Step 3.4: fetch parties reactively

---
 client/app.ts | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index ed7730b..eee15c8 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -1,4 +1,4 @@
-import {Component, View} from 'angular2/core';
+import {Component, View, NgZone} from 'angular2/core';
 
 import {bootstrap} from 'angular2/platform/browser';
 
@@ -13,8 +13,10 @@ import {Parties} from 'collections/parties';
 class Socially {
     parties: Array&lt;Object>;
 
-    constructor () {
-        this.parties = Parties.find().fetch();
+    constructor (zone: NgZone) {
+        Tracker.autorun(() => zone.run(() => {
+            this.parties = Parties.find().fetch();
+        }));
     }
 }
 
-- 
2.5.4 (Apple Git-61)


From 733f79c5e36b807fe6afe520fe7aea39a83839c1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 8 Nov 2015 02:26:41 +0300
Subject: [PATCH 023/166] Step 3.5: initialize collection on server side

---
 server/main.ts | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 server/main.ts

diff --git a/server/main.ts b/server/main.ts
new file mode 100644
index 0000000..64dbcb6
--- /dev/null
+++ b/server/main.ts
@@ -0,0 +1 @@
+import 'collections/parties';
-- 
2.5.4 (Apple Git-61)


From 6c4cfa8e3a2ab5a43bd439e75d50f48d62db675e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 14 Oct 2015 22:55:11 +0300
Subject: [PATCH 024/166] Step 3.6: Blaze-like binding to Angular2

---
 client/app.ts | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index eee15c8..570d3bf 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -1,9 +1,9 @@
 import {Component, View, NgZone} from 'angular2/core';
 
-import {bootstrap} from 'angular2/platform/browser';
-
 import {Parties} from 'collections/parties';
 
+import {bootstrap} from 'angular2-meteor';
+
 @Component({
     selector: 'app'
 })
@@ -11,12 +11,10 @@ import {Parties} from 'collections/parties';
     templateUrl: 'client/app.html'
 })
 class Socially {
-    parties: Array&lt;Object>;
+    parties: Mongo.Cursor&lt;Object>;
 
-    constructor (zone: NgZone) {
-        Tracker.autorun(() => zone.run(() => {
-            this.parties = Parties.find().fetch();
-        }));
+    constructor () {
+        this.parties = Parties.find();
     }
 }
 
-- 
2.5.4 (Apple Git-61)


From 5efab185d08d9ec7dc70ae0d112ddd16862f0ae2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 14 Oct 2015 23:21:31 +0300
Subject: [PATCH 025/166] Step 3.7: load initial parties on server side

---
 server/load-parties.ts | 28 ++++++++++++++++++++++++++++
 1 file changed, 28 insertions(+)
 create mode 100644 server/load-parties.ts

diff --git a/server/load-parties.ts b/server/load-parties.ts
new file mode 100644
index 0000000..65c914a
--- /dev/null
+++ b/server/load-parties.ts
@@ -0,0 +1,28 @@
+import {Parties} from 'collections/parties';
+
+export function loadParties() {
+    if (Parties.find().count() === 0) {
+
+    var parties = [
+        {
+            'name': 'Dubstep-Free Zone',
+            'description': 'Can we please just for an evening not listen to dubstep.',
+            'location': 'Palo Alto'
+        },
+        {
+            'name': 'All dubstep all the time',
+            'description': 'Get it on!',
+            'location': 'Palo Alto'
+        },
+        {
+            'name': 'Savage lounging',
+            'description': 'Leisure suit required. And only fiercest manners.',
+            'location': 'San Francisco'
+        }
+    ];
+
+    for (var i = 0; i < parties.length; i++) {
+        Parties.insert(parties[i]);
+    }
+  }
+};
-- 
2.5.4 (Apple Git-61)


From 292ec4fb8cb00722309078ea8b023d927ed39766 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 14 Oct 2015 23:32:49 +0300
Subject: [PATCH 026/166] Step 3.8: bootstrap server side

---
 server/main.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/server/main.ts b/server/main.ts
index 64dbcb6..3e7deac 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -1 +1,3 @@
-import 'collections/parties';
+import {loadParties} from './load-parties';
+
+Meteor.startup(loadParties);
-- 
2.5.4 (Apple Git-61)


From 9dc144b55dac89ca8b6a4f788471b3cb1e663c66 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 14:58:32 +0300
Subject: [PATCH 027/166] Step 4.1:  create PartiesForm component

---
 client/parties-form/parties-form.ts | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/parties-form/parties-form.ts

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
new file mode 100644
index 0000000..be24a51
--- /dev/null
+++ b/client/parties-form/parties-form.ts
@@ -0,0 +1,9 @@
+import {Component, View} from 'angular2/core';
+
+@Component({
+    selector: 'parties-form'
+})
+@View({
+    templateUrl: '/client/parties-form/parties-form.html'
+})
+export class PartiesForm { }
-- 
2.5.4 (Apple Git-61)


From 7847fee6a4d11109e3bf7b5663195104da4e19a9 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 15:48:01 +0300
Subject: [PATCH 028/166] Step 4.2: add parties-form.html template

---
 client/parties-form/parties-form.html | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/parties-form/parties-form.html

diff --git a/client/parties-form/parties-form.html b/client/parties-form/parties-form.html
new file mode 100644
index 0000000..df0bd89
--- /dev/null
+++ b/client/parties-form/parties-form.html
@@ -0,0 +1,9 @@
+<form>
+  <label>Name</label>
+  <input type="text">
+  <label>Description</label>
+  <input type="text">
+  <label>Location</label>
+  <input type="text">
+  <button>Add</button>
+</form>
-- 
2.5.4 (Apple Git-61)


From b4218a43fe1269ccc826edac9f161e5f540429ac Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 16:03:48 +0300
Subject: [PATCH 029/166] Step 4.3: load the PartiesForm component

---
 client/app.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/app.html b/client/app.html
index d5876ba..2f7c3e3 100644
--- a/client/app.html
+++ b/client/app.html
@@ -1,4 +1,5 @@
 <div>
+  <parties-form></parties-form>
   <ul>
     <li *ngFor="#party of parties">
       {{party.name}}
-- 
2.5.4 (Apple Git-61)


From 8acb228e1e26d5e0d441d407b4de8f94d97b2745 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 16:07:36 +0300
Subject: [PATCH 030/166] Step 4.4: import the PartiesForm component and link
 it with the Socially component

---
 client/app.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/app.ts b/client/app.ts
index 570d3bf..0005b9d 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -4,11 +4,14 @@ import {Parties} from 'collections/parties';
 
 import {bootstrap} from 'angular2-meteor';
 
+import {PartiesForm} from 'client/parties-form/parties-form';
+
 @Component({
     selector: 'app'
 })
 @View({
-    templateUrl: 'client/app.html'
+    templateUrl: 'client/app.html',
+    directives: [PartiesForm]
 })
 class Socially {
     parties: Mongo.Cursor&lt;Object>;
-- 
2.5.4 (Apple Git-61)


From 8e2f0cfbf4f4f02cd25f95546b6585f1797a31ba Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 17:41:26 +0300
Subject: [PATCH 031/166] Step 4.5: build a form model

---
 client/parties-form/parties-form.ts | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index be24a51..7bf421e 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -1,9 +1,22 @@
 import {Component, View} from 'angular2/core';
 
+import {FormBuilder, ControlGroup, Validators} from 'angular2/common';
+
 @Component({
     selector: 'parties-form'
 })
 @View({
     templateUrl: '/client/parties-form/parties-form.html'
 })
-export class PartiesForm { }
+export class PartiesForm {
+    partiesForm: ControlGroup;
+
+    constructor() {
+        var fb = new FormBuilder();
+        this.partiesForm = fb.group({
+            name: [''],
+            description: [''],
+            location: ['']
+        });
+    }
+}
-- 
2.5.4 (Apple Git-61)


From fe3cc9d71ace413c311f5215598bdc4f4659f17b Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 18:34:57 +0300
Subject: [PATCH 032/166] Step 4.6: add form validation

---
 client/parties-form/parties-form.ts | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index 7bf421e..d531eec 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -14,9 +14,9 @@ export class PartiesForm {
     constructor() {
         var fb = new FormBuilder();
         this.partiesForm = fb.group({
-            name: [''],
+            name: ['', Validators.required],
             description: [''],
-            location: ['']
+            location: ['', Validators.required]
         });
     }
 }
-- 
2.5.4 (Apple Git-61)


From 312600028f072280ba6e7b524c871ba896a9942a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 20:20:32 +0300
Subject: [PATCH 033/166] Step 4.7: link the form and its model together

---
 client/parties-form/parties-form.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/client/parties-form/parties-form.html b/client/parties-form/parties-form.html
index df0bd89..dffc0aa 100644
--- a/client/parties-form/parties-form.html
+++ b/client/parties-form/parties-form.html
@@ -1,9 +1,9 @@
-<form>
+<form [ngFormModel]="partiesForm">
   <label>Name</label>
-  <input type="text">
+  <input type="text" ngControl="name">
   <label>Description</label>
-  <input type="text">
+  <input type="text" ngControl="description">
   <label>Location</label>
-  <input type="text">
+  <input type="text" ngControl="location">
   <button>Add</button>
 </form>
-- 
2.5.4 (Apple Git-61)


From fa178b2469f7759fb6a5dc74310cc880f01fb55d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 20:33:32 +0300
Subject: [PATCH 034/166] Step 4.8: add submit handler inside the template

---
 client/parties-form/parties-form.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-form/parties-form.html b/client/parties-form/parties-form.html
index dffc0aa..da869fb 100644
--- a/client/parties-form/parties-form.html
+++ b/client/parties-form/parties-form.html
@@ -1,4 +1,4 @@
-<form [ngFormModel]="partiesForm">
+<form [ngFormModel]="partiesForm" #f="ngForm" (submit)="addParty(f.value)">
   <label>Name</label>
   <input type="text" ngControl="name">
   <label>Description</label>
-- 
2.5.4 (Apple Git-61)


From 345c25db3beda30a532200082d874d7ad6e64cca Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 4 Jan 2016 13:21:15 +0700
Subject: [PATCH 035/166] Step 4.9: add addParty method into the component

---
 client/parties-form/parties-form.ts | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index d531eec..b83612c 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -1,6 +1,8 @@
 import {Component, View} from 'angular2/core';
 
-import {FormBuilder, ControlGroup, Validators} from 'angular2/common';
+import {FormBuilder, Control, ControlGroup, Validators} from 'angular2/common';
+
+import {Parties} from 'collections/parties';
 
 @Component({
     selector: 'parties-form'
@@ -19,4 +21,18 @@ export class PartiesForm {
             location: ['', Validators.required]
         });
     }
+
+    addParty(party) {
+        if (this.partiesForm.valid) {
+            Parties.insert({
+                name: party.name,
+                description: party.description,
+                location: party.location
+            });
+
+            (&lt;Control>this.partiesForm.controls['name']).updateValue('');
+            (&lt;Control>this.partiesForm.controls['description']).updateValue('');
+            (&lt;Control>this.partiesForm.controls['location']).updateValue('');
+        }
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 5f9239397c3a28679e252334db0b626e7da0956b Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 20:57:18 +0300
Subject: [PATCH 036/166] Step 4.10: add a remove party button and click event
 handler

---
 client/app.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/app.html b/client/app.html
index 2f7c3e3..b3ec969 100644
--- a/client/app.html
+++ b/client/app.html
@@ -5,6 +5,7 @@
       {{party.name}}
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
+      <button (click)="removeParty(party)">X</button>
     </li>
   </ul>
 </div>
-- 
2.5.4 (Apple Git-61)


From 681a3d9f22d54f8d192ced9afa15b6f78cd33de9 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 17 Oct 2015 20:59:18 +0300
Subject: [PATCH 037/166] Step 4.11: add removeParty method inside the
 component

---
 client/app.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/app.ts b/client/app.ts
index 0005b9d..1b8092e 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -19,6 +19,10 @@ class Socially {
     constructor () {
         this.parties = Parties.find();
     }
+
+    removeParty(party) {
+        Parties.remove(party._id);
+    }
 }
 
 bootstrap(Socially);
-- 
2.5.4 (Apple Git-61)


From ecdeb3bb3c2c21a07aaa950a26dc284fac94b52a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 01:47:04 +0300
Subject: [PATCH 038/166] Step 5.1:  import routing components and add them to
 the app

---
 client/app.ts | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 1b8092e..9365b34 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -6,12 +6,14 @@ import {bootstrap} from 'angular2-meteor';
 
 import {PartiesForm} from 'client/parties-form/parties-form';
 
+import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig} from 'angular2/router';
+
 @Component({
     selector: 'app'
 })
 @View({
     templateUrl: 'client/app.html',
-    directives: [PartiesForm]
+    directives: [PartiesForm, ROUTER_DIRECTIVES]
 })
 class Socially {
     parties: Mongo.Cursor&lt;Object>;
@@ -25,4 +27,4 @@ class Socially {
     }
 }
 
-bootstrap(Socially);
+bootstrap(Socially, [ROUTER_PROVIDERS]);
-- 
2.5.4 (Apple Git-61)


From b0b6d3ac5b9a0bab26df9316e216c5a181b08cc2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 01:49:04 +0300
Subject: [PATCH 039/166] Step 5.2:  create PartiesList component

---
 client/parties-list/parties-list.ts | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 client/parties-list/parties-list.ts

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
new file mode 100644
index 0000000..9154299
--- /dev/null
+++ b/client/parties-list/parties-list.ts
@@ -0,0 +1,24 @@
+import {Component, View} from 'angular2/core';
+
+import {Parties} from 'collections/parties';
+
+import {PartiesForm} from 'client/parties-form/parties-form';
+
+@Component({
+    selector: 'parties-list'
+})
+@View({
+    templateUrl: '/client/parties-list/parties-list.html',
+    directives: [PartiesForm]
+})
+export class PartiesList {
+    parties: Mongo.Cursor&lt;Object>;
+
+    constructor() {
+        this.parties = Parties.find();
+    }
+
+    removeParty(party) {
+        Parties.remove(party._id);
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 72fb27d5932a562c8aa1c52a1394a65ce3e87b84 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 01:49:43 +0300
Subject: [PATCH 040/166] Step 5.3: add PartiesList template

---
 client/parties-list/parties-list.html | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 client/parties-list/parties-list.html

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
new file mode 100644
index 0000000..b3ec969
--- /dev/null
+++ b/client/parties-list/parties-list.html
@@ -0,0 +1,11 @@
+<div>
+  <parties-form></parties-form>
+  <ul>
+    <li *ngFor="#party of parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+      <p>{{party.location}}</p>
+      <button (click)="removeParty(party)">X</button>
+    </li>
+  </ul>
+</div>
-- 
2.5.4 (Apple Git-61)


From b39e6ccb30d0731af856f05e0315e6765b71b60d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 01:59:44 +0300
Subject: [PATCH 041/166] Removes app.html

---
 client/app.html | 11 -----------
 1 file changed, 11 deletions(-)
 delete mode 100644 client/app.html

diff --git a/client/app.html b/client/app.html
deleted file mode 100644
index b3ec969..0000000
--- a/client/app.html
+++ /dev/null
@@ -1,11 +0,0 @@
-<div>
-  <parties-form></parties-form>
-  <ul>
-    <li *ngFor="#party of parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-      <p>{{party.location}}</p>
-      <button (click)="removeParty(party)">X</button>
-    </li>
-  </ul>
-</div>
-- 
2.5.4 (Apple Git-61)


From 5543e09100f46e0169dfde52b876cff071c68f6b Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 02:03:06 +0300
Subject: [PATCH 042/166] Step 5.4: clean up Socally component

---
 client/app.ts | 19 ++-----------------
 1 file changed, 2 insertions(+), 17 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 9365b34..67c02f4 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -1,30 +1,15 @@
 import {Component, View, NgZone} from 'angular2/core';
 
-import {Parties} from 'collections/parties';
-
 import {bootstrap} from 'angular2-meteor';
 
-import {PartiesForm} from 'client/parties-form/parties-form';
-
 import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig} from 'angular2/router';
 
 @Component({
     selector: 'app'
 })
 @View({
-    templateUrl: 'client/app.html',
-    directives: [PartiesForm, ROUTER_DIRECTIVES]
+    directives: [ROUTER_DIRECTIVES]
 })
-class Socially {
-    parties: Mongo.Cursor&lt;Object>;
-
-    constructor () {
-        this.parties = Parties.find();
-    }
-
-    removeParty(party) {
-        Parties.remove(party._id);
-    }
-}
+class Socially {}
 
 bootstrap(Socially, [ROUTER_PROVIDERS]);
-- 
2.5.4 (Apple Git-61)


From 94824330ee919de20db9f5165457cbdd90e33b65 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 02:14:40 +0300
Subject: [PATCH 043/166] Step 5.5: add PartyDetails component

---
 client/party-details/party-details.ts | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/party-details/party-details.ts

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
new file mode 100644
index 0000000..856623d
--- /dev/null
+++ b/client/party-details/party-details.ts
@@ -0,0 +1,9 @@
+import {Component, View} from 'angular2/core';
+
+@Component({
+  selector: 'party-details'
+})
+@View({
+  templateUrl: '/client/party-details/party-details.html'
+})
+export class PartyDetails {}
-- 
2.5.4 (Apple Git-61)


From eb98b53eb63300a2f04b65bc5275f705eeae6506 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 02:15:46 +0300
Subject: [PATCH 044/166] Step 5.6: add PartyDetails template

---
 client/party-details/party-details.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/party-details/party-details.html

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
new file mode 100644
index 0000000..63fdaea
--- /dev/null
+++ b/client/party-details/party-details.html
@@ -0,0 +1,5 @@
+<header>
+  <h2>PARTY_NAME</h2>
+
+  <p>PARTY_DESCRIPTION</p>
+</header>
-- 
2.5.4 (Apple Git-61)


From 43f4e7cc4f8cd35ef274cdc6a224d8be6330d803 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 02:19:18 +0300
Subject: [PATCH 045/166] Step 5.7: configure routes

---
 client/app.ts | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 67c02f4..19eb1de 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -1,15 +1,24 @@
-import {Component, View, NgZone} from 'angular2/core';
+import {Component, View, NgZone, provide} from 'angular2/core';
 
 import {bootstrap} from 'angular2-meteor';
 
-import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig} from 'angular2/router';
+import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig, APP_BASE_HREF} from 'angular2/router';
+
+import {PartiesList} from 'client/parties-list/parties-list';
+
+import {PartyDetails} from 'client/party-details/party-details';
 
 @Component({
     selector: 'app'
 })
 @View({
+    template: '&lt;router-outlet></router-outlet>',
     directives: [ROUTER_DIRECTIVES]
 })
+@RouteConfig([
+    { path: '/', as: 'PartiesList', component: PartiesList },
+    { path: '/party/:partyId', as: 'PartyDetails', component: PartyDetails }
+])
 class Socially {}
 
-bootstrap(Socially, [ROUTER_PROVIDERS]);
+bootstrap(Socially, [ROUTER_PROVIDERS, provide(APP_BASE_HREF, { useValue: '/' })]);
-- 
2.5.4 (Apple Git-61)


From 3169282b2ace5087da3c05cdd068d7556e19d256 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 03:17:25 +0300
Subject: [PATCH 046/166] Step 5.8: import RouterLink directive

---
 client/parties-list/parties-list.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 9154299..39ba461 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -4,12 +4,14 @@ import {Parties} from 'collections/parties';
 
 import {PartiesForm} from 'client/parties-form/parties-form';
 
+import {RouterLink} from 'angular2/router';
+
 @Component({
     selector: 'parties-list'
 })
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
-    directives: [PartiesForm]
+    directives: [PartiesForm, RouterLink]
 })
 export class PartiesList {
     parties: Mongo.Cursor&lt;Object>;
-- 
2.5.4 (Apple Git-61)


From 56dfed0ca2fb60be8f3d834524ec7b17c47eb1a8 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 12 Dec 2015 17:06:34 +0300
Subject: [PATCH 047/166] Step 5.9: add links to the parties list

---
 client/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index b3ec969..03c9607 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -2,7 +2,7 @@
   <parties-form></parties-form>
   <ul>
     <li *ngFor="#party of parties">
-      {{party.name}}
+      <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
       <button (click)="removeParty(party)">X</button>
-- 
2.5.4 (Apple Git-61)


From 82eb32d1ca4a3acc60d168194de519ccd50684dd Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 20:11:55 +0300
Subject: [PATCH 048/166] Step 5.10: inject route parameters

---
 client/party-details/party-details.ts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 856623d..effb90b 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -1,9 +1,15 @@
 import {Component, View} from 'angular2/core';
 
+import {RouteParams} from 'angular2/router';
+
 @Component({
-  selector: 'party-details'
+    selector: 'party-details'
 })
 @View({
-  templateUrl: '/client/party-details/party-details.html'
+    templateUrl: '/client/party-details/party-details.html'
 })
-export class PartyDetails {}
+export class PartyDetails {
+    constructor(params: RouteParams) {
+        var partyId = params.get('partyId');
+    }
+}
-- 
2.5.4 (Apple Git-61)


From c03ecb9bd199347321f1528ad9768409ca9be97d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 20:44:54 +0300
Subject: [PATCH 049/166] Step 5.11: load party details

---
 client/party-details/party-details.ts | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index effb90b..c9cee74 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -2,6 +2,8 @@ import {Component, View} from 'angular2/core';
 
 import {RouteParams} from 'angular2/router';
 
+import {Parties} from 'collections/parties';
+
 @Component({
     selector: 'party-details'
 })
@@ -9,7 +11,10 @@ import {RouteParams} from 'angular2/router';
     templateUrl: '/client/party-details/party-details.html'
 })
 export class PartyDetails {
+    party: Object;
+
     constructor(params: RouteParams) {
         var partyId = params.get('partyId');
+        this.party = Parties.findOne(partyId);
     }
 }
-- 
2.5.4 (Apple Git-61)


From b21a3c8d17d7ea9e4589b78f1833f84de8f78158 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 18 Oct 2015 20:45:51 +0300
Subject: [PATCH 050/166] Step 5.12: render party details

---
 client/party-details/party-details.html | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 63fdaea..b88d435 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -1,5 +1,7 @@
 <header>
-  <h2>PARTY_NAME</h2>
+  <h2>{{party.name}}</h2>
 
-  <p>PARTY_DESCRIPTION</p>
+  <p>{{party.description}}</p>
+
+  <p>{{party.location}}</p>
 </header>
-- 
2.5.4 (Apple Git-61)


From dc9e092713fe6b0a15fc27464ce7984b15ebde22 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 8 Nov 2015 23:23:24 +0300
Subject: [PATCH 051/166] Adds RouterLink dependency.

---
 client/party-details/party-details.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index c9cee74..32f8d70 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -4,11 +4,14 @@ import {RouteParams} from 'angular2/router';
 
 import {Parties} from 'collections/parties';
 
+import {RouterLink} from 'angular2/router';
+
 @Component({
     selector: 'party-details'
 })
 @View({
-    templateUrl: '/client/party-details/party-details.html'
+    templateUrl: '/client/party-details/party-details.html',
+    directives: [RouterLink]
 })
 export class PartyDetails {
     party: Object;
-- 
2.5.4 (Apple Git-61)


From 5e716cf5831e6f29c79b94021f8608a8c8de5785 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 8 Nov 2015 23:24:33 +0300
Subject: [PATCH 052/166] Step 6.1: add party details form

---
 client/party-details/party-details.html | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index b88d435..a9aaa4d 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -1,7 +1,13 @@
-<header>
-  <h2>{{party.name}}</h2>
+<form>
+  <label>Name</label>
+  <input type="text">
 
-  <p>{{party.description}}</p>
+  <label>Description</label>
+  <input type="text">
 
-  <p>{{party.location}}</p>
-</header>
+  <label>Location</label>
+  <input type="text">
+
+  <button type="submit">Save</button>
+  <button [routerLink]="['/PartiesList']">Cancel</button>
+</form>
-- 
2.5.4 (Apple Git-61)


From a2b064ec8f7a1d77b5d173797dca77044100385a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 8 Nov 2015 23:44:19 +0300
Subject: [PATCH 053/166] Step 6.2: bind party to form inputs

---
 client/party-details/party-details.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index a9aaa4d..61fda60 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -1,12 +1,12 @@
-<form>
+<form (submit)="saveParty(party)">
   <label>Name</label>
-  <input type="text">
+  <input type="text" [(ngModel)]="party.name">
 
   <label>Description</label>
-  <input type="text">
+  <input type="text" [(ngModel)]="party.description">
 
   <label>Location</label>
-  <input type="text">
+  <input type="text" [(ngModel)]="party.location">
 
   <button type="submit">Save</button>
   <button [routerLink]="['/PartiesList']">Cancel</button>
-- 
2.5.4 (Apple Git-61)


From 3a877ab576a7ed33c2fb603f4903fc83b95c0687 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 8 Nov 2015 23:53:48 +0300
Subject: [PATCH 054/166] Step 6.3: add submit event handler

---
 client/party-details/party-details.ts | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 32f8d70..40be530 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -20,4 +20,14 @@ export class PartyDetails {
         var partyId = params.get('partyId');
         this.party = Parties.findOne(partyId);
     }
+
+    saveParty(party) {
+      Parties.update(party._id, {
+        $set: {
+          name: party.name,
+          description: party.description,
+          location: party.location
+        }
+      });
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 28c057c452ed1c3ffc3cab285bf400963762ced4 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 17 Nov 2015 19:24:23 +0300
Subject: [PATCH 055/166] Step 7.1: declare Party type

---
 typings/party.d.ts | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 typings/party.d.ts

diff --git a/typings/party.d.ts b/typings/party.d.ts
new file mode 100644
index 0000000..deb86df
--- /dev/null
+++ b/typings/party.d.ts
@@ -0,0 +1,6 @@
+interface Party {
+  _id?: string;
+  name: string;
+  description?: string;
+  location: string;
+}
-- 
2.5.4 (Apple Git-61)


From 656729c3fb9bab28d674e5b7b4eabf32a7972297 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 7 Jan 2016 13:15:51 +0700
Subject: [PATCH 056/166] Step 7.2: add party declaration file to the tsconfig

---
 tsconfig.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/tsconfig.json b/tsconfig.json
index d32f0a4..f27eed2 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,6 +1,7 @@
 {
   "files": [
     "typings/main.d.ts",
-    "typings/angular2-meteor/angular2-meteor.d.ts"
+    "typings/angular2-meteor/angular2-meteor.d.ts",
+    "typings/party.d.ts"
   ]
 }
-- 
2.5.4 (Apple Git-61)


From 9a3a3fc199aeea57d7b19888709946cb405e22a0 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 17 Nov 2015 19:37:25 +0300
Subject: [PATCH 057/166] Step 7.3: define parties collection with Party type

---
 collections/parties.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/collections/parties.ts b/collections/parties.ts
index 83fbd07..9c37117 100644
--- a/collections/parties.ts
+++ b/collections/parties.ts
@@ -1 +1 @@
-export var Parties = new Mongo.Collection('parties');
+export var Parties = new Mongo.Collection&lt;Party>('parties');
-- 
2.5.4 (Apple Git-61)


From 26f682a152b12b694baaf90f9f594974127ad24f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 17 Nov 2015 20:17:12 +0300
Subject: [PATCH 058/166] Step 7.4: correct parties cursor to be of the exact
 type

---
 client/parties-list/parties-list.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 39ba461..b29e580 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -14,7 +14,7 @@ import {RouterLink} from 'angular2/router';
     directives: [PartiesForm, RouterLink]
 })
 export class PartiesList {
-    parties: Mongo.Cursor&lt;Object>;
+    parties: Mongo.Cursor&lt;Party>;
 
     constructor() {
         this.parties = Parties.find();
-- 
2.5.4 (Apple Git-61)


From efdfdae8fff7a9527083e440505fc54368a43faa Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 17 Nov 2015 20:18:03 +0300
Subject: [PATCH 059/166] Step 7.5: correct party property to be of Party type

---
 client/party-details/party-details.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 40be530..3dacd0a 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -14,7 +14,7 @@ import {RouterLink} from 'angular2/router';
     directives: [RouterLink]
 })
 export class PartyDetails {
-    party: Object;
+    party: Party;
 
     constructor(params: RouteParams) {
         var partyId = params.get('partyId');
-- 
2.5.4 (Apple Git-61)


From 2c47fef6fcb95997bb0358024a3ac6c4f49eb5e0 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 7 Jan 2016 14:38:05 +0700
Subject: [PATCH 060/166] Step 7.6: add new TypeScript options to configure
 plugins

---
 tsconfig.json | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/tsconfig.json b/tsconfig.json
index f27eed2..3293c49 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,7 +1,14 @@
 {
+  "compilerOptions": {
+    "experimentalDecorators": true,
+    "module": "system",
+    "target": "es5"
+  },
   "files": [
     "typings/main.d.ts",
     "typings/angular2-meteor/angular2-meteor.d.ts",
-    "typings/party.d.ts"
+    "typings/party.d.ts",
+    "client/app.ts",
+    "server/main.ts"
   ]
 }
-- 
2.5.4 (Apple Git-61)


From c8b3a4610d9cfa53c5f8648f7ccad40bc1452b16 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 17:40:30 +0300
Subject: [PATCH 061/166] Removes insecure, adds Accounts UI package

---
 .meteor/packages | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index 2f89e25..6160a20 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,5 +15,6 @@ standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 urigo:angular2-meteor
+accounts-password
+barbatus:ng2-meteor-accounts-ui
-- 
2.5.4 (Apple Git-61)


From 213d0ac5ec7690902b0b8dd6e0aa897ca40a4c34 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 17:45:50 +0300
Subject: [PATCH 062/166] Step 8.1: add Accounts UI component to the
 PartiesList template

---
 client/parties-list/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index 03c9607..21c7ea8 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -1,5 +1,6 @@
 <div>
   <parties-form></parties-form>
+  <accounts-ui></accounts-ui>
   <ul>
     <li *ngFor="#party of parties">
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
-- 
2.5.4 (Apple Git-61)


From f3f3719d0f668f4d3ee7003f5d454475a01ff2b1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 17:47:00 +0300
Subject: [PATCH 063/166] Step 8.2: import dependencies

---
 client/parties-list/parties-list.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index b29e580..9444cba 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -6,12 +6,14 @@ import {PartiesForm} from 'client/parties-form/parties-form';
 
 import {RouterLink} from 'angular2/router';
 
+import {AccountsUI} from 'meteor-accounts-ui';
+
 @Component({
     selector: 'parties-list'
 })
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
-    directives: [PartiesForm, RouterLink]
+    directives: [PartiesForm, RouterLink, AccountsUI]
 })
 export class PartiesList {
     parties: Mongo.Cursor&lt;Party>;
-- 
2.5.4 (Apple Git-61)


From 3e1bc21948b3e0e834581f5fc243cd62d8b2483d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 7 Jan 2016 15:16:00 +0700
Subject: [PATCH 064/166] Step 8.3: add typings to the tsconfig

---
 tsconfig.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tsconfig.json b/tsconfig.json
index 3293c49..d970f1c 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -7,6 +7,7 @@
   "files": [
     "typings/main.d.ts",
     "typings/angular2-meteor/angular2-meteor.d.ts",
+    "typings/ng2-meteor-accounts-ui/ng2-meteor-accounts-ui.d.ts",
     "typings/party.d.ts",
     "client/app.ts",
     "server/main.ts"
-- 
2.5.4 (Apple Git-61)


From dccf7857300e885ce1397099da91bd3c9d00e9e7 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 18:13:17 +0300
Subject: [PATCH 065/166] Step 8.4: add parties collection security

---
 collections/parties.ts | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/collections/parties.ts b/collections/parties.ts
index 9c37117..bc33b70 100644
--- a/collections/parties.ts
+++ b/collections/parties.ts
@@ -1 +1,16 @@
 export var Parties = new Mongo.Collection&lt;Party>('parties');
+
+Parties.allow({
+  insert: function() {
+    var user = Meteor.user();
+    return !!user;
+  },
+  update: function() {
+    var user = Meteor.user();
+    return !!user;
+  },
+  remove: function() {
+    var user = Meteor.user();
+    return !!user;
+  }
+});
-- 
2.5.4 (Apple Git-61)


From ab8ee65d0c728b3feeeaa0be4d3a89b50e079a95 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 18:34:06 +0300
Subject: [PATCH 066/166] Step 8.5: check access and add party owner ID

---
 client/parties-form/parties-form.ts | 21 +++++++++++++--------
 1 file changed, 13 insertions(+), 8 deletions(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index b83612c..b0428ec 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -24,15 +24,20 @@ export class PartiesForm {
 
     addParty(party) {
         if (this.partiesForm.valid) {
-            Parties.insert({
-                name: party.name,
-                description: party.description,
-                location: party.location
-            });
+            if (Meteor.userId()) {
+                Parties.insert({
+                    name: party.name,
+                    description: party.description,
+                    location: party.location,
+                    owner: Meteor.userId()
+                });
 
-            (&lt;Control>this.partiesForm.controls['name']).updateValue('');
-            (&lt;Control>this.partiesForm.controls['description']).updateValue('');
-            (&lt;Control>this.partiesForm.controls['location']).updateValue('');
+                (&lt;Control>this.partiesForm.controls['name']).updateValue('');
+                (&lt;Control>this.partiesForm.controls['description']).updateValue('');
+                (&lt;Control>this.partiesForm.controls['location']).updateValue('');
+            } else {
+                alert('Please log in to add a party');
+            }
         }
     }
 }
-- 
2.5.4 (Apple Git-61)


From 0f88b8fb1f9a3feb97b7d63b38a4737e4ed01129 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 18:35:51 +0300
Subject: [PATCH 067/166] Step 8.6: check access to change party

---
 client/party-details/party-details.ts | 18 +++++++++++-------
 1 file changed, 11 insertions(+), 7 deletions(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 3dacd0a..486c3a2 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -22,12 +22,16 @@ export class PartyDetails {
     }
 
     saveParty(party) {
-      Parties.update(party._id, {
-        $set: {
-          name: party.name,
-          description: party.description,
-          location: party.location
-        }
-      });
+      if (Meteor.userId()) {
+        Parties.update(party._id, {
+          $set: {
+            name: party.name,
+            description: party.description,
+            location: party.location
+          }
+        });
+      } else {
+        alert('Please log in to change this party');
+      }
     }
 }
-- 
2.5.4 (Apple Git-61)


From 41d8e6456af28c1551e361dd08fa96b84edbe910 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 19:23:11 +0300
Subject: [PATCH 068/166] Adds base Accounts package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6160a20..a1a7442 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ autopublish             # Publish all data to the clients (for prototyping)
 urigo:angular2-meteor
 accounts-password
 barbatus:ng2-meteor-accounts-ui
+barbatus:ng2-meteor-accounts
-- 
2.5.4 (Apple Git-61)


From 5e5489feec203064685c8808d78eb835b15100de Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 7 Jan 2016 15:18:33 +0700
Subject: [PATCH 069/166] Step 8.7: add typings to the tsconfig

---
 tsconfig.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tsconfig.json b/tsconfig.json
index d970f1c..ee0dc8b 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -8,6 +8,7 @@
     "typings/main.d.ts",
     "typings/angular2-meteor/angular2-meteor.d.ts",
     "typings/ng2-meteor-accounts-ui/ng2-meteor-accounts-ui.d.ts",
+    "typings/ng2-meteor-accounts/ng2-meteor-accounts.d.ts",
     "typings/party.d.ts",
     "client/app.ts",
     "server/main.ts"
-- 
2.5.4 (Apple Git-61)


From e1361767e887359b1c8ed815ea009665727b1678 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 10 Nov 2015 19:23:40 +0300
Subject: [PATCH 070/166] Step 8.8: require user to access PartyDetails

---
 client/party-details/party-details.ts | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 486c3a2..ec2230a 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -6,6 +6,8 @@ import {Parties} from 'collections/parties';
 
 import {RouterLink} from 'angular2/router';
 
+import {RequireUser} from 'meteor-accounts';
+
 @Component({
     selector: 'party-details'
 })
@@ -13,6 +15,7 @@ import {RouterLink} from 'angular2/router';
     templateUrl: '/client/party-details/party-details.html',
     directives: [RouterLink]
 })
+@RequireUser()
 export class PartyDetails {
     party: Party;
 
-- 
2.5.4 (Apple Git-61)


From 88ab8ca4cc6eea555a9b26e59181313527097538 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 12 Dec 2015 18:21:49 +0300
Subject: [PATCH 071/166] Corrects Party interface in the party.d.ts definition
 file

---
 typings/party.d.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/typings/party.d.ts b/typings/party.d.ts
index deb86df..c57fd4a 100644
--- a/typings/party.d.ts
+++ b/typings/party.d.ts
@@ -3,4 +3,5 @@ interface Party {
   name: string;
   description?: string;
   location: string;
+  owner?: string;
 }
-- 
2.5.4 (Apple Git-61)


From e8c051d8241784eb8ca7b096726dec47f862ff22 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 16:54:07 +0300
Subject: [PATCH 072/166] Removes autopublish

---
 .meteor/packages | 1 -
 1 file changed, 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index a1a7442..cd3ad8c 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -14,7 +14,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
-autopublish             # Publish all data to the clients (for prototyping)
 urigo:angular2-meteor
 accounts-password
 barbatus:ng2-meteor-accounts-ui
-- 
2.5.4 (Apple Git-61)


From fa3e2dfc7b2c47159fc83fb5a81d455288e40170 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 16:54:32 +0300
Subject: [PATCH 073/166] Step 9.1: publish parties collection

---
 server/parties.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 server/parties.ts

diff --git a/server/parties.ts b/server/parties.ts
new file mode 100644
index 0000000..4a0580a
--- /dev/null
+++ b/server/parties.ts
@@ -0,0 +1,5 @@
+import {Parties} from 'collections/parties';
+
+Meteor.publish('parties', function() {
+    return Parties.find();
+});
-- 
2.5.4 (Apple Git-61)


From 1ca1d89100c567b30eddc4ccde0640abce2925aa Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 16:56:16 +0300
Subject: [PATCH 074/166] Step 9.2: import parties publications on the server

---
 server/main.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.ts b/server/main.ts
index 3e7deac..f735195 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -1,3 +1,4 @@
 import {loadParties} from './load-parties';
+import './parties';
 
 Meteor.startup(loadParties);
-- 
2.5.4 (Apple Git-61)


From d984b37d9faae57e4197d847b0b148efeb0bfde5 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 17:12:19 +0300
Subject: [PATCH 075/166] Step 9.3: extend PartiesList and make use of
 subscribe method

---
 client/parties-list/parties-list.ts | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 9444cba..3631c29 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -8,6 +8,8 @@ import {RouterLink} from 'angular2/router';
 
 import {AccountsUI} from 'meteor-accounts-ui';
 
+import {MeteorComponent} from 'angular2-meteor';
+
 @Component({
     selector: 'parties-list'
 })
@@ -15,11 +17,14 @@ import {AccountsUI} from 'meteor-accounts-ui';
     templateUrl: '/client/parties-list/parties-list.html',
     directives: [PartiesForm, RouterLink, AccountsUI]
 })
-export class PartiesList {
+export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
 
     constructor() {
-        this.parties = Parties.find();
+        super();
+        this.subscribe('parties', () => {
+            this.parties = Parties.find();
+        }, true);
     }
 
     removeParty(party) {
-- 
2.5.4 (Apple Git-61)


From 208bd810aa1560a3dbee061ab9fc52014496443a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 17:23:21 +0300
Subject: [PATCH 076/166] Step 9.4: add "Public" checkbox

---
 client/parties-form/parties-form.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties-form/parties-form.html b/client/parties-form/parties-form.html
index da869fb..54cc2c8 100644
--- a/client/parties-form/parties-form.html
+++ b/client/parties-form/parties-form.html
@@ -5,5 +5,7 @@
   <input type="text" ngControl="description">
   <label>Location</label>
   <input type="text" ngControl="location">
+  <label>Public</label>
+  <input type="checkbox" ngControl="public">
   <button>Add</button>
 </form>
-- 
2.5.4 (Apple Git-61)


From dc852c0cb67ddff74b3e41b0754816cc73e7fa36 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 17:50:21 +0300
Subject: [PATCH 077/166] Step 9.5: update PartiesForm component

---
 client/parties-form/parties-form.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index b0428ec..f76b3fd 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -18,7 +18,8 @@ export class PartiesForm {
         this.partiesForm = fb.group({
             name: ['', Validators.required],
             description: [''],
-            location: ['', Validators.required]
+            location: ['', Validators.required],
+            public: [false]
         });
     }
 
@@ -29,12 +30,14 @@ export class PartiesForm {
                     name: party.name,
                     description: party.description,
                     location: party.location,
+                    public: party.public,
                     owner: Meteor.userId()
                 });
 
                 (&lt;Control>this.partiesForm.controls['name']).updateValue('');
                 (&lt;Control>this.partiesForm.controls['description']).updateValue('');
                 (&lt;Control>this.partiesForm.controls['location']).updateValue('');
+                (&lt;Control>this.partiesForm.controls['public']).updateValue(false);
             } else {
                 alert('Please log in to add a party');
             }
-- 
2.5.4 (Apple Git-61)


From 390cbc8d31ef4b229e010a7f0bb96aa1bc7597b9 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 17:51:40 +0300
Subject: [PATCH 078/166] Step 9.6: add public field to the initial parties

---
 server/load-parties.ts | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/server/load-parties.ts b/server/load-parties.ts
index 65c914a..51bdd88 100644
--- a/server/load-parties.ts
+++ b/server/load-parties.ts
@@ -7,17 +7,20 @@ export function loadParties() {
         {
             'name': 'Dubstep-Free Zone',
             'description': 'Can we please just for an evening not listen to dubstep.',
-            'location': 'Palo Alto'
+            'location': 'Palo Alto',
+            'public': true
         },
         {
             'name': 'All dubstep all the time',
             'description': 'Get it on!',
-            'location': 'Palo Alto'
+            'location': 'Palo Alto',
+            'public': true
         },
         {
             'name': 'Savage lounging',
             'description': 'Leisure suit required. And only fiercest manners.',
-            'location': 'San Francisco'
+            'location': 'San Francisco',
+            'public': false
         }
     ];
 
-- 
2.5.4 (Apple Git-61)


From dabb46c5bbfcbf5cc8d4f10614777df662cf633a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 18:13:29 +0300
Subject: [PATCH 079/166] Step 9.7: limit data sent to the client

---
 server/parties.ts | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/server/parties.ts b/server/parties.ts
index 4a0580a..471c61f 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -1,5 +1,15 @@
 import {Parties} from 'collections/parties';
 
 Meteor.publish('parties', function() {
-    return Parties.find();
+    return Parties.find({
+        $or: [
+            { public: true },
+            {
+                $and: [
+                  { owner: this.userId },
+                  { owner: { $exists: true } }
+                ]
+            }
+        ]
+    });
 });
-- 
2.5.4 (Apple Git-61)


From cab0b01c2113c1f1d6ccad649ab51311e4eedf31 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 18:36:07 +0300
Subject: [PATCH 080/166] Step 9.8: add "party" publication

---
 server/parties.ts | 24 +++++++++++++++++++-----
 1 file changed, 19 insertions(+), 5 deletions(-)

diff --git a/server/parties.ts b/server/parties.ts
index 471c61f..bde5a59 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -1,15 +1,29 @@
 import {Parties} from 'collections/parties';
 
-Meteor.publish('parties', function() {
-    return Parties.find({
+function buildQuery(partyId?: string): Object {
+    var isAvailable = {
         $or: [
             { public: true },
             {
                 $and: [
-                  { owner: this.userId },
-                  { owner: { $exists: true } }
+                    { owner: this.userId },
+                    { owner: { $exists: true } }
                 ]
             }
         ]
-    });
+    };
+
+    if (partyId) {
+        return { $and: [{ _id: partyId }, isAvailable] };
+    }
+
+    return isAvailable;
+}
+
+Meteor.publish('parties', function() {
+    return Parties.find(buildQuery.call(this));
+});
+
+Meteor.publish('party', function(partyId: string) {
+    return Parties.find(buildQuery.call(this, partyId));
 });
-- 
2.5.4 (Apple Git-61)


From a789a1acae23ecb9f6e58dff844b4576931e02b1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 18:51:42 +0300
Subject: [PATCH 081/166] Step 9.9: subscribe to the "party" publication

---
 client/party-details/party-details.ts | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index ec2230a..c8b9a2c 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -8,6 +8,8 @@ import {RouterLink} from 'angular2/router';
 
 import {RequireUser} from 'meteor-accounts';
 
+import {MeteorComponent} from 'angular2-meteor';
+
 @Component({
     selector: 'party-details'
 })
@@ -16,12 +18,15 @@ import {RequireUser} from 'meteor-accounts';
     directives: [RouterLink]
 })
 @RequireUser()
-export class PartyDetails {
+export class PartyDetails extends MeteorComponent {
     party: Party;
 
     constructor(params: RouteParams) {
+        super();
         var partyId = params.get('partyId');
-        this.party = Parties.findOne(partyId);
+        this.subscribe('party', partyId, () => {
+            this.party = Parties.findOne(partyId);
+        }, true);
     }
 
     saveParty(party) {
-- 
2.5.4 (Apple Git-61)


From dfbc46212117b43af4bc123fc41479b2e8a375fd Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 18:52:51 +0300
Subject: [PATCH 082/166] Step 9.10: show PartyDetails when the party is loaded

---
 client/party-details/party-details.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 61fda60..58168fc 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -1,4 +1,4 @@
-<form (submit)="saveParty(party)">
+<form (submit)="saveParty(party)" *ngIf="party">
   <label>Name</label>
   <input type="text" [(ngModel)]="party.name">
 
-- 
2.5.4 (Apple Git-61)


From 976e002035926335d815c407044b75c18e824768 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 19:36:06 +0300
Subject: [PATCH 083/166] Step 9.11: add search inputs

---
 client/parties-list/parties-list.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index 21c7ea8..7dd6c7e 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -1,5 +1,7 @@
 <div>
-  <parties-form></parties-form>
+  <parties-form style="float: left"></parties-form>
+  <input type="text" #searchtext placeholder="Search by Location">
+  <button type="button" (click)="search(searchtext.value)">Search</button>
   <accounts-ui></accounts-ui>
   <ul>
     <li *ngFor="#party of parties">
-- 
2.5.4 (Apple Git-61)


From 7d19d4bf22b631a158eff61d531f021bfd0d2b31 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 13 Nov 2015 19:36:32 +0300
Subject: [PATCH 084/166] Step 9.12: add search click event handler

---
 client/parties-list/parties-list.ts | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 3631c29..2b75742 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -30,4 +30,12 @@ export class PartiesList extends MeteorComponent {
     removeParty(party) {
         Parties.remove(party._id);
     }
+
+    search(value: string) {
+        if (value) {
+            this.parties = Parties.find({ location: value });
+        } else {
+            this.parties = Parties.find();
+        }
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 108039672c3a981404d81cd7f90942eedfba9d2d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 12 Dec 2015 18:26:23 +0300
Subject: [PATCH 085/166] Corrects Party interface in the party.d.ts definition
 file

---
 typings/party.d.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/typings/party.d.ts b/typings/party.d.ts
index c57fd4a..bd9cd0c 100644
--- a/typings/party.d.ts
+++ b/typings/party.d.ts
@@ -4,4 +4,5 @@ interface Party {
   description?: string;
   location: string;
   owner?: string;
+  public: boolean;
 }
-- 
2.5.4 (Apple Git-61)


From bec67147c3e27ea25d9aacdee931eb1398b787e1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 19 Dec 2015 22:16:23 +0300
Subject: [PATCH 086/166] Step 12.1: add options to the parties publication

---
 server/parties.ts | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/parties.ts b/server/parties.ts
index bde5a59..6adc3ef 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -20,8 +20,8 @@ function buildQuery(partyId?: string): Object {
     return isAvailable;
 }
 
-Meteor.publish('parties', function() {
-    return Parties.find(buildQuery.call(this));
+Meteor.publish('parties', function(options: Object) {
+    return Parties.find(buildQuery.call(this), options);
 });
 
 Meteor.publish('party', function(partyId: string) {
-- 
2.5.4 (Apple Git-61)


From 13b8c4fb30fd686ceba85960ee0ba423778fecb1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 19 Dec 2015 22:30:59 +0300
Subject: [PATCH 087/166] Step 12.2: create options and add them to the parties
 subscription

---
 client/parties-list/parties-list.ts | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 2b75742..690e4f6 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -19,10 +19,18 @@ import {MeteorComponent} from 'angular2-meteor';
 })
 export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
+    pageSize: number = 10;
+    curPage: number = 1;
+    nameOrder: number = 1;
 
     constructor() {
         super();
-        this.subscribe('parties', () => {
+        let options = { 
+            limit: this.pageSize,
+            skip: (this.curPage - 1) * this.pageSize,
+            sort: { name: this.nameOrder }
+        }
+        this.subscribe('parties', options, () => {
             this.parties = Parties.find();
         }, true);
     }
-- 
2.5.4 (Apple Git-61)


From 1cf4e33e637c92fe756b11b126fbdffe992b0679 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 19 Dec 2015 22:41:56 +0300
Subject: [PATCH 088/166] Step 12.3: add sorting by party name to PartiesList

---
 client/parties-list/parties-list.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 690e4f6..dd694ea 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -31,7 +31,7 @@ export class PartiesList extends MeteorComponent {
             sort: { name: this.nameOrder }
         }
         this.subscribe('parties', options, () => {
-            this.parties = Parties.find();
+            this.parties = Parties.find({}, {sort: { name: this.nameOrder }});
         }, true);
     }
 
-- 
2.5.4 (Apple Git-61)


From d8d6c2c1d4228e9046529f202c5d1298719cad8e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 19 Dec 2015 22:44:38 +0300
Subject: [PATCH 089/166] Step 12.4: re-subscribe on current page changes
 reactively

---
 client/parties-list/parties-list.ts | 20 +++++++++++---------
 1 file changed, 11 insertions(+), 9 deletions(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index dd694ea..e676414 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -20,19 +20,21 @@ import {MeteorComponent} from 'angular2-meteor';
 export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
     pageSize: number = 10;
-    curPage: number = 1;
+    curPage: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     nameOrder: number = 1;
 
     constructor() {
         super();
-        let options = { 
-            limit: this.pageSize,
-            skip: (this.curPage - 1) * this.pageSize,
-            sort: { name: this.nameOrder }
-        }
-        this.subscribe('parties', options, () => {
-            this.parties = Parties.find({}, {sort: { name: this.nameOrder }});
-        }, true);
+        this.autorun(() => {
+            let options = {
+                limit: this.pageSize,
+                skip: (this.curPage.get() - 1) * this.pageSize,
+                sort: { name: this.nameOrder }
+            };
+            this.subscribe('parties', options, () => {
+                this.parties = Parties.find({}, { sort: { name: this.nameOrder } });
+            }, true);
+        });
     }
 
     removeParty(party) {
-- 
2.5.4 (Apple Git-61)


From 14fd13e14f6d1e17976e33f5d0dfd856fb5b006f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 19 Dec 2015 23:01:40 +0300
Subject: [PATCH 090/166] Add reactive-var package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index cd3ad8c..75b83f7 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ urigo:angular2-meteor
 accounts-password
 barbatus:ng2-meteor-accounts-ui
 barbatus:ng2-meteor-accounts
+reactive-var
-- 
2.5.4 (Apple Git-61)


From d1d5ba80cf05a9f1ccb8d05fe2e5ca8f2b4c044f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 00:19:46 +0300
Subject: [PATCH 091/166] Add n2-pagination package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 75b83f7..bcc99e0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ accounts-password
 barbatus:ng2-meteor-accounts-ui
 barbatus:ng2-meteor-accounts
 reactive-var
+barbatus:ng2-pagination
-- 
2.5.4 (Apple Git-61)


From 65d49ac71207aee045d99b7fafb05b8d2a2bce36 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 00:44:19 +0300
Subject: [PATCH 092/166] Step 12.5: import and set up pagination components

---
 client/parties-list/parties-list.ts | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index e676414..e8c9ca8 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -10,12 +10,16 @@ import {AccountsUI} from 'meteor-accounts-ui';
 
 import {MeteorComponent} from 'angular2-meteor';
 
+import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagination';
+
 @Component({
-    selector: 'parties-list'
+    selector: 'parties-list',
+    viewProviders: [PaginationService]
 })
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
-    directives: [PartiesForm, RouterLink, AccountsUI]
+    directives: [PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
+    pipes: [PaginatePipe]
 })
 export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
-- 
2.5.4 (Apple Git-61)


From c058b6aec71f66496e1429216d4d1b5cabf96174 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 7 Jan 2016 16:04:26 +0700
Subject: [PATCH 093/166] Step 12.6: add pagination typings

---
 tsconfig.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tsconfig.json b/tsconfig.json
index ee0dc8b..316379a 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -9,6 +9,7 @@
     "typings/angular2-meteor/angular2-meteor.d.ts",
     "typings/ng2-meteor-accounts-ui/ng2-meteor-accounts-ui.d.ts",
     "typings/ng2-meteor-accounts/ng2-meteor-accounts.d.ts",
+    "typings/ng2-pagination/ng2-pagination.d.ts",
     "typings/party.d.ts",
     "client/app.ts",
     "server/main.ts"
-- 
2.5.4 (Apple Git-61)


From d81da3737565a1603fc4072ebbf5800262881e0f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 00:53:27 +0300
Subject: [PATCH 094/166] Step 12.7: add pagination markup to the PartiesList's
 template

---
 client/parties-list/parties-list.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index 7dd6c7e..a5f16df 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -4,11 +4,12 @@
   <button type="button" (click)="search(searchtext.value)">Search</button>
   <accounts-ui></accounts-ui>
   <ul>
-    <li *ngFor="#party of parties">
+    <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: 30}">
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
       <button (click)="removeParty(party)">X</button>
     </li>
   </ul>
+  <pagination-controls></pagination-controls>
 </div>
-- 
2.5.4 (Apple Git-61)


From 587e8d1394b193e3ccd54558bca846fed00880c0 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 12:27:40 +0300
Subject: [PATCH 095/166] Step 12.8: handle page changed event of the
 pagination controls

---
 client/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index a5f16df..dcca4f3 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -11,5 +11,5 @@
       <button (click)="removeParty(party)">X</button>
     </li>
   </ul>
-  <pagination-controls></pagination-controls>
+  <pagination-controls (change)="onPageChanged($event.page)"></pagination-controls>
 </div>
-- 
2.5.4 (Apple Git-61)


From d169bf44fb702dec2d325f01eb6afd8a01ac16fe Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 12:28:52 +0300
Subject: [PATCH 096/166] Step 12.9: add page changed event handler to the
 component

---
 client/parties-list/parties-list.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index e8c9ca8..9103f57 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -52,4 +52,8 @@ export class PartiesList extends MeteorComponent {
             this.parties = Parties.find();
         }
     }
+
+    onPageChanged(page: number) {
+        this.curPage.set(page);
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 10d0afc789f521f1f8aa6aeaa46d6e5d2b88525f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:09:27 +0300
Subject: [PATCH 097/166] Add tmeasday:publish-counts package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index bcc99e0..9aa7932 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ barbatus:ng2-meteor-accounts-ui
 barbatus:ng2-meteor-accounts
 reactive-var
 barbatus:ng2-pagination
+tmeasday:publish-counts
-- 
2.5.4 (Apple Git-61)


From ff7117c86f91166670ddef57a0c01e5c0a8b2b8e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:09:54 +0300
Subject: [PATCH 098/166] Step 12.10: publish total number of parties

---
 server/parties.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/parties.ts b/server/parties.ts
index 6adc3ef..c5396cf 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -21,6 +21,7 @@ function buildQuery(partyId?: string): Object {
 }
 
 Meteor.publish('parties', function(options: Object) {
+    Counts.publish(this, 'numberOfParties', Parties.find(buildQuery.call(this)), { noReady: true });
     return Parties.find(buildQuery.call(this), options);
 });
 
-- 
2.5.4 (Apple Git-61)


From d3d72cccd6c0efeae189b14813bc578e94306248 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:13:52 +0300
Subject: [PATCH 099/166] Step 12.11: handle reactive updates of the parties
 total number

---
 client/parties-list/parties-list.ts | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 9103f57..d129261 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -26,6 +26,7 @@ export class PartiesList extends MeteorComponent {
     pageSize: number = 10;
     curPage: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     nameOrder: number = 1;
+    partiesSize: number = 0;
 
     constructor() {
         super();
@@ -39,6 +40,10 @@ export class PartiesList extends MeteorComponent {
                 this.parties = Parties.find({}, { sort: { name: this.nameOrder } });
             }, true);
         });
+
+        this.autorun(() => {
+            this.partiesSize = Counts.get('numberOfParties');
+        }, true);
     }
 
     removeParty(party) {
-- 
2.5.4 (Apple Git-61)


From b963d1899fd7090189940d22fa2055b6b5541d91 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:19:49 +0300
Subject: [PATCH 100/166] Step 12.12: add parties total number var in the
 template

---
 client/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index dcca4f3..f983878 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -4,7 +4,7 @@
   <button type="button" (click)="search(searchtext.value)">Search</button>
   <accounts-ui></accounts-ui>
   <ul>
-    <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: 30}">
+    <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}">
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
-- 
2.5.4 (Apple Git-61)


From 1e1f1e20227435a9ec6f76cfeaeb1b567f466978 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:51:53 +0300
Subject: [PATCH 101/166] Step 12.13: add a sort order dropdown

---
 client/parties-list/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index f983878..5a78db8 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -3,6 +3,13 @@
   <input type="text" #searchtext placeholder="Search by Location">
   <button type="button" (click)="search(searchtext.value)">Search</button>
   <accounts-ui></accounts-ui>
+  <h1>Parties:</h1>
+  <div>
+    <select #sort (change)="changeSortOrder(sort.value)">
+      <option value="1" selected>Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
   <ul>
     <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}">
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
-- 
2.5.4 (Apple Git-61)


From e47a949da6a266ca79222a64be22d394e480c90a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 13:52:45 +0300
Subject: [PATCH 102/166] Step 12.14: re-subscribe reactively when sort order
 changes

---
 client/parties-list/parties-list.ts | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index d129261..96d74f7 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -25,7 +25,7 @@ export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
     pageSize: number = 10;
     curPage: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
-    nameOrder: number = 1;
+    nameOrder: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     partiesSize: number = 0;
 
     constructor() {
@@ -34,10 +34,10 @@ export class PartiesList extends MeteorComponent {
             let options = {
                 limit: this.pageSize,
                 skip: (this.curPage.get() - 1) * this.pageSize,
-                sort: { name: this.nameOrder }
+                sort: { name: this.nameOrder.get() }
             };
             this.subscribe('parties', options, () => {
-                this.parties = Parties.find({}, { sort: { name: this.nameOrder } });
+                this.parties = Parties.find({}, { sort: { name: this.nameOrder.get() } });
             }, true);
         });
 
@@ -61,4 +61,8 @@ export class PartiesList extends MeteorComponent {
     onPageChanged(page: number) {
         this.curPage.set(page);
     }
+
+    changeSortOrder(nameOrder: string) {
+        this.nameOrder.set(parseInt(nameOrder));
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 3dafc8c01ad9c91373f7bfc57974af20bd06ad91 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 20:52:38 +0300
Subject: [PATCH 103/166] Step 12.15: add search by the party location using
 Mongo regex

---
 server/parties.ts | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

diff --git a/server/parties.ts b/server/parties.ts
index c5396cf..3b2e497 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -1,6 +1,6 @@
 import {Parties} from 'collections/parties';
 
-function buildQuery(partyId?: string): Object {
+function buildQuery(partyId: string, location: string): Object {
     var isAvailable = {
         $or: [
             { public: true },
@@ -17,12 +17,15 @@ function buildQuery(partyId?: string): Object {
         return { $and: [{ _id: partyId }, isAvailable] };
     }
 
-    return isAvailable;
+    let searchRegEx = { '$regex': '.*' + (location || '') + '.*', '$options': 'i' };
+
+    return { $and: [{ location: searchRegEx }, isAvailable] };
 }
 
-Meteor.publish('parties', function(options: Object) {
-    Counts.publish(this, 'numberOfParties', Parties.find(buildQuery.call(this)), { noReady: true });
-    return Parties.find(buildQuery.call(this), options);
+Meteor.publish('parties', function(options: Object, location: string) {
+    Counts.publish(this, 'numberOfParties',
+        Parties.find(buildQuery.call(this, null, location)), { noReady: true });
+    return Parties.find(buildQuery.call(this, null, location), options);
 });
 
 Meteor.publish('party', function(partyId: string) {
-- 
2.5.4 (Apple Git-61)


From c162a9403d8c0dde3e8fb82b31d2ba19207e67cd Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sun, 20 Dec 2015 21:13:58 +0300
Subject: [PATCH 104/166] Step 12.16: add reactive search by the location on
 the client

---
 client/parties-list/parties-list.ts | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 96d74f7..23af89e 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -27,6 +27,7 @@ export class PartiesList extends MeteorComponent {
     curPage: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     nameOrder: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     partiesSize: number = 0;
+    location: ReactiveVar&lt;string> = new ReactiveVar&lt;string>(null);
 
     constructor() {
         super();
@@ -36,7 +37,7 @@ export class PartiesList extends MeteorComponent {
                 skip: (this.curPage.get() - 1) * this.pageSize,
                 sort: { name: this.nameOrder.get() }
             };
-            this.subscribe('parties', options, () => {
+            this.subscribe('parties', options, this.location.get(), () => {
                 this.parties = Parties.find({}, { sort: { name: this.nameOrder.get() } });
             }, true);
         });
@@ -51,11 +52,8 @@ export class PartiesList extends MeteorComponent {
     }
 
     search(value: string) {
-        if (value) {
-            this.parties = Parties.find({ location: value });
-        } else {
-            this.parties = Parties.find();
-        }
+        this.curPage.set(1);
+        this.location.set(value);
     }
 
     onPageChanged(page: number) {
-- 
2.5.4 (Apple Git-61)


From 9db96154f01dcf64217e840e0ceccff98df216db Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 14:37:37 +0700
Subject: [PATCH 105/166] Step 13.1: add uninvited users publication

---
 server/users.ts | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 server/users.ts

diff --git a/server/users.ts b/server/users.ts
new file mode 100644
index 0000000..9365f30
--- /dev/null
+++ b/server/users.ts
@@ -0,0 +1,15 @@
+import {Parties} from 'collections/parties';
+
+Meteor.publish('uninvited', function(partyId: string) {
+    let party = Parties.findOne(partyId);
+
+    if (!party)
+        throw new Meteor.Error('404', 'No such party!');
+
+    return Meteor.users.find({
+        _id: {
+            $nin: party.invited || [],
+            $ne: this.userId
+        }
+    });
+});
-- 
2.5.4 (Apple Git-61)


From d2f9e62bdf79efdc02cc8e37d224691e485d59ee Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 14:45:37 +0700
Subject: [PATCH 106/166] Step 13.2: import users publications on the server
 start

---
 server/main.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.ts b/server/main.ts
index f735195..ebfe211 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -1,4 +1,5 @@
 import {loadParties} from './load-parties';
 import './parties';
+import './users';
 
 Meteor.startup(loadParties);
-- 
2.5.4 (Apple Git-61)


From 19419f2afbbe2e210493b4152e050bba49d3b35a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 14:49:16 +0700
Subject: [PATCH 107/166] Step 13.3: load uninvited users

---
 client/party-details/party-details.ts | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index c8b9a2c..c04158a 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -20,6 +20,7 @@ import {MeteorComponent} from 'angular2-meteor';
 @RequireUser()
 export class PartyDetails extends MeteorComponent {
     party: Party;
+    users: Mongo.Cursor&lt;Object>;
 
     constructor(params: RouteParams) {
         super();
@@ -27,6 +28,10 @@ export class PartyDetails extends MeteorComponent {
         this.subscribe('party', partyId, () => {
             this.party = Parties.findOne(partyId);
         }, true);
+
+        this.subscribe('uninvited', partyId, () => {
+          this.users = Meteor.users.find({_id: {$ne: Meteor.userId()}});
+        }, true);
     }
 
     saveParty(party) {
-- 
2.5.4 (Apple Git-61)


From 79e8a3a9696f5b47c4de63f4775302ce935d3582 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 14:49:53 +0700
Subject: [PATCH 108/166] Add invited to the party definition

---
 typings/party.d.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/typings/party.d.ts b/typings/party.d.ts
index bd9cd0c..bb48676 100644
--- a/typings/party.d.ts
+++ b/typings/party.d.ts
@@ -5,4 +5,5 @@ interface Party {
   location: string;
   owner?: string;
   public: boolean;
+  invited?: Array&lt;string>;
 }
-- 
2.5.4 (Apple Git-61)


From 009e1bfbd0d46155851867c3e503f52617bdec6e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 14:52:39 +0700
Subject: [PATCH 109/166] Step 13.4: render uninvited users

---
 client/party-details/party-details.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 58168fc..4ba0656 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -11,3 +11,10 @@
   <button type="submit">Save</button>
   <button [routerLink]="['/PartiesList']">Cancel</button>
 </form>
+
+<ul>
+  Users to invite:
+  <li *ngFor="#user of users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
-- 
2.5.4 (Apple Git-61)


From ebb542dc3c8297b00475b24a35a6b8326241c859 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 20:30:45 +0700
Subject: [PATCH 110/166] Step 13.5: add new pipe to render user name

---
 client/lib/pipes.ts | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 client/lib/pipes.ts

diff --git a/client/lib/pipes.ts b/client/lib/pipes.ts
new file mode 100644
index 0000000..12c051f
--- /dev/null
+++ b/client/lib/pipes.ts
@@ -0,0 +1,22 @@
+import {Pipe} from 'angular2/core';
+
+@Pipe({
+    name: 'displayName'
+})
+export class DisplayName {
+    transform(user: Meteor.User): string {
+        if (!user) {
+            return '';
+        }
+
+        if (user.username) {
+            return user.username;
+        }
+        
+        if (user.emails) {
+            return user.emails[0].address;
+        }
+        
+        return '';
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 81e9d99dc41330963a64147ad90df4b89054e9a2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 20:39:03 +0700
Subject: [PATCH 111/166] Step 13.6: make use of the pipe in the template

---
 client/party-details/party-details.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 4ba0656..0a61451 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -15,6 +15,6 @@
 <ul>
   Users to invite:
   <li *ngFor="#user of users">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayName }}</div>
   </li>
 </ul>
-- 
2.5.4 (Apple Git-61)


From bfd3736b4b3e138794a8a9c8f03cfcd174b89c7a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 20:40:13 +0700
Subject: [PATCH 112/166] Step 13.7: import DisplayName pipe and add it to the
 view

---
 client/party-details/party-details.ts | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index c04158a..42357a0 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -10,10 +10,13 @@ import {RequireUser} from 'meteor-accounts';
 
 import {MeteorComponent} from 'angular2-meteor';
 
+import {DisplayName} from 'client/lib/pipes';
+
 @Component({
     selector: 'party-details'
 })
 @View({
+    pipes: [DisplayName],
     templateUrl: '/client/party-details/party-details.html',
     directives: [RouterLink]
 })
-- 
2.5.4 (Apple Git-61)


From df587d63bcdcca2d83f190cce6dbb98ea01e742f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 23 Dec 2015 21:34:51 +0700
Subject: [PATCH 113/166] Step 13.8: configure accounts UI

---
 client/app.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/app.ts b/client/app.ts
index 19eb1de..f73bb62 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -8,6 +8,10 @@ import {PartiesList} from 'client/parties-list/parties-list';
 
 import {PartyDetails} from 'client/party-details/party-details';
 
+Accounts.ui.config({
+  passwordSignupFields: 'USERNAME_AND_EMAIL'
+});
+
 @Component({
     selector: 'app'
 })
-- 
2.5.4 (Apple Git-61)


From 8fb12e534bcef390011a21ae612d3b83e26c1e39 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 15:12:20 +0700
Subject: [PATCH 114/166] Step 14.1: add a party invitation method

---
 collections/methods.ts | 44 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 collections/methods.ts

diff --git a/collections/methods.ts b/collections/methods.ts
new file mode 100644
index 0000000..c1aa134
--- /dev/null
+++ b/collections/methods.ts
@@ -0,0 +1,44 @@
+import {Parties} from './parties';
+
+function getContactEmail(user: Meteor.User): string {
+    if (user.emails && user.emails.length)
+        return user.emails[0].address;
+
+    return null;
+};
+
+Meteor.methods({
+    invite: function(partyId: string, userId: string) {
+        check(partyId, String);
+        check(userId, String);
+
+        let party = Parties.findOne(partyId);
+
+        if (!party)
+            throw new Meteor.Error('404', 'No such party!');
+
+        if (party.public)
+            throw new Meteor.Error('400', 'That party is public. No need to invite people.');
+
+        if (party.owner !== this.userId)
+            throw new Meteor.Error('403', 'No permissions!');
+
+        if (userId !== party.owner && (party.invited || []).indexOf(userId) == -1) {
+            Parties.update(partyId, { $addToSet: { invited: userId } });
+
+            let from = getContactEmail(Meteor.users.findOne(this.userId));
+            let to = getContactEmail(Meteor.users.findOne(userId));
+
+            if (Meteor.isServer && to) {
+                Email.send({
+                    from: 'noreply@socially.com',
+                    to: to,
+                    replyTo: from || undefined,
+                    subject: 'PARTY: ' + party.name,
+                    text: `Hi, I just invited you to ${party.name} on Socially.
+                        \n\nCome check it out: ${Meteor.absoluteUrl()}\n`
+                });
+            }
+        }
+    }
+});
-- 
2.5.4 (Apple Git-61)


From a613d612982b8d2635b25cc171d2548ecdc86c16 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 15:43:08 +0700
Subject: [PATCH 115/166] Step 14.2: import methods on the server side

---
 server/main.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.ts b/server/main.ts
index ebfe211..a463eea 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -1,5 +1,6 @@
 import {loadParties} from './load-parties';
 import './parties';
 import './users';
+import 'collections/methods';
 
 Meteor.startup(loadParties);
-- 
2.5.4 (Apple Git-61)


From 1e5509d96a5cb5bc2d26d82fd5f7ee2b90c53e3d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 1 Jan 2016 19:14:20 +0700
Subject: [PATCH 116/166] Step 14.3: import methods on the client

---
 client/app.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/app.ts b/client/app.ts
index f73bb62..9321620 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -8,6 +8,8 @@ import {PartiesList} from 'client/parties-list/parties-list';
 
 import {PartyDetails} from 'client/party-details/party-details';
 
+import 'collections/methods';
+
 Accounts.ui.config({
   passwordSignupFields: 'USERNAME_AND_EMAIL'
 });
-- 
2.5.4 (Apple Git-61)


From 9f2161978966a97127eb93eca26f73fad059e1b1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 15:55:43 +0700
Subject: [PATCH 117/166] Step 14.4: add "invite" button

---
 client/party-details/party-details.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 0a61451..b671ff0 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -16,5 +16,6 @@
   Users to invite:
   <li *ngFor="#user of users">
     <div>{{ user | displayName }}</div>
+    <button (click)="invite(user)">Invite</button>
   </li>
 </ul>
-- 
2.5.4 (Apple Git-61)


From 9500615114a763718569c2d26dbb4435d310d3d5 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 15:56:51 +0700
Subject: [PATCH 118/166] Step 14.5: add the click handler and call "invite"
 method

---
 client/party-details/party-details.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 42357a0..51916d2 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -50,4 +50,15 @@ export class PartyDetails extends MeteorComponent {
         alert('Please log in to change this party');
       }
     }
+
+    invite(user: Meteor.User) {
+      this.call('invite', this.party._id, user._id, (error) => {
+        if (error) {
+          alert(`Failed to invite due to ${error}`);
+          return;
+        }
+
+        alert('User successfully invited.');
+      });
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 4ea7de62733a31ff33436a791aabc294b84eb795 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 16:02:54 +0700
Subject: [PATCH 119/166] Add check package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 9aa7932..c784804 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ barbatus:ng2-meteor-accounts
 reactive-var
 barbatus:ng2-pagination
 tmeasday:publish-counts
+check
-- 
2.5.4 (Apple Git-61)


From 11daa1e2f130f922d8dc5a69136fc4df9ea48b42 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 16:08:08 +0700
Subject: [PATCH 120/166] Add email package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index c784804..e15a342 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ reactive-var
 barbatus:ng2-pagination
 tmeasday:publish-counts
 check
+email
-- 
2.5.4 (Apple Git-61)


From a44ee41c3d5d90311c77bc937a60e178df828598 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 17:03:15 +0700
Subject: [PATCH 121/166] Step 14.6: get the party reactively

---
 client/party-details/party-details.ts | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 51916d2..f1056c6 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -29,8 +29,10 @@ export class PartyDetails extends MeteorComponent {
         super();
         var partyId = params.get('partyId');
         this.subscribe('party', partyId, () => {
-            this.party = Parties.findOne(partyId);
-        }, true);
+            this.autorun(() => {
+                this.party = Parties.findOne(partyId);
+            },   true);
+        });
 
         this.subscribe('uninvited', partyId, () => {
           this.users = Meteor.users.find({_id: {$ne: Meteor.userId()}});
-- 
2.5.4 (Apple Git-61)


From 0715ce0f6c409d3ce3cc5700a84223ed2ef01589 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 25 Dec 2015 17:08:47 +0700
Subject: [PATCH 122/166] Step 14.7: update the users list reactively

---
 client/party-details/party-details.ts | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index f1056c6..7c4a050 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -31,14 +31,26 @@ export class PartyDetails extends MeteorComponent {
         this.subscribe('party', partyId, () => {
             this.autorun(() => {
                 this.party = Parties.findOne(partyId);
+                this.getUsers(this.party);
             },   true);
         });
 
         this.subscribe('uninvited', partyId, () => {
-          this.users = Meteor.users.find({_id: {$ne: Meteor.userId()}});
+            this.getUsers(this.party);
         }, true);
     }
 
+    getUsers(party: Party) {
+        if (party) {
+            this.users = Meteor.users.find({
+                _id: {
+                    $nin: party.invited || [],
+                    $ne: Meteor.userId()
+                }
+            });
+        }
+    }
+
     saveParty(party) {
       if (Meteor.userId()) {
         Parties.update(party._id, {
-- 
2.5.4 (Apple Git-61)


From 89937e900aa007779a005a5d43f0675c089a63f8 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 19:39:34 +0700
Subject: [PATCH 123/166] Step 14.8: show private parties to the invited and
 owners only

---
 server/parties.ts | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/server/parties.ts b/server/parties.ts
index 3b2e497..70e1e07 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -8,7 +8,13 @@ function buildQuery(partyId: string, location: string): Object {
                 $and: [
                     { owner: this.userId },
                     { owner: { $exists: true } }
-                ]
+                ],
+            },
+            {
+              $and: [
+                { invited: this.userId },
+                { invited: { $exists: true } }
+              ]
             }
         ]
     };
-- 
2.5.4 (Apple Git-61)


From e8c40343b6ce630cd58c6809e8615a43f33081f1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 20:17:48 +0700
Subject: [PATCH 124/166] Step 14.9: add a "reply" method

---
 collections/methods.ts | 45 +++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 45 insertions(+)

diff --git a/collections/methods.ts b/collections/methods.ts
index c1aa134..fc9f58e 100644
--- a/collections/methods.ts
+++ b/collections/methods.ts
@@ -40,5 +40,50 @@ Meteor.methods({
                 });
             }
         }
+    },
+    reply: function(partyId: string, rsvp: string) {
+        check(partyId, String);
+        check(rsvp, String);
+
+        if (!this.userId)
+            throw new Meteor.Error('403', 'You must be logged-in to reply');
+
+        if (['yes', 'no', 'maybe'].indexOf(rsvp) === -1)
+            throw new Meteor.Error('400', 'Invalid RSVP');
+
+        let party = Parties.findOne({ _id: partyId });
+
+        if (!party)
+            throw new Meteor.Error('404', 'No such party');
+
+        if (party.owner === this.userId)
+            throw new Meteor.Error('500', 'You are the owner!');
+
+        if (!party.public && (!party.invited || party.invited.indexOf(this.userId) == -1))
+            throw new Meteor.Error('403', 'No such party'); // its private, but let's not tell this to the user
+ 
+        let rsvpIndex = party.rsvps ? party.rsvps.findIndex((rsvp) => rsvp.userId === this.userId) : -1;
+
+        if (rsvpIndex !== -1) {
+            // update existing rsvp entry
+            if (Meteor.isServer) {
+                // update the appropriate rsvp entry with $
+                Parties.update(
+                    { _id: partyId, 'rsvps.userId': this.userId },
+                    { $set: { 'rsvps.$.response': rsvp } });
+            } else {
+                // minimongo doesn't yet support $ in modifier. as a temporary
+                // workaround, make a modifier that uses an index. this is
+                // safe on the client since there's only one thread.
+                let modifier = { $set: {} };
+                modifier.$set['rsvps.' + rsvpIndex + '.response'] = rsvp;
+
+                Parties.update(partyId, modifier);
+            }
+        } else {
+            // add new rsvp entry
+            Parties.update(partyId,
+                { $push: { rsvps: { userId: this.userId, response: rsvp } } });
+        }
     }
 });
-- 
2.5.4 (Apple Git-61)


From 91024c7d297671f245c3cf5a048f38b631b4793d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 20:10:46 +0700
Subject: [PATCH 125/166] Step 14.10: update the party typings

---
 typings/party.d.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/typings/party.d.ts b/typings/party.d.ts
index bb48676..ea07831 100644
--- a/typings/party.d.ts
+++ b/typings/party.d.ts
@@ -6,4 +6,10 @@ interface Party {
   owner?: string;
   public: boolean;
   invited?: Array&lt;string>;
+  rsvps?: Array&lt;RSVP>;
+}
+
+interface RSVP {
+  userId: string;
+  response: string;
 }
-- 
2.5.4 (Apple Git-61)


From 92f73d2de58ea74926c6a765375bcc290baae39e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 20:33:48 +0700
Subject: [PATCH 126/166] Step 14.11: update PartyDetails view with the three
 response buttons

---
 client/party-details/party-details.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index b671ff0..971a2d7 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -19,3 +19,10 @@
     <button (click)="invite(user)">Invite</button>
   </li>
 </ul>
+
+<div>
+  <h2>Reply to the invitation</h2>
+  <input type="button" value="I'm going!" (click)="reply('yes')">
+  <input type="button" value="Maybe" (click)="reply('maybe')">
+  <input type="button" value="No" (click)="reply('no')">
+</div>
-- 
2.5.4 (Apple Git-61)


From e82e9bfb5071eb30a89a3f2b7e53021b254e8abd Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 20:37:05 +0700
Subject: [PATCH 127/166] Step 14.12: handle reply events in the PartyDetails
 component

---
 client/party-details/party-details.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 7c4a050..bcf3d7d 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -75,4 +75,15 @@ export class PartyDetails extends MeteorComponent {
         alert('User successfully invited.');
       });
     }
+
+    reply(rsvp: string) {
+      this.call('reply', this.party._id, rsvp, (error) => {
+        if (error) {
+          alert(`Failed to reply due to ${error}`);
+        }
+        else {
+          alert('You successfully replied.');
+        }
+      });
+    }
 }
-- 
2.5.4 (Apple Git-61)


From f59b0c1c183b9bc8c6fbf82f1eb42e3d4ec5ba67 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 21:34:49 +0700
Subject: [PATCH 128/166] Step 14.13: add a new response counting pipe

---
 client/lib/pipes.ts | 34 ++++++++++++++++++++++++++++++++++
 1 file changed, 34 insertions(+)

diff --git a/client/lib/pipes.ts b/client/lib/pipes.ts
index 12c051f..dd4da11 100644
--- a/client/lib/pipes.ts
+++ b/client/lib/pipes.ts
@@ -1,5 +1,9 @@
 import {Pipe} from 'angular2/core';
 
+import {Parties} from 'collections/parties';
+
+import {MeteorComponent} from 'angular2-meteor';
+
 @Pipe({
     name: 'displayName'
 })
@@ -20,3 +24,33 @@ export class DisplayName {
         return '';
     }
 }
+
+@Pipe({
+    name: 'rsvp',
+    pure: false
+})
+export class RsvpPipe extends MeteorComponent {
+    init: boolean = false;
+    total: number = 0;
+
+    transform(party: Party, args: any[]): number {
+        let type = args[0];
+        if (!type) {
+            return 0;
+        }
+
+        if (!this.init) {
+            this.autorun(() => {
+                party = Parties.findOne(party._id);
+                if (party) {
+                    this.total = party.rsvps ?
+                        party.rsvps.filter(rsvp => rsvp.response === type).length : 0;
+                }
+            }, true);
+            this.init = true;
+        }
+                    
+        return this.total;
+    }
+}
+
-- 
2.5.4 (Apple Git-61)


From 7d0368126f63db6b2ac1af48f5b377e161fe83aa Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 21:35:28 +0700
Subject: [PATCH 129/166] Step 14.14: display response statistics in the list

---
 client/parties-list/parties-list.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index 5a78db8..bf63448 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -16,6 +16,12 @@
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
       <button (click)="removeParty(party)">X</button>
+      <div>
+        Who is coming:
+        Yes - {{party | rsvp:'yes'}}
+        Maybe - {{party | rsvp:'maybe'}}
+        No - {{party | rsvp:'no'}}
+      </div>
     </li>
   </ul>
   <pagination-controls (change)="onPageChanged($event.page)"></pagination-controls>
-- 
2.5.4 (Apple Git-61)


From 2cc1899f680b837cd30bf4339c3f893c345e8e29 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 26 Dec 2015 21:36:23 +0700
Subject: [PATCH 130/166] Step 14.15: import the RsvpPipe pipe

---
 client/parties-list/parties-list.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 23af89e..336efce 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -12,6 +12,8 @@ import {MeteorComponent} from 'angular2-meteor';
 
 import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagination';
 
+import {RsvpPipe} from 'client/lib/pipes';
+
 @Component({
     selector: 'parties-list',
     viewProviders: [PaginationService]
@@ -19,7 +21,7 @@ import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagina
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
     directives: [PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
-    pipes: [PaginatePipe]
+    pipes: [PaginatePipe, RsvpPipe]
 })
 export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
-- 
2.5.4 (Apple Git-61)


From 430f5086f270ed904f01a59ec30c797601198f6c Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 17:42:26 +0700
Subject: [PATCH 131/166] Step 15.1: inject Meteor user and add isOwner method

---
 client/parties-list/parties-list.ts | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 336efce..c3ae7eb 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -8,6 +8,8 @@ import {RouterLink} from 'angular2/router';
 
 import {AccountsUI} from 'meteor-accounts-ui';
 
+import {InjectUser} from 'meteor-accounts';
+
 import {MeteorComponent} from 'angular2-meteor';
 
 import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagination';
@@ -23,6 +25,7 @@ import {RsvpPipe} from 'client/lib/pipes';
     directives: [PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
     pipes: [PaginatePipe, RsvpPipe]
 })
+@InjectUser()
 export class PartiesList extends MeteorComponent {
     parties: Mongo.Cursor&lt;Party>;
     pageSize: number = 10;
@@ -30,6 +33,7 @@ export class PartiesList extends MeteorComponent {
     nameOrder: ReactiveVar&lt;number> = new ReactiveVar&lt;number>(1);
     partiesSize: number = 0;
     location: ReactiveVar&lt;string> = new ReactiveVar&lt;string>(null);
+    user: Meteor.User;
 
     constructor() {
         super();
@@ -65,4 +69,12 @@ export class PartiesList extends MeteorComponent {
     changeSortOrder(nameOrder: string) {
         this.nameOrder.set(parseInt(nameOrder));
     }
+
+    isOwner(party: Party): boolean {
+        if (this.user) {
+            return this.user._id === party.owner;
+        }
+
+        return false;
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 2a27b3256259f9e203867f8f9f28aba8bc261499 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 17:46:08 +0700
Subject: [PATCH 132/166] Step 15.2: use the hidden attribute in the
 PartiesList template

---
 client/parties-list/parties-list.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index bf63448..f87d7d0 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -1,5 +1,5 @@
 <div>
-  <parties-form style="float: left"></parties-form>
+  <parties-form [hidden]="!user" style="float: left"></parties-form>
   <input type="text" #searchtext placeholder="Search by Location">
   <button type="button" (click)="search(searchtext.value)">Search</button>
   <accounts-ui></accounts-ui>
@@ -15,7 +15,7 @@
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
-      <button (click)="removeParty(party)">X</button>
+      <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
       <div>
         Who is coming:
         Yes - {{party | rsvp:'yes'}}
-- 
2.5.4 (Apple Git-61)


From dcb4894ccc48dee18d9b69d5b13b2883e415ec20 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 18:48:33 +0700
Subject: [PATCH 133/166] Step 15.3: add isOwner property into the PartyDetails

---
 client/party-details/party-details.ts | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index bcf3d7d..d3a411b 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -6,7 +6,7 @@ import {Parties} from 'collections/parties';
 
 import {RouterLink} from 'angular2/router';
 
-import {RequireUser} from 'meteor-accounts';
+import {RequireUser, InjectUser} from 'meteor-accounts';
 
 import {MeteorComponent} from 'angular2-meteor';
 
@@ -21,9 +21,11 @@ import {DisplayName} from 'client/lib/pipes';
     directives: [RouterLink]
 })
 @RequireUser()
+@InjectUser()
 export class PartyDetails extends MeteorComponent {
     party: Party;
     users: Mongo.Cursor&lt;Object>;
+    user: Meteor.User;
 
     constructor(params: RouteParams) {
         super();
@@ -86,4 +88,12 @@ export class PartyDetails extends MeteorComponent {
         }
       });
     }
+
+    get isOwner(): boolean {
+        if (this.party && this.user) {
+            return this.user._id === this.party.owner;
+        }
+
+        return false;
+    }
 }
-- 
2.5.4 (Apple Git-61)


From c4f7d5b5ab8a56077e6c834ad3212963447d766a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 18:49:13 +0700
Subject: [PATCH 134/166] Step 15.4: add disable attribute bindings

---
 client/party-details/party-details.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 971a2d7..95e6e57 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -1,14 +1,14 @@
 <form (submit)="saveParty(party)" *ngIf="party">
   <label>Name</label>
-  <input type="text" [(ngModel)]="party.name">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name">
 
   <label>Description</label>
-  <input type="text" [(ngModel)]="party.description">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description">
 
   <label>Location</label>
-  <input type="text" [(ngModel)]="party.location">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location">
 
-  <button type="submit">Save</button>
+  <button [disabled]="!isOwner" type="submit">Save</button>
   <button [routerLink]="['/PartiesList']">Cancel</button>
 </form>
 
-- 
2.5.4 (Apple Git-61)


From c758379c36bfe5c3e8b48d3e3a4758318dc0cfcb Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 19:40:08 +0700
Subject: [PATCH 135/166] Step 15.5: add isPublic and isInvited properties

---
 client/party-details/party-details.ts | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index d3a411b..5518440 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -96,4 +96,21 @@ export class PartyDetails extends MeteorComponent {
 
         return false;
     }
+
+    get isPublic(): boolean {
+        if (this.party) {
+            return this.party.public;
+        }
+
+        return false;
+    }
+
+    get isInvited(): boolean {
+        if (this.party && this.user) {
+            let invited = this.party.invited || [];
+            return invited.indexOf(this.user._id) !== -1;
+        }
+
+        return false;
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 19648ed9400737756166c590524bebe8442ff868 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Mon, 28 Dec 2015 19:40:32 +0700
Subject: [PATCH 136/166] Step 15.6: make use of the properties in the template

---
 client/party-details/party-details.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 95e6e57..1301c19 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -12,7 +12,7 @@
   <button [routerLink]="['/PartiesList']">Cancel</button>
 </form>
 
-<ul>
+<ul *ngIf="isOwner || isPublic">
   Users to invite:
   <li *ngFor="#user of users">
     <div>{{ user | displayName }}</div>
@@ -20,7 +20,7 @@
   </li>
 </ul>
 
-<div>
+<div *ngIf="isInvited">
   <h2>Reply to the invitation</h2>
   <input type="button" value="I'm going!" (click)="reply('yes')">
   <input type="button" value="Maybe" (click)="reply('maybe')">
-- 
2.5.4 (Apple Git-61)


From ac5255cbe67b0587e13082b1b9238a7f008683d3 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 12 Jan 2016 22:53:12 +0700
Subject: [PATCH 137/166] Step 16.1: extend party location with lat and lng
 coordinates

---
 typings/party.d.ts | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/typings/party.d.ts b/typings/party.d.ts
index ea07831..22d54b2 100644
--- a/typings/party.d.ts
+++ b/typings/party.d.ts
@@ -2,7 +2,11 @@ interface Party {
   _id?: string;
   name: string;
   description?: string;
-  location: string;
+  location: {
+    name: string;
+    lat?: number;
+    lng?: number;
+  };
   owner?: string;
   public: boolean;
   invited?: Array&lt;string>;
-- 
2.5.4 (Apple Git-61)


From 6c551468898af9876484369e6fd22b68cc5eb16d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 12 Jan 2016 22:56:15 +0700
Subject: [PATCH 138/166] Step 16.2: change initial parties accordingly

---
 server/load-parties.ts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/server/load-parties.ts b/server/load-parties.ts
index 51bdd88..ea27211 100644
--- a/server/load-parties.ts
+++ b/server/load-parties.ts
@@ -7,19 +7,25 @@ export function loadParties() {
         {
             'name': 'Dubstep-Free Zone',
             'description': 'Can we please just for an evening not listen to dubstep.',
-            'location': 'Palo Alto',
+            'location': {
+                name: 'Palo Alto'
+            },
             'public': true
         },
         {
             'name': 'All dubstep all the time',
             'description': 'Get it on!',
-            'location': 'Palo Alto',
+            'location': {
+                name: 'Palo Alto'
+            },
             'public': true
         },
         {
             'name': 'Savage lounging',
             'description': 'Leisure suit required. And only fiercest manners.',
-            'location': 'San Francisco',
+            'location': {
+                name: 'San Francisco'
+            },
             'public': false
         }
     ];
-- 
2.5.4 (Apple Git-61)


From 62916fefbd71b9879da11fc06edaec6fc44fa158 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 12 Jan 2016 22:58:29 +0700
Subject: [PATCH 139/166] Step 16.3: change party creation component

---
 client/parties-form/parties-form.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
index f76b3fd..7089ca8 100644
--- a/client/parties-form/parties-form.ts
+++ b/client/parties-form/parties-form.ts
@@ -29,7 +29,9 @@ export class PartiesForm {
                 Parties.insert({
                     name: party.name,
                     description: party.description,
-                    location: party.location,
+                    location: {
+                        name: party.location
+                    },
                     public: party.public,
                     owner: Meteor.userId()
                 });
-- 
2.5.4 (Apple Git-61)


From f4e123995959699d332244a35b2b3bbc46f1962d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 12 Jan 2016 23:04:28 +0700
Subject: [PATCH 140/166] Step 16.4: reflect type changes in the parties search

---
 server/parties.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/parties.ts b/server/parties.ts
index 70e1e07..415e710 100644
--- a/server/parties.ts
+++ b/server/parties.ts
@@ -25,7 +25,7 @@ function buildQuery(partyId: string, location: string): Object {
 
     let searchRegEx = { '$regex': '.*' + (location || '') + '.*', '$options': 'i' };
 
-    return { $and: [{ location: searchRegEx }, isAvailable] };
+    return { $and: [{ 'location.name': searchRegEx }, isAvailable] };
 }
 
 Meteor.publish('parties', function(options: Object, location: string) {
-- 
2.5.4 (Apple Git-61)


From 1e39e8f0806965cdef86a224a14d361af56e1aba Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 12:58:44 +0700
Subject: [PATCH 141/166] Step 16.5: import and install maps providers globally

---
 client/app.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/app.ts b/client/app.ts
index 9321620..607f9f1 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -10,6 +10,8 @@ import {PartyDetails} from 'client/party-details/party-details';
 
 import 'collections/methods';
 
+import {ANGULAR2_GOOGLE_MAPS_PROVIDERS} from 'ng2-google-maps/core';
+
 Accounts.ui.config({
   passwordSignupFields: 'USERNAME_AND_EMAIL'
 });
@@ -27,4 +29,4 @@ Accounts.ui.config({
 ])
 class Socially {}
 
-bootstrap(Socially, [ROUTER_PROVIDERS, provide(APP_BASE_HREF, { useValue: '/' })]);
+bootstrap(Socially, [ROUTER_PROVIDERS, ANGULAR2_GOOGLE_MAPS_PROVIDERS, provide(APP_BASE_HREF, { useValue: '/' })]);
-- 
2.5.4 (Apple Git-61)


From 89be73cd0c94939945584f6cf55212d6dbb6280c Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:02:02 +0700
Subject: [PATCH 142/166] Step 16.6: add maps markup to the PartyDetails
 template

---
 client/party-details/party-details.html | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
index 1301c19..3bda50c 100644
--- a/client/party-details/party-details.html
+++ b/client/party-details/party-details.html
@@ -6,7 +6,7 @@
   <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description">
 
   <label>Location</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name">
 
   <button [disabled]="!isOwner" type="submit">Save</button>
   <button [routerLink]="['/PartiesList']">Cancel</button>
@@ -26,3 +26,15 @@
   <input type="button" value="Maybe" (click)="reply('maybe')">
   <input type="button" value="No" (click)="reply('no')">
 </div>
+
+<sebm-google-map 
+  [latitude]="lat || centerLat"
+  [longitude]="lng || centerLng"
+  [zoom]="8"
+  (mapClick)="mapClicked($event)">
+  <sebm-google-map-marker
+    *ngIf="lat && lng"
+    [latitude]="lat"
+    [longitude]="lng">
+  </sebm-google-map-marker>
+</sebm-google-map>
-- 
2.5.4 (Apple Git-61)


From bce8e47788fad426ed8bef415b23b4a761e82786 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:12:12 +0700
Subject: [PATCH 143/166] Step 16.7: add maps logic to the PartyDetails
 component

---
 client/party-details/party-details.ts | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
index 5518440..7ef3e34 100644
--- a/client/party-details/party-details.ts
+++ b/client/party-details/party-details.ts
@@ -12,13 +12,15 @@ import {MeteorComponent} from 'angular2-meteor';
 
 import {DisplayName} from 'client/lib/pipes';
 
+import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
+
 @Component({
     selector: 'party-details'
 })
 @View({
     pipes: [DisplayName],
     templateUrl: '/client/party-details/party-details.html',
-    directives: [RouterLink]
+    directives: [RouterLink, ANGULAR2_GOOGLE_MAPS_DIRECTIVES]
 })
 @RequireUser()
 @InjectUser()
@@ -27,6 +29,10 @@ export class PartyDetails extends MeteorComponent {
     users: Mongo.Cursor&lt;Object>;
     user: Meteor.User;
 
+    // Default center Palo Alto coordinates.
+    centerLat: Number = 37.4292; 
+    centerLng: Number = -122.1381;
+
     constructor(params: RouteParams) {
         super();
         var partyId = params.get('partyId');
@@ -113,4 +119,17 @@ export class PartyDetails extends MeteorComponent {
 
         return false;
     }
+
+    get lat(): Number {
+        return this.party && this.party.location.lat;
+    }
+
+    get lng(): Number {
+        return this.party && this.party.location.lng;
+    }
+
+    mapClicked($event: MapMouseEvent) {
+        this.party.location.lat = $event.coords.lat;
+        this.party.location.lng = $event.coords.lng;
+    }
 }
-- 
2.5.4 (Apple Git-61)


From 0985f8ffe372a03c1ac8b4237867517ebb751b3d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:16:37 +0700
Subject: [PATCH 144/166] Step 16.8: create main CSS file and add maps styles
 there

---
 client/css/main.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/css/main.css

diff --git a/client/css/main.css b/client/css/main.css
new file mode 100644
index 0000000..1484170
--- /dev/null
+++ b/client/css/main.css
@@ -0,0 +1,4 @@
+.sebm-google-map-container {
+  width: 400px;
+  height: 400px;
+}
-- 
2.5.4 (Apple Git-61)


From afa970fd93cf14d9dd9b711de45c22f04aa8de7a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:24:03 +0700
Subject: [PATCH 145/166] Step 16.9: add all parties locations on the map

---
 client/parties-list/parties-list.html | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index f87d7d0..b69e41a 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -14,7 +14,7 @@
     <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}">
       <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
       <p>{{party.description}}</p>
-      <p>{{party.location}}</p>
+      <p>{{party.location.name}}</p>
       <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
       <div>
         Who is coming:
@@ -24,5 +24,17 @@
       </div>
     </li>
   </ul>
+  <sebm-google-map 
+    [latitude]="0"
+    [longitude]="0"
+    [zoom]="1">
+    <div *ngFor="#party of parties">
+      <sebm-google-map-marker
+        *ngIf="party.location.lat"
+        [latitude]="party.location.lat"
+        [longitude]="party.location.lng">
+      </sebm-google-map-marker>
+    </div>
+  </sebm-google-map>
   <pagination-controls (change)="onPageChanged($event.page)"></pagination-controls>
 </div>
-- 
2.5.4 (Apple Git-61)


From 6a3168cddf4cc04c2cb3253a10139ea9023bc424 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:25:02 +0700
Subject: [PATCH 146/166] Step 16.10: import maps dependencies in the
 PartiesList

---
 client/parties-list/parties-list.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index c3ae7eb..9f35eb9 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -16,13 +16,15 @@ import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagina
 
 import {RsvpPipe} from 'client/lib/pipes';
 
+import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES} from 'ng2-google-maps/core';
+
 @Component({
     selector: 'parties-list',
     viewProviders: [PaginationService]
 })
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
-    directives: [PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
+    directives: [ANGULAR2_GOOGLE_MAPS_DIRECTIVES, PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
     pipes: [PaginatePipe, RsvpPipe]
 })
 @InjectUser()
-- 
2.5.4 (Apple Git-61)


From 147b40a1e52765ec0f0e51bb0d048502bbed9b87 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 13:43:37 +0700
Subject: [PATCH 147/166] Add Angular 2 Google Maps package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index e15a342..119cd68 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,4 @@ barbatus:ng2-pagination
 tmeasday:publish-counts
 check
 email
+barbatus:ng2-google-maps
-- 
2.5.4 (Apple Git-61)


From 4c76a4c6fe39fc4fc9521ad0155bed2d2bf3bd8e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 13 Jan 2016 18:08:25 +0700
Subject: [PATCH 148/166] Add maps package's typings to the config

---
 tsconfig.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tsconfig.json b/tsconfig.json
index 316379a..43c347d 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -10,6 +10,7 @@
     "typings/ng2-meteor-accounts-ui/ng2-meteor-accounts-ui.d.ts",
     "typings/ng2-meteor-accounts/ng2-meteor-accounts.d.ts",
     "typings/ng2-pagination/ng2-pagination.d.ts",
+    "typings/ng2-google-maps/ng2-google-maps.d.ts",
     "typings/party.d.ts",
     "client/app.ts",
     "server/main.ts"
-- 
2.5.4 (Apple Git-61)


From a55e54fbedae7b7e35a0c32ea9556f9223da13dc Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 20:47:08 +0700
Subject: [PATCH 149/208] Step 21.1: add a new package called "socially-mobile"

---
 packages/socially-mobile/package.js | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 packages/socially-mobile/package.js

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
new file mode 100644
index 0000000..079cecc
--- /dev/null
+++ b/packages/socially-mobile/package.js
@@ -0,0 +1,24 @@
+Package.describe({
+  name: 'socially-mobile',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.1');
+  api.use('ecmascript');
+  api.addFiles('socially-mobile.js');
+});
+
+Package.onTest(function(api) {
+  api.use('ecmascript');
+  api.use('tinytest');
+  api.use('socially-mobile');
+  api.addFiles('socially-mobile-tests.js');
+});
-- 
2.5.4 (Apple Git-61)


From 81af582bd01defd9d582962acc6d0899286eaa66 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 20:51:25 +0700
Subject: [PATCH 150/208] Step 21.2: clean up and add dependencies in the
 mobile package

---
 packages/socially-mobile/package.js | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 079cecc..af0575f 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -12,13 +12,11 @@ Package.describe({
 
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
-  api.use('ecmascript');
-  api.addFiles('socially-mobile.js');
+  api.use('urigo:angular2-meteor');
 });
 
 Package.onTest(function(api) {
-  api.use('ecmascript');
+  api.use('urigo:angular2-meteor');
   api.use('tinytest');
   api.use('socially-mobile');
-  api.addFiles('socially-mobile-tests.js');
 });
-- 
2.5.4 (Apple Git-61)


From 357ca70e311a338bc9f1808db15d449538ddc83f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 20:54:48 +0700
Subject: [PATCH 151/208] Add new package called "socially-browser"

---
 packages/socially-browser/package.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 packages/socially-browser/package.js

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
new file mode 100644
index 0000000..bf81803
--- /dev/null
+++ b/packages/socially-browser/package.js
@@ -0,0 +1,22 @@
+Package.describe({
+  name: 'socially-browser',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.1');
+  api.use('urigo:angular2-meteor');
+});
+
+Package.onTest(function(api) {
+  api.use('urigo:angular2-meteor');
+  api.use('tinytest');
+  api.use('socially-browser');
+});
-- 
2.5.4 (Apple Git-61)


From b6c38887fe5fe5d55fd0a1ff0533aa56d5d4d2c0 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 20:55:47 +0700
Subject: [PATCH 152/208] Add packages to the app

---
 .meteor/packages | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 119cd68..813486d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,5 @@ tmeasday:publish-counts
 check
 email
 barbatus:ng2-google-maps
+socially-mobile
+socially-browser
-- 
2.5.4 (Apple Git-61)


From 2ab0fc9ed0db6fd67ae750a37f41e9a8e60f1049 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:17:25 +0700
Subject: [PATCH 153/208] Step 21.3: add login template

---
 packages/socially-browser/client/login/login.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-browser/client/login/login.html

diff --git a/packages/socially-browser/client/login/login.html b/packages/socially-browser/client/login/login.html
new file mode 100644
index 0000000..ca253cc
--- /dev/null
+++ b/packages/socially-browser/client/login/login.html
@@ -0,0 +1 @@
+<accounts-ui></accounts-ui>
-- 
2.5.4 (Apple Git-61)


From e97501c15ff52a1c5d75aaa6ec89c483aaad4acb Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:17:54 +0700
Subject: [PATCH 154/208] Step 21.4: add login component

---
 packages/socially-browser/client/login/login.ts | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 packages/socially-browser/client/login/login.ts

diff --git a/packages/socially-browser/client/login/login.ts b/packages/socially-browser/client/login/login.ts
new file mode 100644
index 0000000..8daee63
--- /dev/null
+++ b/packages/socially-browser/client/login/login.ts
@@ -0,0 +1,13 @@
+
+import {Component, View} from 'angular2/core';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+import {AccountsUI} from 'meteor-accounts-ui';
+
+@Component({
+  selector: 'login',
+  templateUrl: '/packages/socially-browser/client/login/login.html',
+  directives: [AccountsUI]
+})
+export class Login {}
-- 
2.5.4 (Apple Git-61)


From 34ed466f617fbab184f7be7ecfb50a43a32fb52a Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:36:54 +0700
Subject: [PATCH 155/208] Step 21.5: register SystemJS module

---
 packages/socially-browser/system_config.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 packages/socially-browser/system_config.js

diff --git a/packages/socially-browser/system_config.js b/packages/socially-browser/system_config.js
new file mode 100644
index 0000000..aa0e70c
--- /dev/null
+++ b/packages/socially-browser/system_config.js
@@ -0,0 +1,11 @@
+System.config({
+  packages: {
+    'socially': {
+      main: 'client/login/login',
+      format: 'register',
+      map: {
+        '.': System.normalizeSync('{socially-browser}')
+      }
+    }
+  }
+});
-- 
2.5.4 (Apple Git-61)


From 2dc26d03f267889ebd9fa8ad81c738087fe10ba4 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:40:08 +0700
Subject: [PATCH 156/208] Step 21.6: add component files to the package

---
 packages/socially-browser/package.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index bf81803..b7a3a62 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -13,6 +13,13 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('urigo:angular2-meteor');
+  api.use('barbatus:ng2-meteor-accounts-ui', 'web.browser');
+
+  api.addFiles([
+    'client/login/login.html',
+    'client/login/login.ts',
+    'system_config.js'
+  ], 'web.browser');
 });
 
 Package.onTest(function(api) {
-- 
2.5.4 (Apple Git-61)


From 76413b6eefea4331b9109e58f7d0d6712d34e009 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:57:19 +0700
Subject: [PATCH 157/208] Step 21.7: import Login component from "socially"
 module

---
 client/parties-list/parties-list.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
index 9f35eb9..fbf02c3 100644
--- a/client/parties-list/parties-list.ts
+++ b/client/parties-list/parties-list.ts
@@ -18,13 +18,15 @@ import {RsvpPipe} from 'client/lib/pipes';
 
 import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES} from 'ng2-google-maps/core';
 
+import {Login} from 'socially';
+
 @Component({
     selector: 'parties-list',
     viewProviders: [PaginationService]
 })
 @View({
     templateUrl: '/client/parties-list/parties-list.html',
-    directives: [ANGULAR2_GOOGLE_MAPS_DIRECTIVES, PartiesForm, RouterLink, AccountsUI, PaginationControlsCpm],
+    directives: [ANGULAR2_GOOGLE_MAPS_DIRECTIVES, PartiesForm, RouterLink, Login, PaginationControlsCpm],
     pipes: [PaginatePipe, RsvpPipe]
 })
 @InjectUser()
-- 
2.5.4 (Apple Git-61)


From c03fc9caad57568a324fd677fa74e379e4216275 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 26 Jan 2016 22:58:01 +0700
Subject: [PATCH 158/208] Step 21.8: change PartiesList template to contain
 "login" directive

---
 client/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
index b69e41a..53cad56 100644
--- a/client/parties-list/parties-list.html
+++ b/client/parties-list/parties-list.html
@@ -2,7 +2,7 @@
   <parties-form [hidden]="!user" style="float: left"></parties-form>
   <input type="text" #searchtext placeholder="Search by Location">
   <button type="button" (click)="search(searchtext.value)">Search</button>
-  <accounts-ui></accounts-ui>
+  <login></login>
   <h1>Parties:</h1>
   <div>
     <select #sort (change)="changeSortOrder(sort.value)">
-- 
2.5.4 (Apple Git-61)


From c4aed31fa8af9d525bde5568d02536c03b6a2b75 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:27:52 +0700
Subject: [PATCH 159/208] Step 21.9: add login component's template

---
 packages/socially-mobile/client/login/login.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-mobile/client/login/login.html

diff --git a/packages/socially-mobile/client/login/login.html b/packages/socially-mobile/client/login/login.html
new file mode 100644
index 0000000..37c8acd
--- /dev/null
+++ b/packages/socially-mobile/client/login/login.html
@@ -0,0 +1 @@
+<a [routerLink]="['/LoginPage']">Login</a>
-- 
2.5.4 (Apple Git-61)


From eac8c7b444e5fd171bb35db0509c2cff9df21ebf Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:28:44 +0700
Subject: [PATCH 160/208] Step 21.10: add login component

---
 packages/socially-mobile/client/login/login.ts | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 packages/socially-mobile/client/login/login.ts

diff --git a/packages/socially-mobile/client/login/login.ts b/packages/socially-mobile/client/login/login.ts
new file mode 100644
index 0000000..2d3b84b
--- /dev/null
+++ b/packages/socially-mobile/client/login/login.ts
@@ -0,0 +1,15 @@
+
+import {Component} from 'angular2/core';
+
+import {ROUTER_DIRECTIVES} from 'angular2/router';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+export * from './login-page';
+
+@Component({
+  selector: 'login',
+  templateUrl: '/packages/socially-mobile/client/login/login.html',
+  directives: [ROUTER_DIRECTIVES]
+})
+export class Login {}
-- 
2.5.4 (Apple Git-61)


From 58e6cd5b3ff3fd2688dec8f7d9df09075ecf502e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:38:02 +0700
Subject: [PATCH 161/208] Step 21.11: add login page component's template

---
 packages/socially-mobile/client/login/login-page.html | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 packages/socially-mobile/client/login/login-page.html

diff --git a/packages/socially-mobile/client/login/login-page.html b/packages/socially-mobile/client/login/login-page.html
new file mode 100644
index 0000000..ea5e8e0
--- /dev/null
+++ b/packages/socially-mobile/client/login/login-page.html
@@ -0,0 +1,9 @@
+<div *ngIf="phoneStage">
+  <input type="text" placeholder="Phone Number" [(ngModel)]="phoneNumber">
+  <button (click)="requestVerification">Send</button>
+</div>
+
+<div *ngIf="!phoneStage">
+  <input type="text" placeholder="Enter Code" [(ngModel)]="verCode">
+  <button (click)="verifyPhone">Verify</button>
+</div>
-- 
2.5.4 (Apple Git-61)


From 7332fadc1b25b72afcf57faf5e6ff118ca97bd46 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:39:02 +0700
Subject: [PATCH 162/208] Step 21.12: add login page component

---
 .../socially-mobile/client/login/login-page.ts     | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)
 create mode 100644 packages/socially-mobile/client/login/login-page.ts

diff --git a/packages/socially-mobile/client/login/login-page.ts b/packages/socially-mobile/client/login/login-page.ts
new file mode 100644
index 0000000..561abac
--- /dev/null
+++ b/packages/socially-mobile/client/login/login-page.ts
@@ -0,0 +1,29 @@
+
+import {Component} from 'angular2/core';
+
+import {Router} from 'angular2/router';
+
+@Component({
+  selector: 'login-page',
+  templateUrl: '/packages/socially-mobile/client/login/login-page.html'
+})
+export class LoginPage {
+  phoneNumber: string;
+  verCode: string;
+  phoneStage: boolean = true;
+
+  constructor(private router: Router) {}
+
+  requestVerification() {
+    Accounts.requestPhoneVerification(this.phoneNumber);
+    this.phoneStage = false;
+  }
+
+  verifyPhone() {
+    Accounts.verifyPhone(this.phoneNumber, this.verCode, (err) => {
+      if (!err) {
+        this.router.navigateByUrl('/');
+      }
+    });
+  }
+}
-- 
2.5.4 (Apple Git-61)


From 062c903b2691f39efffa8b08a5a381b8037ee669 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:41:59 +0700
Subject: [PATCH 163/208] Step 21.13: register SystemJS module for the mobile
 package

---
 packages/socially-mobile/system_config.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 packages/socially-mobile/system_config.js

diff --git a/packages/socially-mobile/system_config.js b/packages/socially-mobile/system_config.js
new file mode 100644
index 0000000..097cd14
--- /dev/null
+++ b/packages/socially-mobile/system_config.js
@@ -0,0 +1,11 @@
+System.config({
+  packages: {
+    'socially': {
+      main: 'client/login/login',
+      format: 'register',
+      map: {
+        '.': System.normalizeSync('{socially-mobile}')
+      }
+    }
+  }
+});
-- 
2.5.4 (Apple Git-61)


From d80080c5be82708a8d32675ed45167d4d7e58d91 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 00:43:37 +0700
Subject: [PATCH 164/208] Step 21.14: add component files to the mobile package

---
 packages/socially-mobile/package.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index af0575f..0ea1138 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -13,6 +13,15 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('urigo:angular2-meteor');
+  api.use('okland:accounts-phone', 'web.cordova');
+
+  api.addFiles([
+    'client/login/login.html',
+    'client/login/login.ts',
+    'client/login/login-page.html',
+    'client/login/login-page.ts',
+    'system_config.js'
+    ], 'web.cordova');
 });
 
 Package.onTest(function(api) {
-- 
2.5.4 (Apple Git-61)


From 9116df6c90163db0c6512dcd006307b1394eab3f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 27 Jan 2016 01:01:27 +0700
Subject: [PATCH 165/208] Step 21.15: add new login route to the app

---
 client/app.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/app.ts b/client/app.ts
index 607f9f1..9051558 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -12,6 +12,8 @@ import 'collections/methods';
 
 import {ANGULAR2_GOOGLE_MAPS_PROVIDERS} from 'ng2-google-maps/core';
 
+import {LoginPage, Login} from 'socially'; 
+
 Accounts.ui.config({
   passwordSignupFields: 'USERNAME_AND_EMAIL'
 });
@@ -25,7 +27,8 @@ Accounts.ui.config({
 })
 @RouteConfig([
     { path: '/', as: 'PartiesList', component: PartiesList },
-    { path: '/party/:partyId', as: 'PartyDetails', component: PartyDetails }
+    { path: '/party/:partyId', as: 'PartyDetails', component: PartyDetails },
+    { path: '/login', as: 'LoginPage', component: LoginPage || Login }
 ])
 class Socially {}
 
-- 
2.5.4 (Apple Git-61)


From 8ec97067ccde99d8204485ce15607fe51bee30da Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 28 Jan 2016 13:38:51 +0700
Subject: [PATCH 166/208] Add iOS platform

---
 .meteor/platforms | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/.meteor/platforms b/.meteor/platforms
index efeba1b..81ae701 100644
--- a/.meteor/platforms
+++ b/.meteor/platforms
@@ -1,2 +1,3 @@
-server
 browser
+ios
+server
-- 
2.5.4 (Apple Git-61)


From ca24ec17b928f17d78f5352d8c63309129d9017b Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:47:37 +0700
Subject: [PATCH 167/208] Add new package's package.js

---
 packages/socially-client/package.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 packages/socially-client/package.js

diff --git a/packages/socially-client/package.js b/packages/socially-client/package.js
new file mode 100644
index 0000000..b024117
--- /dev/null
+++ b/packages/socially-client/package.js
@@ -0,0 +1,21 @@
+Package.describe({
+  name: 'socially-client',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.1');
+  api.use('urigo:angular2-meteor');
+});
+
+Package.onTest(function(api) {
+  api.use('urigo:angular2-meteor');
+  api.use('tinytest');
+});
-- 
2.5.4 (Apple Git-61)


From f37ec78e068f1eadf8cbf7226d6a1a015160ec6b Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 12:41:34 +0700
Subject: [PATCH 168/208] Move PartyDetails to the client package

---
 client/party-details/party-details.ts              | 135 ---------------------
 .../socially-client/party-details/party-details.ts | 135 +++++++++++++++++++++
 2 files changed, 135 insertions(+), 135 deletions(-)
 delete mode 100644 client/party-details/party-details.ts
 create mode 100644 packages/socially-client/party-details/party-details.ts

diff --git a/client/party-details/party-details.ts b/client/party-details/party-details.ts
deleted file mode 100644
index 7ef3e34..0000000
--- a/client/party-details/party-details.ts
+++ /dev/null
@@ -1,135 +0,0 @@
-import {Component, View} from 'angular2/core';
-
-import {RouteParams} from 'angular2/router';
-
-import {Parties} from 'collections/parties';
-
-import {RouterLink} from 'angular2/router';
-
-import {RequireUser, InjectUser} from 'meteor-accounts';
-
-import {MeteorComponent} from 'angular2-meteor';
-
-import {DisplayName} from 'client/lib/pipes';
-
-import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
-
-@Component({
-    selector: 'party-details'
-})
-@View({
-    pipes: [DisplayName],
-    templateUrl: '/client/party-details/party-details.html',
-    directives: [RouterLink, ANGULAR2_GOOGLE_MAPS_DIRECTIVES]
-})
-@RequireUser()
-@InjectUser()
-export class PartyDetails extends MeteorComponent {
-    party: Party;
-    users: Mongo.Cursor<Object>;
-    user: Meteor.User;
-
-    // Default center Palo Alto coordinates.
-    centerLat: Number = 37.4292; 
-    centerLng: Number = -122.1381;
-
-    constructor(params: RouteParams) {
-        super();
-        var partyId = params.get('partyId');
-        this.subscribe('party', partyId, () => {
-            this.autorun(() => {
-                this.party = Parties.findOne(partyId);
-                this.getUsers(this.party);
-            },   true);
-        });
-
-        this.subscribe('uninvited', partyId, () => {
-            this.getUsers(this.party);
-        }, true);
-    }
-
-    getUsers(party: Party) {
-        if (party) {
-            this.users = Meteor.users.find({
-                _id: {
-                    $nin: party.invited || [],
-                    $ne: Meteor.userId()
-                }
-            });
-        }
-    }
-
-    saveParty(party) {
-      if (Meteor.userId()) {
-        Parties.update(party._id, {
-          $set: {
-            name: party.name,
-            description: party.description,
-            location: party.location
-          }
-        });
-      } else {
-        alert('Please log in to change this party');
-      }
-    }
-
-    invite(user: Meteor.User) {
-      this.call('invite', this.party._id, user._id, (error) => {
-        if (error) {
-          alert(`Failed to invite due to ${error}`);
-          return;
-        }
-
-        alert('User successfully invited.');
-      });
-    }
-
-    reply(rsvp: string) {
-      this.call('reply', this.party._id, rsvp, (error) => {
-        if (error) {
-          alert(`Failed to reply due to ${error}`);
-        }
-        else {
-          alert('You successfully replied.');
-        }
-      });
-    }
-
-    get isOwner(): boolean {
-        if (this.party && this.user) {
-            return this.user._id === this.party.owner;
-        }
-
-        return false;
-    }
-
-    get isPublic(): boolean {
-        if (this.party) {
-            return this.party.public;
-        }
-
-        return false;
-    }
-
-    get isInvited(): boolean {
-        if (this.party && this.user) {
-            let invited = this.party.invited || [];
-            return invited.indexOf(this.user._id) !== -1;
-        }
-
-        return false;
-    }
-
-    get lat(): Number {
-        return this.party && this.party.location.lat;
-    }
-
-    get lng(): Number {
-        return this.party && this.party.location.lng;
-    }
-
-    mapClicked($event: MapMouseEvent) {
-        this.party.location.lat = $event.coords.lat;
-        this.party.location.lng = $event.coords.lng;
-    }
-}
diff --git a/packages/socially-client/party-details/party-details.ts b/packages/socially-client/party-details/party-details.ts
new file mode 100644
index 0000000..7ef3e34
--- /dev/null
+++ b/packages/socially-client/party-details/party-details.ts
@@ -0,0 +1,135 @@
+import {Component, View} from 'angular2/core';
+
+import {RouteParams} from 'angular2/router';
+
+import {Parties} from 'collections/parties';
+
+import {RouterLink} from 'angular2/router';
+
+import {RequireUser, InjectUser} from 'meteor-accounts';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+import {DisplayName} from 'client/lib/pipes';
+
+import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
+
+@Component({
+    selector: 'party-details'
+})
+@View({
+    pipes: [DisplayName],
+    templateUrl: '/client/party-details/party-details.html',
+    directives: [RouterLink, ANGULAR2_GOOGLE_MAPS_DIRECTIVES]
+})
+@RequireUser()
+@InjectUser()
+export class PartyDetails extends MeteorComponent {
+    party: Party;
+    users: Mongo.Cursor<Object>;
+    user: Meteor.User;
+
+    // Default center Palo Alto coordinates.
+    centerLat: Number = 37.4292; 
+    centerLng: Number = -122.1381;
+
+    constructor(params: RouteParams) {
+        super();
+        var partyId = params.get('partyId');
+        this.subscribe('party', partyId, () => {
+            this.autorun(() => {
+                this.party = Parties.findOne(partyId);
+                this.getUsers(this.party);
+            },   true);
+        });
+
+        this.subscribe('uninvited', partyId, () => {
+            this.getUsers(this.party);
+        }, true);
+    }
+
+    getUsers(party: Party) {
+        if (party) {
+            this.users = Meteor.users.find({
+                _id: {
+                    $nin: party.invited || [],
+                    $ne: Meteor.userId()
+                }
+            });
+        }
+    }
+
+    saveParty(party) {
+      if (Meteor.userId()) {
+        Parties.update(party._id, {
+          $set: {
+            name: party.name,
+            description: party.description,
+            location: party.location
+          }
+        });
+      } else {
+        alert('Please log in to change this party');
+      }
+    }
+
+    invite(user: Meteor.User) {
+      this.call('invite', this.party._id, user._id, (error) => {
+        if (error) {
+          alert(`Failed to invite due to ${error}`);
+          return;
+        }
+
+        alert('User successfully invited.');
+      });
+    }
+
+    reply(rsvp: string) {
+      this.call('reply', this.party._id, rsvp, (error) => {
+        if (error) {
+          alert(`Failed to reply due to ${error}`);
+        }
+        else {
+          alert('You successfully replied.');
+        }
+      });
+    }
+
+    get isOwner(): boolean {
+        if (this.party && this.user) {
+            return this.user._id === this.party.owner;
+        }
+
+        return false;
+    }
+
+    get isPublic(): boolean {
+        if (this.party) {
+            return this.party.public;
+        }
+
+        return false;
+    }
+
+    get isInvited(): boolean {
+        if (this.party && this.user) {
+            let invited = this.party.invited || [];
+            return invited.indexOf(this.user._id) !== -1;
+        }
+
+        return false;
+    }
+
+    get lat(): Number {
+        return this.party && this.party.location.lat;
+    }
+
+    get lng(): Number {
+        return this.party && this.party.location.lng;
+    }
+
+    mapClicked($event: MapMouseEvent) {
+        this.party.location.lat = $event.coords.lat;
+        this.party.location.lng = $event.coords.lng;
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 827e832687391cb0183167f86822ee132117189d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 12:48:27 +0700
Subject: [PATCH 169/208] Step 22.1: update PartyDetails of "socially-client"
 package

---
 .../socially-client/party-details/party-details.ts | 32 ++--------------------
 1 file changed, 2 insertions(+), 30 deletions(-)

diff --git a/packages/socially-client/party-details/party-details.ts b/packages/socially-client/party-details/party-details.ts
index 7ef3e34..afae205 100644
--- a/packages/socially-client/party-details/party-details.ts
+++ b/packages/socially-client/party-details/party-details.ts
@@ -1,41 +1,18 @@
-import {Component, View} from 'angular2/core';
-
-import {RouteParams} from 'angular2/router';
-
 import {Parties} from 'collections/parties';
 
-import {RouterLink} from 'angular2/router';
-
-import {RequireUser, InjectUser} from 'meteor-accounts';
-
 import {MeteorComponent} from 'angular2-meteor';
 
-import {DisplayName} from 'client/lib/pipes';
-
-import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
-
-@Component({
-    selector: 'party-details'
-})
-@View({
-    pipes: [DisplayName],
-    templateUrl: '/client/party-details/party-details.html',
-    directives: [RouterLink, ANGULAR2_GOOGLE_MAPS_DIRECTIVES]
-})
-@RequireUser()
-@InjectUser()
 export class PartyDetails extends MeteorComponent {
     party: Party;
-    users: Mongo.Cursor<Object>;
+    users: Mongo.Cursor;
     user: Meteor.User;
 
     // Default center Palo Alto coordinates.
     centerLat: Number = 37.4292; 
     centerLng: Number = -122.1381;
 
-    constructor(params: RouteParams) {
+    constructor(partyId: number) {
         super();
-        var partyId = params.get('partyId');
         this.subscribe('party', partyId, () => {
             this.autorun(() => {
                 this.party = Parties.findOne(partyId);
@@ -127,9 +104,4 @@ export class PartyDetails extends MeteorComponent {
     get lng(): Number {
         return this.party && this.party.location.lng;
     }
-
-    mapClicked($event: MapMouseEvent) {
-        this.party.location.lat = $event.coords.lat;
-        this.party.location.lng = $event.coords.lng;
-    }
 }
-- 
2.5.4 (Apple Git-61)


From 547b32851ba59a8987cf453b0a13e648d4271656 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:04:53 +0700
Subject: [PATCH 170/208] Move PartiesList logic to the client package

---
 .../socially-client/parties-list/parties-list.ts   | 57 ++++++++++++++++++++++
 1 file changed, 57 insertions(+)
 create mode 100644 packages/socially-client/parties-list/parties-list.ts

diff --git a/packages/socially-client/parties-list/parties-list.ts b/packages/socially-client/parties-list/parties-list.ts
new file mode 100644
index 0000000..c7583c3
--- /dev/null
+++ b/packages/socially-client/parties-list/parties-list.ts
@@ -0,0 +1,57 @@
+
+import {Parties} from 'collections/parties';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+export class PartiesList extends MeteorComponent {
+    parties: Mongo.Cursor<Party>;
+    pageSize: number = 10;
+    curPage: ReactiveVar<number> = new ReactiveVar<number>(1);
+    nameOrder: ReactiveVar<number> = new ReactiveVar<number>(1);
+    partiesSize: number = 0;
+    location: ReactiveVar<string> = new ReactiveVar<string>(null);
+    user: Meteor.User;
+
+    constructor() {
+        super();
+        this.autorun(() => {
+            let options = {
+                limit: this.pageSize,
+                skip: (this.curPage.get() - 1) * this.pageSize,
+                sort: { name: this.nameOrder.get() }
+            };
+            this.subscribe('parties', options, this.location.get(), () => {
+                this.parties = Parties.find({}, { sort: { name: this.nameOrder.get() } });
+            }, true);
+        });
+
+        this.autorun(() => {
+            this.partiesSize = Counts.get('numberOfParties');
+        }, true);
+    }
+
+    removeParty(party) {
+        Parties.remove(party._id);
+    }
+
+    search(value: string) {
+        this.curPage.set(1);
+        this.location.set(value);
+    }
+
+    onPageChanged(page: number) {
+        this.curPage.set(page);
+    }
+
+    changeSortOrder(nameOrder: string) {
+        this.nameOrder.set(parseInt(nameOrder));
+    }
+
+    isOwner(party: Party): boolean {
+        if (this.user) {
+            return this.user._id === party.owner;
+        }
+
+        return false;
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 3b32203e9dcc44f2228afe683675741356d32ead Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:06:04 +0700
Subject: [PATCH 171/208] Move PartiesForm logic to the client package

---
 .../socially-client/parties-form/parties-form.ts   | 41 ++++++++++++++++++++++
 1 file changed, 41 insertions(+)
 create mode 100644 packages/socially-client/parties-form/parties-form.ts

diff --git a/packages/socially-client/parties-form/parties-form.ts b/packages/socially-client/parties-form/parties-form.ts
new file mode 100644
index 0000000..ba40f48
--- /dev/null
+++ b/packages/socially-client/parties-form/parties-form.ts
@@ -0,0 +1,41 @@
+
+import {FormBuilder, Control, ControlGroup, Validators} from 'angular2/common';
+
+import {Parties} from 'collections/parties';
+
+export class PartiesForm {
+    partiesForm: ControlGroup;
+
+    constructor() {
+        var fb = new FormBuilder();
+        this.partiesForm = fb.group({
+            name: ['', Validators.required],
+            description: [''],
+            location: ['', Validators.required],
+            public: [false]
+        });
+    }
+
+    addParty(party) {
+        if (this.partiesForm.valid) {
+            if (Meteor.userId()) {
+                Parties.insert({
+                    name: party.name,
+                    description: party.description,
+                    location: {
+                        name: party.location
+                    },
+                    public: party.public,
+                    owner: Meteor.userId()
+                });
+
+                (<Control>this.partiesForm.controls['name']).updateValue('');
+                (<Control>this.partiesForm.controls['description']).updateValue('');
+                (<Control>this.partiesForm.controls['location']).updateValue('');
+                (<Control>this.partiesForm.controls['public']).updateValue(false);
+            } else {
+                alert('Please log in to add a party');
+            }
+        }
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 9e60b82bfc4dd0aeecd1c8bacdb084ffc43d961e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:08:18 +0700
Subject: [PATCH 172/208] Move pipes to the client package

---
 packages/socially-client/lib/pipes.ts | 56 +++++++++++++++++++++++++++++++++++
 1 file changed, 56 insertions(+)
 create mode 100644 packages/socially-client/lib/pipes.ts

diff --git a/packages/socially-client/lib/pipes.ts b/packages/socially-client/lib/pipes.ts
new file mode 100644
index 0000000..dd4da11
--- /dev/null
+++ b/packages/socially-client/lib/pipes.ts
@@ -0,0 +1,56 @@
+import {Pipe} from 'angular2/core';
+
+import {Parties} from 'collections/parties';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+@Pipe({
+    name: 'displayName'
+})
+export class DisplayName {
+    transform(user: Meteor.User): string {
+        if (!user) {
+            return '';
+        }
+
+        if (user.username) {
+            return user.username;
+        }
+        
+        if (user.emails) {
+            return user.emails[0].address;
+        }
+        
+        return '';
+    }
+}
+
+@Pipe({
+    name: 'rsvp',
+    pure: false
+})
+export class RsvpPipe extends MeteorComponent {
+    init: boolean = false;
+    total: number = 0;
+
+    transform(party: Party, args: any[]): number {
+        let type = args[0];
+        if (!type) {
+            return 0;
+        }
+
+        if (!this.init) {
+            this.autorun(() => {
+                party = Parties.findOne(party._id);
+                if (party) {
+                    this.total = party.rsvps ?
+                        party.rsvps.filter(rsvp => rsvp.response === type).length : 0;
+                }
+            }, true);
+            this.init = true;
+        }
+                    
+        return this.total;
+    }
+}
+
-- 
2.5.4 (Apple Git-61)


From ad8f1242d225fa3490ea3a4c929050f6f67479a8 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:10:16 +0700
Subject: [PATCH 173/208] Step 22.2: add main module file

---
 packages/socially-client/main.ts | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 packages/socially-client/main.ts

diff --git a/packages/socially-client/main.ts b/packages/socially-client/main.ts
new file mode 100644
index 0000000..e86a22a
--- /dev/null
+++ b/packages/socially-client/main.ts
@@ -0,0 +1,8 @@
+
+export * from './lib/pipes';
+
+export * from './parties-form/parties-form';
+
+export * from './parties-list/parties-list';
+
+export * from './party-details/party-details';
-- 
2.5.4 (Apple Git-61)


From a5ba6c45dc3f2e9a31f275dbdf0576c71dae86ae Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:13:43 +0700
Subject: [PATCH 174/208] Step 22.3: register main SystemJS module

---
 packages/socially-client/system_config.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 packages/socially-client/system_config.js

diff --git a/packages/socially-client/system_config.js b/packages/socially-client/system_config.js
new file mode 100644
index 0000000..ebebb99
--- /dev/null
+++ b/packages/socially-client/system_config.js
@@ -0,0 +1,11 @@
+System.config({
+  packages: {
+    'socially-client': {
+      main: 'main',
+      format: 'register',
+      map: {
+        '.': System.normalizeSync('{socially-client}')
+      }
+    }
+  }
+});
-- 
2.5.4 (Apple Git-61)


From 167b6dee6e5b1ceddd67ccf97a85fbb02c79d6c3 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 29 Jan 2016 18:14:55 +0700
Subject: [PATCH 175/208] Step 22.4: change package.js to contain new files

---
 packages/socially-client/package.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/packages/socially-client/package.js b/packages/socially-client/package.js
index b024117..4cafb90 100644
--- a/packages/socially-client/package.js
+++ b/packages/socially-client/package.js
@@ -13,9 +13,19 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('urigo:angular2-meteor');
+
+  api.addFiles([
+    'lib/pipes.ts',
+    'parties-form/parties-form.ts',
+    'parties-list/parties-list.ts',
+    'party-details/party-details.ts',
+    'main.ts',
+    'system_config.js'
+  ], 'client');
 });
 
 Package.onTest(function(api) {
   api.use('urigo:angular2-meteor');
   api.use('tinytest');
+  api.use('socially-client');
 });
-- 
2.5.4 (Apple Git-61)


From 8935ebf8d67876c002f3edd30a8f85193720bec3 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 18:51:24 +0700
Subject: [PATCH 176/208] Add PartyDetails template to the browser package

---
 .../client/party-details/party-details.html        | 40 ++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 packages/socially-browser/client/party-details/party-details.html

diff --git a/packages/socially-browser/client/party-details/party-details.html b/packages/socially-browser/client/party-details/party-details.html
new file mode 100644
index 0000000..3bda50c
--- /dev/null
+++ b/packages/socially-browser/client/party-details/party-details.html
@@ -0,0 +1,40 @@
+<form (submit)="saveParty(party)" *ngIf="party">
+  <label>Name</label>
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name">
+
+  <label>Description</label>
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description">
+
+  <label>Location</label>
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name">
+
+  <button [disabled]="!isOwner" type="submit">Save</button>
+  <button [routerLink]="['/PartiesList']">Cancel</button>
+</form>
+
+<ul *ngIf="isOwner || isPublic">
+  Users to invite:
+  <li *ngFor="#user of users">
+    <div>{{ user | displayName }}</div>
+    <button (click)="invite(user)">Invite</button>
+  </li>
+</ul>
+
+<div *ngIf="isInvited">
+  <h2>Reply to the invitation</h2>
+  <input type="button" value="I'm going!" (click)="reply('yes')">
+  <input type="button" value="Maybe" (click)="reply('maybe')">
+  <input type="button" value="No" (click)="reply('no')">
+</div>
+
+<sebm-google-map 
+  [latitude]="lat || centerLat"
+  [longitude]="lng || centerLng"
+  [zoom]="8"
+  (mapClick)="mapClicked($event)">
+  <sebm-google-map-marker
+    *ngIf="lat && lng"
+    [latitude]="lat"
+    [longitude]="lng">
+  </sebm-google-map-marker>
+</sebm-google-map>
-- 
2.5.4 (Apple Git-61)


From c01ea96743a4ce2ca44cdb3ac761e2dcd8ae2f86 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 18:53:08 +0700
Subject: [PATCH 177/208] Step 22.5: add PartyDetails to the browser package

---
 .../client/party-details/party-details.ts          | 32 ++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 packages/socially-browser/client/party-details/party-details.ts

diff --git a/packages/socially-browser/client/party-details/party-details.ts b/packages/socially-browser/client/party-details/party-details.ts
new file mode 100644
index 0000000..9055e34
--- /dev/null
+++ b/packages/socially-browser/client/party-details/party-details.ts
@@ -0,0 +1,32 @@
+import {Component, View} from 'angular2/core';
+
+import {RouteParams} from 'angular2/router';
+
+import {Parties} from 'collections/parties';
+
+import {RouterLink} from 'angular2/router';
+
+import {RequireUser, InjectUser} from 'meteor-accounts';
+
+import {MeteorComponent} from 'angular2-meteor';
+
+import {DisplayName} from 'client/lib/pipes';
+
+import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
+
+@Component({
+    selector: 'party-details'
+})
+@View({
+    pipes: [DisplayName],
+    templateUrl: '/packages/socially-browser/client/party-details/party-details.html',
+    directives: [RouterLink, ANGULAR2_GOOGLE_MAPS_DIRECTIVES]
+})
+@RequireUser()
+@InjectUser()
+export class PartyDetails extends MeteorComponent {
+    mapClicked($event: MapMouseEvent) {
+        this.party.location.lat = $event.coords.lat;
+        this.party.location.lng = $event.coords.lng;
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 4b5e01f90d44267e9d175089e15928b44482e6ca Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:08:42 +0700
Subject: [PATCH 178/208] Step 22.6: prepare PartyDetails to be used from the
 browser package

---
 .../client/party-details/party-details.ts                | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

diff --git a/packages/socially-browser/client/party-details/party-details.ts b/packages/socially-browser/client/party-details/party-details.ts
index 9055e34..84f9a4f 100644
--- a/packages/socially-browser/client/party-details/party-details.ts
+++ b/packages/socially-browser/client/party-details/party-details.ts
@@ -2,18 +2,14 @@ import {Component, View} from 'angular2/core';
 
 import {RouteParams} from 'angular2/router';
 
-import {Parties} from 'collections/parties';
-
 import {RouterLink} from 'angular2/router';
 
 import {RequireUser, InjectUser} from 'meteor-accounts';
 
-import {MeteorComponent} from 'angular2-meteor';
-
-import {DisplayName} from 'client/lib/pipes';
-
 import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/core';
 
+import {DisplayName, PartyDetails as PartyDetailsBase} from 'socially-client';
+
 @Component({
     selector: 'party-details'
 })
@@ -24,7 +20,13 @@ import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES, MapMouseEvent} from 'ng2-google-maps/co
 })
 @RequireUser()
 @InjectUser()
-export class PartyDetails extends MeteorComponent {
+export class PartyDetails extends PartyDetailsBase {
+
+    constructor(params: RouteParams) {
+        var partyId = params.get('partyId');
+        super(partyId);
+    }
+
     mapClicked($event: MapMouseEvent) {
         this.party.location.lat = $event.coords.lat;
         this.party.location.lng = $event.coords.lng;
-- 
2.5.4 (Apple Git-61)


From 839f83ab7c3261a7f8c2d5e5d45ec6627a3ddf6e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:17:55 +0700
Subject: [PATCH 179/208] Step 22.7: update package.js to contain new files

---
 packages/socially-browser/package.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index b7a3a62..5b5b503 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -18,6 +18,8 @@ Package.onUse(function(api) {
   api.addFiles([
     'client/login/login.html',
     'client/login/login.ts',
+    'client/party-details/party-details.html',
+    'client/party-details/party-details.ts',
     'system_config.js'
   ], 'web.browser');
 });
-- 
2.5.4 (Apple Git-61)


From 83077643319396e031c751463fe9b1727e85b7d8 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:22:35 +0700
Subject: [PATCH 180/208] Add party form component to the browser package

---
 .../socially-browser/client/parties-form/parties-form.html    | 11 +++++++++++
 packages/socially-browser/client/parties-form/parties-form.ts | 11 +++++++++++
 packages/socially-browser/package.js                          |  2 ++
 3 files changed, 24 insertions(+)
 create mode 100644 packages/socially-browser/client/parties-form/parties-form.html
 create mode 100644 packages/socially-browser/client/parties-form/parties-form.ts

diff --git a/packages/socially-browser/client/parties-form/parties-form.html b/packages/socially-browser/client/parties-form/parties-form.html
new file mode 100644
index 0000000..54cc2c8
--- /dev/null
+++ b/packages/socially-browser/client/parties-form/parties-form.html
@@ -0,0 +1,11 @@
+<form [ngFormModel]="partiesForm" #f="ngForm" (submit)="addParty(f.value)">
+  <label>Name</label>
+  <input type="text" ngControl="name">
+  <label>Description</label>
+  <input type="text" ngControl="description">
+  <label>Location</label>
+  <input type="text" ngControl="location">
+  <label>Public</label>
+  <input type="checkbox" ngControl="public">
+  <button>Add</button>
+</form>
diff --git a/packages/socially-browser/client/parties-form/parties-form.ts b/packages/socially-browser/client/parties-form/parties-form.ts
new file mode 100644
index 0000000..9ead81c
--- /dev/null
+++ b/packages/socially-browser/client/parties-form/parties-form.ts
@@ -0,0 +1,11 @@
+import {Component, View} from 'angular2/core';
+
+import {PartiesForm as PartiesFormBase} from 'socially-client';
+
+@Component({
+  selector: 'parties-form'
+})
+@View({
+  templateUrl: '/packages/socially-browser/client/parties-form/parties-form.html'
+})
+export class PartiesForm extends PartiesFormBase {}
diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 5b5b503..e5cd999 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -20,6 +20,8 @@ Package.onUse(function(api) {
     'client/login/login.ts',
     'client/party-details/party-details.html',
     'client/party-details/party-details.ts',
+    'client/parties-form/parties-form.html',
+    'client/parties-form/parties-form.ts',
     'system_config.js'
   ], 'web.browser');
 });
-- 
2.5.4 (Apple Git-61)


From fc7991ba7e04f548e22583a00102cd5f13240b91 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:23:26 +0700
Subject: [PATCH 181/208] Add parties list component to the browser package

---
 .../client/parties-list/parties-list.html          | 40 ++++++++++++++++++++++
 .../client/parties-list/parties-list.ts            | 29 ++++++++++++++++
 packages/socially-browser/package.js               |  2 ++
 3 files changed, 71 insertions(+)
 create mode 100644 packages/socially-browser/client/parties-list/parties-list.html
 create mode 100644 packages/socially-browser/client/parties-list/parties-list.ts

diff --git a/packages/socially-browser/client/parties-list/parties-list.html b/packages/socially-browser/client/parties-list/parties-list.html
new file mode 100644
index 0000000..53cad56
--- /dev/null
+++ b/packages/socially-browser/client/parties-list/parties-list.html
@@ -0,0 +1,40 @@
+<div>
+  <parties-form [hidden]="!user" style="float: left"></parties-form>
+  <input type="text" #searchtext placeholder="Search by Location">
+  <button type="button" (click)="search(searchtext.value)">Search</button>
+  <login></login>
+  <h1>Parties:</h1>
+  <div>
+    <select #sort (change)="changeSortOrder(sort.value)">
+      <option value="1" selected>Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
+  <ul>
+    <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}">
+      <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
+      <p>{{party.description}}</p>
+      <p>{{party.location.name}}</p>
+      <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
+      <div>
+        Who is coming:
+        Yes - {{party | rsvp:'yes'}}
+        Maybe - {{party | rsvp:'maybe'}}
+        No - {{party | rsvp:'no'}}
+      </div>
+    </li>
+  </ul>
+  <sebm-google-map 
+    [latitude]="0"
+    [longitude]="0"
+    [zoom]="1">
+    <div *ngFor="#party of parties">
+      <sebm-google-map-marker
+        *ngIf="party.location.lat"
+        [latitude]="party.location.lat"
+        [longitude]="party.location.lng">
+      </sebm-google-map-marker>
+    </div>
+  </sebm-google-map>
+  <pagination-controls (change)="onPageChanged($event.page)"></pagination-controls>
+</div>
diff --git a/packages/socially-browser/client/parties-list/parties-list.ts b/packages/socially-browser/client/parties-list/parties-list.ts
new file mode 100644
index 0000000..f62a045
--- /dev/null
+++ b/packages/socially-browser/client/parties-list/parties-list.ts
@@ -0,0 +1,29 @@
+import {Component, View} from 'angular2/core';
+
+import {RouterLink} from 'angular2/router';
+
+import {AccountsUI} from 'meteor-accounts-ui';
+
+import {InjectUser} from 'meteor-accounts';
+
+import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagination';
+
+import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES} from 'ng2-google-maps/core';
+
+import {PartiesForm} from './../parties-form/parties-form';
+
+import {Login} from './../login/login';
+
+import {RsvpPipe, PartiesList as PartiesListBase} from 'socially-client';
+
+@Component({
+    selector: 'parties-list',
+    viewProviders: [PaginationService]
+})
+@View({
+    templateUrl: '/packages/socially-browser/client/parties-list/parties-list.html',
+    directives: [ANGULAR2_GOOGLE_MAPS_DIRECTIVES, PartiesForm, RouterLink, Login, PaginationControlsCpm],
+    pipes: [PaginatePipe, RsvpPipe]
+})
+@InjectUser()
+export class PartiesList extends PartiesListBase {}
diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index e5cd999..d8e7869 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -22,6 +22,8 @@ Package.onUse(function(api) {
     'client/party-details/party-details.ts',
     'client/parties-form/parties-form.html',
     'client/parties-form/parties-form.ts',
+    'client/parties-list/parties-list.html',
+    'client/parties-list/parties-list.ts',
     'system_config.js'
   ], 'web.browser');
 });
-- 
2.5.4 (Apple Git-61)


From 6004bbe3e5bf940a3b59835b67c70ab7db289898 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 20:04:23 +0700
Subject: [PATCH 182/208] Move styles to the browser package

---
 packages/socially-browser/client/css/main.css | 4 ++++
 packages/socially-browser/package.js          | 2 ++
 2 files changed, 6 insertions(+)
 create mode 100644 packages/socially-browser/client/css/main.css

diff --git a/packages/socially-browser/client/css/main.css b/packages/socially-browser/client/css/main.css
new file mode 100644
index 0000000..1484170
--- /dev/null
+++ b/packages/socially-browser/client/css/main.css
@@ -0,0 +1,4 @@
+.sebm-google-map-container {
+  width: 400px;
+  height: 400px;
+}
diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index d8e7869..d0b38f4 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -26,6 +26,8 @@ Package.onUse(function(api) {
     'client/parties-list/parties-list.ts',
     'system_config.js'
   ], 'web.browser');
+
+  api.addFiles(['client/css/main.css'], 'web.browser');
 });
 
 Package.onTest(function(api) {
-- 
2.5.4 (Apple Git-61)


From 033b7628c4d721c3373c9924bdbf20687feaed5e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:33:07 +0700
Subject: [PATCH 183/208] Step 22.8: export package components

---
 packages/socially-browser/main.ts | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 packages/socially-browser/main.ts

diff --git a/packages/socially-browser/main.ts b/packages/socially-browser/main.ts
new file mode 100644
index 0000000..31a8019
--- /dev/null
+++ b/packages/socially-browser/main.ts
@@ -0,0 +1,8 @@
+
+export * from './client/login/login';
+
+export * from './client/parties-form/parties-form';
+
+export * from './client/parties-list/parties-list';
+
+export * from './client/party-details/party-details';
-- 
2.5.4 (Apple Git-61)


From d2fec71f1690d6e9aef6de88ab793524209d7a0f Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:44:39 +0700
Subject: [PATCH 184/208] Step 22.9: update package.js to include main.ts

---
 packages/socially-browser/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index d0b38f4..f9a49ef 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -24,7 +24,8 @@ Package.onUse(function(api) {
     'client/parties-form/parties-form.ts',
     'client/parties-list/parties-list.html',
     'client/parties-list/parties-list.ts',
-    'system_config.js'
+    'system_config.js',
+    'main.ts'
   ], 'web.browser');
 
   api.addFiles(['client/css/main.css'], 'web.browser');
-- 
2.5.4 (Apple Git-61)


From 110a002f48b771b12ce89d3f020bdd197e68b6f1 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 19:46:26 +0700
Subject: [PATCH 185/208] Step 22.10: update system_config.js to include "main"
 module

---
 packages/socially-browser/system_config.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/packages/socially-browser/system_config.js b/packages/socially-browser/system_config.js
index aa0e70c..c250e1e 100644
--- a/packages/socially-browser/system_config.js
+++ b/packages/socially-browser/system_config.js
@@ -1,7 +1,7 @@
 System.config({
   packages: {
     'socially': {
-      main: 'client/login/login',
+      main: 'main',
       format: 'register',
       map: {
         '.': System.normalizeSync('{socially-browser}')
-- 
2.5.4 (Apple Git-61)


From 1cbfd804f837cbeda04e5083e79895cfb8aae579 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 21:17:52 +0700
Subject: [PATCH 186/208] Step 22.11: import every component from
 "socially-browser"

---
 client/app.ts | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 9051558..71ccf95 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -4,15 +4,11 @@ import {bootstrap} from 'angular2-meteor';
 
 import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig, APP_BASE_HREF} from 'angular2/router';
 
-import {PartiesList} from 'client/parties-list/parties-list';
-
-import {PartyDetails} from 'client/party-details/party-details';
-
 import 'collections/methods';
 
 import {ANGULAR2_GOOGLE_MAPS_PROVIDERS} from 'ng2-google-maps/core';
 
-import {LoginPage, Login} from 'socially'; 
+import {LoginPage, Login, PartiesList, PartyDetails} from 'socially'; 
 
 Accounts.ui.config({
   passwordSignupFields: 'USERNAME_AND_EMAIL'
-- 
2.5.4 (Apple Git-61)


From 5a942800b49eba058cca5ace20f500d99f4a5c56 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 20:02:46 +0700
Subject: [PATCH 187/208] Step 22.12: add browser specific and
 "socially-client" packages

---
 packages/socially-browser/package.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index f9a49ef..53da4c5 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -14,6 +14,9 @@ Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('urigo:angular2-meteor');
   api.use('barbatus:ng2-meteor-accounts-ui', 'web.browser');
+  api.use('barbatus:ng2-pagination', 'web.browser');
+  api.use('barbatus:ng2-google-maps', 'web.browser');
+  api.use('socially-client');
 
   api.addFiles([
     'client/login/login.html',
-- 
2.5.4 (Apple Git-61)


From 63dc69122b8da83dd2252175db0acfabc102da85 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 21:16:42 +0700
Subject: [PATCH 188/208] Clean the app up from the old components

---
 client/css/main.css                     |  4 --
 client/lib/pipes.ts                     | 56 ----------------------
 client/parties-form/parties-form.html   | 11 -----
 client/parties-form/parties-form.ts     | 48 -------------------
 client/parties-list/parties-list.html   | 40 ----------------
 client/parties-list/parties-list.ts     | 84 ---------------------------------
 client/party-details/party-details.html | 40 ----------------
 7 files changed, 283 deletions(-)
 delete mode 100644 client/css/main.css
 delete mode 100644 client/lib/pipes.ts
 delete mode 100644 client/parties-form/parties-form.html
 delete mode 100644 client/parties-form/parties-form.ts
 delete mode 100644 client/parties-list/parties-list.html
 delete mode 100644 client/parties-list/parties-list.ts
 delete mode 100644 client/party-details/party-details.html

diff --git a/client/css/main.css b/client/css/main.css
deleted file mode 100644
index 1484170..0000000
--- a/client/css/main.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.sebm-google-map-container {
-  width: 400px;
-  height: 400px;
-}
diff --git a/client/lib/pipes.ts b/client/lib/pipes.ts
deleted file mode 100644
index dd4da11..0000000
--- a/client/lib/pipes.ts
+++ /dev/null
@@ -1,56 +0,0 @@
-import {Pipe} from 'angular2/core';
-
-import {Parties} from 'collections/parties';
-
-import {MeteorComponent} from 'angular2-meteor';
-
-@Pipe({
-    name: 'displayName'
-})
-export class DisplayName {
-    transform(user: Meteor.User): string {
-        if (!user) {
-            return '';
-        }
-
-        if (user.username) {
-            return user.username;
-        }
-        
-        if (user.emails) {
-            return user.emails[0].address;
-        }
-        
-        return '';
-    }
-}
-
-@Pipe({
-    name: 'rsvp',
-    pure: false
-})
-export class RsvpPipe extends MeteorComponent {
-    init: boolean = false;
-    total: number = 0;
-
-    transform(party: Party, args: any[]): number {
-        let type = args[0];
-        if (!type) {
-            return 0;
-        }
-
-        if (!this.init) {
-            this.autorun(() => {
-                party = Parties.findOne(party._id);
-                if (party) {
-                    this.total = party.rsvps ?
-                        party.rsvps.filter(rsvp => rsvp.response === type).length : 0;
-                }
-            }, true);
-            this.init = true;
-        }
-                    
-        return this.total;
-    }
-}
-
diff --git a/client/parties-form/parties-form.html b/client/parties-form/parties-form.html
deleted file mode 100644
index 54cc2c8..0000000
--- a/client/parties-form/parties-form.html
+++ /dev/null
@@ -1,11 +0,0 @@
-<form [ngFormModel]="partiesForm" #f="ngForm" (submit)="addParty(f.value)">
-  <label>Name</label>
-  <input type="text" ngControl="name">
-  <label>Description</label>
-  <input type="text" ngControl="description">
-  <label>Location</label>
-  <input type="text" ngControl="location">
-  <label>Public</label>
-  <input type="checkbox" ngControl="public">
-  <button>Add</button>
-</form>
diff --git a/client/parties-form/parties-form.ts b/client/parties-form/parties-form.ts
deleted file mode 100644
index 7089ca8..0000000
--- a/client/parties-form/parties-form.ts
+++ /dev/null
@@ -1,48 +0,0 @@
-import {Component, View} from 'angular2/core';
-
-import {FormBuilder, Control, ControlGroup, Validators} from 'angular2/common';
-
-import {Parties} from 'collections/parties';
-
-@Component({
-    selector: 'parties-form'
-})
-@View({
-    templateUrl: '/client/parties-form/parties-form.html'
-})
-export class PartiesForm {
-    partiesForm: ControlGroup;
-
-    constructor() {
-        var fb = new FormBuilder();
-        this.partiesForm = fb.group({
-            name: ['', Validators.required],
-            description: [''],
-            location: ['', Validators.required],
-            public: [false]
-        });
-    }
-
-    addParty(party) {
-        if (this.partiesForm.valid) {
-            if (Meteor.userId()) {
-                Parties.insert({
-                    name: party.name,
-                    description: party.description,
-                    location: {
-                        name: party.location
-                    },
-                    public: party.public,
-                    owner: Meteor.userId()
-                });
-
-                (<Control>this.partiesForm.controls['name']).updateValue('');
-                (<Control>this.partiesForm.controls['description']).updateValue('');
-                (<Control>this.partiesForm.controls['location']).updateValue('');
-                (<Control>this.partiesForm.controls['public']).updateValue(false);
-            } else {
-                alert('Please log in to add a party');
-            }
-        }
-    }
-}
diff --git a/client/parties-list/parties-list.html b/client/parties-list/parties-list.html
deleted file mode 100644
index 53cad56..0000000
--- a/client/parties-list/parties-list.html
+++ /dev/null
@@ -1,40 +0,0 @@
-<div>
-  <parties-form [hidden]="!user" style="float: left"></parties-form>
-  <input type="text" #searchtext placeholder="Search by Location">
-  <button type="button" (click)="search(searchtext.value)">Search</button>
-  <login></login>
-  <h1>Parties:</h1>
-  <div>
-    <select #sort (change)="changeSortOrder(sort.value)">
-      <option value="1" selected>Ascending</option>
-      <option value="-1">Descending</option>
-    </select>
-  </div>
-  <ul>
-    <li *ngFor="#party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}">
-      <a [routerLink]="['/PartyDetails', {partyId: party._id}]">{{party.name}}</a>
-      <p>{{party.description}}</p>
-      <p>{{party.location.name}}</p>
-      <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
-      <div>
-        Who is coming:
-        Yes - {{party | rsvp:'yes'}}
-        Maybe - {{party | rsvp:'maybe'}}
-        No - {{party | rsvp:'no'}}
-      </div>
-    </li>
-  </ul>
-  <sebm-google-map 
-    [latitude]="0"
-    [longitude]="0"
-    [zoom]="1">
-    <div *ngFor="#party of parties">
-      <sebm-google-map-marker
-        *ngIf="party.location.lat"
-        [latitude]="party.location.lat"
-        [longitude]="party.location.lng">
-      </sebm-google-map-marker>
-    </div>
-  </sebm-google-map>
-  <pagination-controls (change)="onPageChanged($event.page)"></pagination-controls>
-</div>
diff --git a/client/parties-list/parties-list.ts b/client/parties-list/parties-list.ts
deleted file mode 100644
index fbf02c3..0000000
--- a/client/parties-list/parties-list.ts
+++ /dev/null
@@ -1,84 +0,0 @@
-import {Component, View} from 'angular2/core';
-
-import {Parties} from 'collections/parties';
-
-import {PartiesForm} from 'client/parties-form/parties-form';
-
-import {RouterLink} from 'angular2/router';
-
-import {AccountsUI} from 'meteor-accounts-ui';
-
-import {InjectUser} from 'meteor-accounts';
-
-import {MeteorComponent} from 'angular2-meteor';
-
-import {PaginationService, PaginatePipe, PaginationControlsCpm} from 'ng2-pagination';
-
-import {RsvpPipe} from 'client/lib/pipes';
-
-import {ANGULAR2_GOOGLE_MAPS_DIRECTIVES} from 'ng2-google-maps/core';
-
-import {Login} from 'socially';
-
-@Component({
-    selector: 'parties-list',
-    viewProviders: [PaginationService]
-})
-@View({
-    templateUrl: '/client/parties-list/parties-list.html',
-    directives: [ANGULAR2_GOOGLE_MAPS_DIRECTIVES, PartiesForm, RouterLink, Login, PaginationControlsCpm],
-    pipes: [PaginatePipe, RsvpPipe]
-})
-@InjectUser()
-export class PartiesList extends MeteorComponent {
-    parties: Mongo.Cursor<Party>;
-    pageSize: number = 10;
-    curPage: ReactiveVar<number> = new ReactiveVar<number>(1);
-    nameOrder: ReactiveVar<number> = new ReactiveVar<number>(1);
-    partiesSize: number = 0;
-    location: ReactiveVar<string> = new ReactiveVar<string>(null);
-    user: Meteor.User;
-
-    constructor() {
-        super();
-        this.autorun(() => {
-            let options = {
-                limit: this.pageSize,
-                skip: (this.curPage.get() - 1) * this.pageSize,
-                sort: { name: this.nameOrder.get() }
-            };
-            this.subscribe('parties', options, this.location.get(), () => {
-                this.parties = Parties.find({}, { sort: { name: this.nameOrder.get() } });
-            }, true);
-        });
-
-        this.autorun(() => {
-            this.partiesSize = Counts.get('numberOfParties');
-        }, true);
-    }
-
-    removeParty(party) {
-        Parties.remove(party._id);
-    }
-
-    search(value: string) {
-        this.curPage.set(1);
-        this.location.set(value);
-    }
-
-    onPageChanged(page: number) {
-        this.curPage.set(page);
-    }
-
-    changeSortOrder(nameOrder: string) {
-        this.nameOrder.set(parseInt(nameOrder));
-    }
-
-    isOwner(party: Party): boolean {
-        if (this.user) {
-            return this.user._id === party.owner;
-        }
-
-        return false;
-    }
-}
diff --git a/client/party-details/party-details.html b/client/party-details/party-details.html
deleted file mode 100644
index 3bda50c..0000000
--- a/client/party-details/party-details.html
+++ /dev/null
@@ -1,40 +0,0 @@
-<form (submit)="saveParty(party)" *ngIf="party">
-  <label>Name</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name">
-
-  <label>Description</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description">
-
-  <label>Location</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name">
-
-  <button [disabled]="!isOwner" type="submit">Save</button>
-  <button [routerLink]="['/PartiesList']">Cancel</button>
-</form>
-
-<ul *ngIf="isOwner || isPublic">
-  Users to invite:
-  <li *ngFor="#user of users">
-    <div>{{ user | displayName }}</div>
-    <button (click)="invite(user)">Invite</button>
-  </li>
-</ul>
-
-<div *ngIf="isInvited">
-  <h2>Reply to the invitation</h2>
-  <input type="button" value="I'm going!" (click)="reply('yes')">
-  <input type="button" value="Maybe" (click)="reply('maybe')">
-  <input type="button" value="No" (click)="reply('no')">
-</div>
-
-<sebm-google-map 
-  [latitude]="lat || centerLat"
-  [longitude]="lng || centerLng"
-  [zoom]="8"
-  (mapClick)="mapClicked($event)">
-  <sebm-google-map-marker
-    *ngIf="lat && lng"
-    [latitude]="lat"
-    [longitude]="lng">
-  </sebm-google-map-marker>
-</sebm-google-map>
-- 
2.5.4 (Apple Git-61)


From 53d29f31f0e5860f6c42d7a2e0311b80ca0ae256 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Wed, 3 Feb 2016 23:14:39 +0700
Subject: [PATCH 189/208] Remove browser specific dependencies from the app

---
 .meteor/packages | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 813486d..065d373 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,13 +16,10 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 urigo:angular2-meteor
 accounts-password
-barbatus:ng2-meteor-accounts-ui
 barbatus:ng2-meteor-accounts
 reactive-var
-barbatus:ng2-pagination
 tmeasday:publish-counts
 check
 email
-barbatus:ng2-google-maps
 socially-mobile
 socially-browser
-- 
2.5.4 (Apple Git-61)


From 3289982ce20965a586f00c6c615e5798a5b5c6ee Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 4 Feb 2016 22:16:53 +0700
Subject: [PATCH 190/208] Step 22.13: add app layout template to the mobile
 package

---
 packages/socially-mobile/client/app.html | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
 create mode 100644 packages/socially-mobile/client/app.html

diff --git a/packages/socially-mobile/client/app.html b/packages/socially-mobile/client/app.html
new file mode 100644
index 0000000..e18a38d
--- /dev/null
+++ b/packages/socially-mobile/client/app.html
@@ -0,0 +1,16 @@
+<ion-menu [content]="content">
+  <ion-toolbar>
+    <ion-title>
+      Socially
+    </ion-title>
+  </ion-toolbar>
+  <ion-content>
+    <ion-list>
+      <button ion-item (click)="openPage(login)" menuClose>
+        Login
+      </button>
+    </ion-list>
+  </ion-content>
+</ion-menu>
+
+<ion-nav id="nav" #content [root]="partiesList"></ion-nav>
-- 
2.5.4 (Apple Git-61)


From bf45ab4ef78b7df7a1dcfdfcf0600f39ac0b4ab2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 4 Feb 2016 22:32:24 +0700
Subject: [PATCH 191/208] Step 22.14: add party details template to the mobile
 package

---
 .../client/party-details/party-details.html        | 58 ++++++++++++++++++++++
 1 file changed, 58 insertions(+)
 create mode 100644 packages/socially-mobile/client/party-details/party-details.html

diff --git a/packages/socially-mobile/client/party-details/party-details.html b/packages/socially-mobile/client/party-details/party-details.html
new file mode 100644
index 0000000..c43aaa7
--- /dev/null
+++ b/packages/socially-mobile/client/party-details/party-details.html
@@ -0,0 +1,58 @@
+<ion-navbar *navbar>
+  <ion-title>
+    Party Details
+  </ion-title>
+</ion-navbar>
+
+<ion-content #content>
+
+  <form (submit)="saveParty(party)" *ngIf="party">
+    <ion-list>
+      <ion-item>
+        <ion-label fixed>Name</ion-label>
+        <ion-input [disabled]="!isOwner" type="text" [(ngModel)]="party.name"></ion-input>
+      </ion-item>
+
+      <ion-item>
+        <ion-label fixed>Description</ion-label>
+        <ion-input [disabled]="!isOwner" type="text" [(ngModel)]="party.description"></ion-input>
+      </ion-item>
+
+      <ion-item>
+        <ion-label fixed>Location</ion-label>
+        <ion-input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name"></ion-input>
+      </ion-item>
+    </ion-list>
+
+    <div padding>
+      <button [disabled]="!isOwner" block type="submit">Save</button>
+    </div>
+  </form>
+
+  <ion-list *ngIf="isOwner && !isPublic">
+    <ion-list-header>
+      Users to invite
+    </ion-list-header>
+    <ion-item *ngFor="#user of users">
+      <div>{{ user | displayName }}</div>
+      <button (click)="invite(user)" outline item-right>
+        Invite
+      </button>
+    </ion-item>
+  </ion-list>
+
+  <ion-list *ngIf="isInvited" inset>
+    <ion-list-header>
+      Reply to the invitation
+    </ion-list-header>
+    <button (click)="reply('yes')" small outline>
+      I'm going!
+    </button>
+    <button (click)="reply('maybe')" small outline>
+      Maybe
+    </button>
+    <button (click)="reply('no')" small outline>
+      No
+    </button>
+  </ion-list>
+</ion-content>
-- 
2.5.4 (Apple Git-61)


From f008771919ddeb32c9f461d937350d7aa79c5414 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 12:50:55 +0700
Subject: [PATCH 192/208] Step 22.15: add party details component

---
 .../client/party-details/party-details.ts              | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 packages/socially-mobile/client/party-details/party-details.ts

diff --git a/packages/socially-mobile/client/party-details/party-details.ts b/packages/socially-mobile/client/party-details/party-details.ts
new file mode 100644
index 0000000..826fb77
--- /dev/null
+++ b/packages/socially-mobile/client/party-details/party-details.ts
@@ -0,0 +1,18 @@
+import {Page, NavController, NavParams} from 'ionic/ionic';
+
+import {RequireUser, InjectUser} from 'meteor-accounts';
+
+import {DisplayName, PartyDetails as PartyDetailsBase} from 'socially-client';
+
+@Page({
+    pipes: [DisplayName],
+    templateUrl: '/packages/socially-mobile/client/party-details/party-details.html',
+})
+@RequireUser()
+@InjectUser()
+export class PartyDetails extends PartyDetailsBase {
+    constructor(params: NavParams) {
+        let partyId = params.get('partyId');
+        super(partyId);
+    }
+}
-- 
2.5.4 (Apple Git-61)


From a6847121b2f9cf728aaa17d5ee6995a037594303 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 4 Feb 2016 22:34:28 +0700
Subject: [PATCH 193/208] Add Ionic 2 party form component and its template

---
 .../client/party-form/party-form.html              | 33 ++++++++++++++++++++++
 .../client/party-form/party-form.ts                |  8 ++++++
 2 files changed, 41 insertions(+)
 create mode 100644 packages/socially-mobile/client/party-form/party-form.html
 create mode 100644 packages/socially-mobile/client/party-form/party-form.ts

diff --git a/packages/socially-mobile/client/party-form/party-form.html b/packages/socially-mobile/client/party-form/party-form.html
new file mode 100644
index 0000000..a493edf
--- /dev/null
+++ b/packages/socially-mobile/client/party-form/party-form.html
@@ -0,0 +1,33 @@
+<ion-navbar *navbar>
+  <ion-title>
+    Create Party
+  </ion-title>
+</ion-navbar>
+
+<ion-content #content>
+  <form [ngFormModel]="partiesForm" #f="ngForm" (submit)="addParty(f.value)">
+    <ion-list>
+      <ion-item>
+        <ion-label fixed>Name</ion-label>
+        <ion-input type="text" ngControl="name"></ion-input>
+      </ion-item>
+      <ion-item>
+        <ion-label fixed>Description</ion-label>
+        <ion-input type="text" ngControl="description"></ion-input>
+      </ion-item>
+      <ion-item>
+        <ion-label fixed>Location</ion-label>
+        <ion-input type="text" ngControl="location"></ion-input>
+      </ion-item>
+      <ion-item>
+        <ion-label>Public</ion-label>
+        <ion-checkbox ngControl="public">
+        </ion-checkbox>
+      </ion-item>
+
+      <div padding>
+        <button block>Create</button>
+      </div>
+    </ion-list>
+  </form>
+</ion-content>
diff --git a/packages/socially-mobile/client/party-form/party-form.ts b/packages/socially-mobile/client/party-form/party-form.ts
new file mode 100644
index 0000000..89b4845
--- /dev/null
+++ b/packages/socially-mobile/client/party-form/party-form.ts
@@ -0,0 +1,8 @@
+import {Page, NavController} from 'ionic/ionic';
+
+import {PartiesForm as PartiesFormBase} from 'socially-client';
+
+@Page({
+    templateUrl: '/packages/socially-mobile/client/party-form/party-form.html'
+})
+export class PartiesForm extends PartiesFormBase {}
-- 
2.5.4 (Apple Git-61)


From b30e929f973aa0a492bf9eb17ba21bdf189762ec Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 4 Feb 2016 22:34:58 +0700
Subject: [PATCH 194/208] Step 22.16: add Ionic 2 parties list template

---
 .../client/parties-list/parties-list.html          | 57 ++++++++++++++++++++++
 1 file changed, 57 insertions(+)
 create mode 100644 packages/socially-mobile/client/parties-list/parties-list.html

diff --git a/packages/socially-mobile/client/parties-list/parties-list.html b/packages/socially-mobile/client/parties-list/parties-list.html
new file mode 100644
index 0000000..2f07b7e
--- /dev/null
+++ b/packages/socially-mobile/client/parties-list/parties-list.html
@@ -0,0 +1,57 @@
+<ion-navbar *navbar>
+  <ion-buttons start>
+    <button menuToggle>
+      <ion-icon name='menu'></ion-icon>
+    </button>
+  </ion-buttons>
+
+  <ion-title>
+    Parties
+  </ion-title>
+
+  <ion-buttons end>
+    <button (click)="addParty()">
+      <ion-icon name='add'></ion-icon>
+    </button>
+  </ion-buttons>
+</ion-navbar>
+
+<ion-content #content>
+  <ion-list inset>
+    <ion-item *ngFor="#party of parties">
+      {{party.name}}
+      <div item-right class="stats">
+        <ion-row center>
+          <ion-col>Yes</ion-col>
+          <ion-col>Maybe</ion-col>
+          <ion-col>No</ion-col>
+        </ion-row>
+        <ion-row center>
+          <ion-col>
+            <ion-badge light>
+              {{party | rsvp:'yes'}}
+            </ion-badge>
+          </ion-col>
+          <ion-col>
+            <ion-badge light>
+              {{party | rsvp:'maybe'}}
+            </ion-badge>
+          </ion-col>
+          <ion-col>
+            <ion-badge light>
+              {{party | rsvp:'no'}}
+            </ion-badge>
+          </ion-col>
+        </ion-row>
+      </div>
+      <button [hidden]="!isOwner(party)" clear item-right danger (click)="removeParty(party)">
+        <ion-icon name="close-circle">
+        </ion-icon>
+      </button>
+      <button clear item-right [navPush]="partyDetails" [navParams]="{partyId: party._id}">
+        <ion-icon name="arrow-forward">
+        </ion-icon>
+      </button>
+    </ion-item>
+  </ion-list>
+</ion-content>
-- 
2.5.4 (Apple Git-61)


From 342343fcedc4aecc70fa86117f6ace46e1848c30 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Thu, 4 Feb 2016 22:35:13 +0700
Subject: [PATCH 195/208] Step 22.17: add Ionic 2 parties list component

---
 .../client/parties-list/parties-list.ts            | 30 ++++++++++++++++++++++
 1 file changed, 30 insertions(+)
 create mode 100644 packages/socially-mobile/client/parties-list/parties-list.ts

diff --git a/packages/socially-mobile/client/parties-list/parties-list.ts b/packages/socially-mobile/client/parties-list/parties-list.ts
new file mode 100644
index 0000000..da02a23
--- /dev/null
+++ b/packages/socially-mobile/client/parties-list/parties-list.ts
@@ -0,0 +1,30 @@
+
+import {Type} from 'angular2/core';
+
+import {Page, NavController} from 'ionic/ionic';
+
+import {InjectUser} from 'meteor-accounts';
+
+import {PartiesForm} from './../party-form/party-form';
+
+import {PartyDetails} from './../party-details/party-details';
+
+import {RsvpPipe, PartiesList as PartiesListBase} from 'socially-client';
+
+@Page({
+    pipes: [RsvpPipe],
+    templateUrl: '/packages/socially-mobile/client/parties-list/parties-list.html',
+})
+@InjectUser()
+export class PartiesList extends PartiesListBase {
+    partyDetails: Type;
+
+    constructor(private nav: NavController) {
+        super();
+        this.partyDetails = PartyDetails;
+    }
+
+    addParty() {
+        this.nav.push(PartiesForm);
+    }
+}
-- 
2.5.4 (Apple Git-61)


From b3e943e205789717cd4e4ee715cde08d3c84f398 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:29:09 +0700
Subject: [PATCH 196/208] Delete Login component from the mobile package

---
 packages/socially-mobile/client/login/login.html |  1 -
 packages/socially-mobile/client/login/login.ts   | 15 ---------------
 2 files changed, 16 deletions(-)
 delete mode 100644 packages/socially-mobile/client/login/login.html
 delete mode 100644 packages/socially-mobile/client/login/login.ts

diff --git a/packages/socially-mobile/client/login/login.html b/packages/socially-mobile/client/login/login.html
deleted file mode 100644
index 37c8acd..0000000
--- a/packages/socially-mobile/client/login/login.html
+++ /dev/null
@@ -1 +0,0 @@
-<a [routerLink]="['/LoginPage']">Login</a>
diff --git a/packages/socially-mobile/client/login/login.ts b/packages/socially-mobile/client/login/login.ts
deleted file mode 100644
index 2d3b84b..0000000
--- a/packages/socially-mobile/client/login/login.ts
+++ /dev/null
@@ -1,15 +0,0 @@
-
-import {Component} from 'angular2/core';
-
-import {ROUTER_DIRECTIVES} from 'angular2/router';
-
-import {MeteorComponent} from 'angular2-meteor';
-
-export * from './login-page';
-
-@Component({
-  selector: 'login',
-  templateUrl: '/packages/socially-mobile/client/login/login.html',
-  directives: [ROUTER_DIRECTIVES]
-})
-export class Login {}
-- 
2.5.4 (Apple Git-61)


From 9f6f199abf104706a9c77e7be4271d71b78372bb Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:29:30 +0700
Subject: [PATCH 197/208] Step 22.18: add Ionic 2 login page template

---
 .../socially-mobile/client/login/login-page.html   | 34 +++++++++++++++++-----
 1 file changed, 26 insertions(+), 8 deletions(-)

diff --git a/packages/socially-mobile/client/login/login-page.html b/packages/socially-mobile/client/login/login-page.html
index ea5e8e0..d7dd7a4 100644
--- a/packages/socially-mobile/client/login/login-page.html
+++ b/packages/socially-mobile/client/login/login-page.html
@@ -1,9 +1,27 @@
-<div *ngIf="phoneStage">
-  <input type="text" placeholder="Phone Number" [(ngModel)]="phoneNumber">
-  <button (click)="requestVerification">Send</button>
-</div>
+<ion-navbar *navbar>
+  <ion-title>
+    Login
+  </ion-title>
+</ion-navbar>
 
-<div *ngIf="!phoneStage">
-  <input type="text" placeholder="Enter Code" [(ngModel)]="verCode">
-  <button (click)="verifyPhone">Verify</button>
-</div>
+<ion-content #content>
+  <ion-list *ngIf="!user">
+    <ion-item *ngIf="phoneStage">
+      <ion-label floating>Phone Number</ion-label>
+      <ion-input type="text" [(ngModel)]="phoneNumber"></ion-input>
+    </ion-item>
+    <ion-item *ngIf="!phoneStage">
+      <ion-label floating>Enter Code</ion-label>
+      <ion-input type="text" [(ngModel)]="verCode"></ion-input>
+    </ion-item>
+  </ion-list>
+
+  <div *ngIf="!user" padding>
+    <button *ngIf="phoneStage" (click)="requestVerification" block>Send</button>
+    <button *ngIf="!phoneStage" (click)="verifyPhone" block>Verify</button>
+  </div>
+
+  <div *ngIf="user" padding>
+    <button type="button" block (click)="logout()">LogOut</button>
+  </div>
+</ion-content>
-- 
2.5.4 (Apple Git-61)


From 686090a7d269316b74c1b5b6d17fed68d8222359 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:35:38 +0700
Subject: [PATCH 198/208] Step 22.19: convert login page component to Ionic 2

---
 packages/socially-mobile/client/login/login-page.ts | 19 ++++++++++++++-----
 1 file changed, 14 insertions(+), 5 deletions(-)

diff --git a/packages/socially-mobile/client/login/login-page.ts b/packages/socially-mobile/client/login/login-page.ts
index 561abac..2442956 100644
--- a/packages/socially-mobile/client/login/login-page.ts
+++ b/packages/socially-mobile/client/login/login-page.ts
@@ -1,18 +1,23 @@
 
+import {NavController, Page} from 'ionic/ionic';
+
 import {Component} from 'angular2/core';
 
 import {Router} from 'angular2/router';
 
-@Component({
-  selector: 'login-page',
-  templateUrl: '/packages/socially-mobile/client/login/login-page.html'
+import {AccountsService, InjectUser} from 'meteor-accounts';
+
+@Page({
+  templateUrl: '/packages/socially-mobile/client/login/login-page.html',
+  providers: [AccountsService]
 })
 export class LoginPage {
   phoneNumber: string;
   verCode: string;
   phoneStage: boolean = true;
 
-  constructor(private router: Router) {}
+  constructor(private nav: NavController,
+              private accounts: AccountsService) {}
 
   requestVerification() {
     Accounts.requestPhoneVerification(this.phoneNumber);
@@ -22,8 +27,12 @@ export class LoginPage {
   verifyPhone() {
     Accounts.verifyPhone(this.phoneNumber, this.verCode, (err) => {
       if (!err) {
-        this.router.navigateByUrl('/');
+        this.nav.pop();
       }
     });
   }
+
+  logout() {
+    this.accounts.logout();
+  }
 }
-- 
2.5.4 (Apple Git-61)


From 65da2b2f8832ac470121a9f4a9b16f82ea5ca13d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:43:22 +0700
Subject: [PATCH 199/208] Add main.ts to define package exports

---
 packages/socially-mobile/main.ts | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 packages/socially-mobile/main.ts

diff --git a/packages/socially-mobile/main.ts b/packages/socially-mobile/main.ts
new file mode 100644
index 0000000..5a955c0
--- /dev/null
+++ b/packages/socially-mobile/main.ts
@@ -0,0 +1,8 @@
+
+export * from './client/login/login-page';
+
+export * from './client/party-form/party-form';
+
+export * from './client/parties-list/parties-list';
+
+export * from './client/party-details/party-details';
-- 
2.5.4 (Apple Git-61)


From 3daf8075a232e9f108ec71ca31636f8e6baba97e Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:45:56 +0700
Subject: [PATCH 200/208] Step 22.20: update mobile package.js

---
 packages/socially-mobile/package.js | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 0ea1138..e3e3e1e 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -12,15 +12,21 @@ Package.describe({
 
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
-  api.use('urigo:angular2-meteor');
+  api.use('barbatus:ionic2-meteor', 'web.cordova');
   api.use('okland:accounts-phone', 'web.cordova');
+  api.use('socially-client');
 
   api.addFiles([
-    'client/login/login.html',
-    'client/login/login.ts',
     'client/login/login-page.html',
     'client/login/login-page.ts',
-    'system_config.js'
+    'client/party-details/party-details.html',
+    'client/party-details/party-details.ts',
+    'client/party-form/party-form.html',
+    'client/party-form/party-form.ts',
+    'client/parties-list/parties-list.html',
+    'client/parties-list/parties-list.ts',
+    'system_config.js',
+    'main.ts'
     ], 'web.cordova');
 });
 
-- 
2.5.4 (Apple Git-61)


From 17f090f6f4020828b19a18852b421cac1afff9e4 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 14:46:26 +0700
Subject: [PATCH 201/208] Update mobile system_config.js

---
 packages/socially-mobile/system_config.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/packages/socially-mobile/system_config.js b/packages/socially-mobile/system_config.js
index 097cd14..0b59e39 100644
--- a/packages/socially-mobile/system_config.js
+++ b/packages/socially-mobile/system_config.js
@@ -1,7 +1,7 @@
 System.config({
   packages: {
     'socially': {
-      main: 'client/login/login',
+      main: 'main',
       format: 'register',
       map: {
         '.': System.normalizeSync('{socially-mobile}')
-- 
2.5.4 (Apple Git-61)


From 32468d2f32a88adc99090f98eda0d0f0c9a0c92d Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 14:52:40 +0700
Subject: [PATCH 202/208] Add CSS styles

---
 packages/socially-mobile/client/css/main.css | 13 +++++++++++++
 packages/socially-mobile/package.js          |  1 +
 2 files changed, 14 insertions(+)
 create mode 100644 packages/socially-mobile/client/css/main.css

diff --git a/packages/socially-mobile/client/css/main.css b/packages/socially-mobile/client/css/main.css
new file mode 100644
index 0000000..9d64880
--- /dev/null
+++ b/packages/socially-mobile/client/css/main.css
@@ -0,0 +1,13 @@
+.stats ion-row {
+  padding: 0
+}
+
+.stats ion-row:first-child {
+  font-size: 8px;
+  white-space: nowrap;
+  text-align: center;
+}
+
+.stats ion-badge {
+  font-size: 10px;
+}
diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index e3e3e1e..7384fb3 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -25,6 +25,7 @@ Package.onUse(function(api) {
     'client/party-form/party-form.ts',
     'client/parties-list/parties-list.html',
     'client/parties-list/parties-list.ts',
+    'client/css/main.css',
     'system_config.js',
     'main.ts'
     ], 'web.cordova');
-- 
2.5.4 (Apple Git-61)


From 5bda58d993df504a0ef759c358023f86f48352e3 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 16:56:55 +0700
Subject: [PATCH 203/208] Step 22.21: customize MeteorApp decorator and add
 base app class

---
 packages/socially-browser/app.ts | 47 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 47 insertions(+)
 create mode 100644 packages/socially-browser/app.ts

diff --git a/packages/socially-browser/app.ts b/packages/socially-browser/app.ts
new file mode 100644
index 0000000..7af5e2d
--- /dev/null
+++ b/packages/socially-browser/app.ts
@@ -0,0 +1,47 @@
+import {Injectable, Component, View, provide} from 'angular2/core';
+
+import {MeteorApp as MeteorAppBase} from 'angular2-meteor';
+
+import {Router, ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig, APP_BASE_HREF} from 'angular2/router';
+
+import {ANGULAR2_GOOGLE_MAPS_PROVIDERS} from 'ng2-google-maps/core';
+
+import {PartiesList} from './client/parties-list/parties-list'; 
+
+import {PartyDetails} from './client/party-details/party-details'; 
+
+Accounts.ui.config({
+  passwordSignupFields: 'USERNAME_AND_EMAIL'
+});
+
+@Injectable()
+export class NavProvider {
+    router: Router;
+
+    constructor(router: Router) {
+        this.router = router;
+    }
+
+    get(): Router {
+        return this.router;
+    }
+}
+
+export function MeteorApp() {
+    return MeteorAppBase({
+        template: '&lt;router-outlet></router-outlet>',
+        directives: [ROUTER_DIRECTIVES],
+        providers: [NavProvider, ROUTER_PROVIDERS, ANGULAR2_GOOGLE_MAPS_PROVIDERS, provide(APP_BASE_HREF, { useValue: '/' })]
+    });
+}
+
+export class App {
+    constructor(navProvider: NavProvider) {
+        let router = navProvider.get();
+        router.config([
+            {path: '/', component: PartiesList},
+            {path: '/party/:partyId', as: 'PartyDetails', component: PartyDetails}
+        ]);
+    }
+}
+
-- 
2.5.4 (Apple Git-61)


From c2355bb4f4b555302879e91be746bb05c56950c2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 16:58:01 +0700
Subject: [PATCH 204/208] Step 22.22: export app.ts

---
 packages/socially-browser/main.ts | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

diff --git a/packages/socially-browser/main.ts b/packages/socially-browser/main.ts
index 31a8019..5428f6e 100644
--- a/packages/socially-browser/main.ts
+++ b/packages/socially-browser/main.ts
@@ -1,8 +1,2 @@
 
-export * from './client/login/login';
-
-export * from './client/parties-form/parties-form';
-
-export * from './client/parties-list/parties-list';
-
-export * from './client/party-details/party-details';
+export * from './app';
-- 
2.5.4 (Apple Git-61)


From 2e5107aca2c1a28ab83868d183c20e3bd71ca828 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 13:44:26 +0700
Subject: [PATCH 205/208] Add app.ts to the package.js

---
 packages/socially-browser/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 53da4c5..dce954b 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -28,7 +28,8 @@ Package.onUse(function(api) {
     'client/parties-list/parties-list.html',
     'client/parties-list/parties-list.ts',
     'system_config.js',
-    'main.ts'
+    'main.ts',
+    'app.ts'
   ], 'web.browser');
 
   api.addFiles(['client/css/main.css'], 'web.browser');
-- 
2.5.4 (Apple Git-61)


From dcc7dc2f9d5db19c124e6bb433204a03d1b7a9d2 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Fri, 5 Feb 2016 17:01:26 +0700
Subject: [PATCH 206/208] Step 22.23: update Socially class to the final
 version

---
 client/app.ts | 36 +++++++-----------------------------
 1 file changed, 7 insertions(+), 29 deletions(-)

diff --git a/client/app.ts b/client/app.ts
index 71ccf95..4a3cfb2 100644
--- a/client/app.ts
+++ b/client/app.ts
@@ -1,31 +1,9 @@
-import {Component, View, NgZone, provide} from 'angular2/core';
+import {MeteorApp, App, NavProvider} from 'socially'; 
 
-import {bootstrap} from 'angular2-meteor';
+@MeteorApp()
+class Socially extends App {
+    constructor(navProvider: NavProvider) {
+        super(navProvider);
+    }
+}
 
-import {ROUTER_PROVIDERS, ROUTER_DIRECTIVES, RouteConfig, APP_BASE_HREF} from 'angular2/router';
-
-import 'collections/methods';
-
-import {ANGULAR2_GOOGLE_MAPS_PROVIDERS} from 'ng2-google-maps/core';
-
-import {LoginPage, Login, PartiesList, PartyDetails} from 'socially'; 
-
-Accounts.ui.config({
-  passwordSignupFields: 'USERNAME_AND_EMAIL'
-});
-
-@Component({
-    selector: 'app'
-})
-@View({
-    template: '&lt;router-outlet></router-outlet>',
-    directives: [ROUTER_DIRECTIVES]
-})
-@RouteConfig([
-    { path: '/', as: 'PartiesList', component: PartiesList },
-    { path: '/party/:partyId', as: 'PartyDetails', component: PartyDetails },
-    { path: '/login', as: 'LoginPage', component: LoginPage || Login }
-])
-class Socially {}
-
-bootstrap(Socially, [ROUTER_PROVIDERS, ANGULAR2_GOOGLE_MAPS_PROVIDERS, provide(APP_BASE_HREF, { useValue: '/' })]);
-- 
2.5.4 (Apple Git-61)


From 11d7885ec572e80cbbd7dabf72a4d8b0df1b6318 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 13:54:04 +0700
Subject: [PATCH 207/208] Step 22.24: add app.ts to the mobile package

---
 packages/socially-mobile/app.ts | 43 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)
 create mode 100644 packages/socially-mobile/app.ts

diff --git a/packages/socially-mobile/app.ts b/packages/socially-mobile/app.ts
new file mode 100644
index 0000000..a4034c1
--- /dev/null
+++ b/packages/socially-mobile/app.ts
@@ -0,0 +1,43 @@
+
+import {Injectable, Type} from 'angular2/core';
+
+import {NavController, IonicApp} from 'ionic/ionic';
+
+import {MeteorApp as MeteorAppBase} from 'ionic2-meteor';
+
+import {PartiesList} from './client/parties-list/parties-list';
+
+import {LoginPage} from './client/login/login-page';
+
+@Injectable()
+export class NavProvider {
+    constructor(private app: IonicApp) {}
+
+    get(): NavController {
+        return this.app.getComponent('nav');;
+    }
+}
+
+export function MeteorApp() {
+    return MeteorAppBase({
+        templateUrl: '/packages/socially-mobile/client/app.html',
+        providers: [NavProvider]
+    });
+}
+
+export class App {
+    partiesList: Type;
+    login: Type;
+    navProvider: NavProvider;
+
+    constructor(navProvider: NavProvider) {
+        this.navProvider = navProvider;
+        this.login = LoginPage;
+        this.partiesList = PartiesList;
+    }
+
+    openPage(page) {
+        let nav = this.navProvider.get();
+        nav.push(page);
+    }
+}
-- 
2.5.4 (Apple Git-61)


From 9a6c7a9aa44d268cd093506f5615ddfccbdc9114 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Sat, 6 Feb 2016 14:00:41 +0700
Subject: [PATCH 208/208] Export app.ts and update package.js

---
 packages/socially-mobile/main.ts    | 8 +-------
 packages/socially-mobile/package.js | 4 +++-
 2 files changed, 4 insertions(+), 8 deletions(-)

diff --git a/packages/socially-mobile/main.ts b/packages/socially-mobile/main.ts
index 5a955c0..63a0aee 100644
--- a/packages/socially-mobile/main.ts
+++ b/packages/socially-mobile/main.ts
@@ -1,8 +1,2 @@
 
-export * from './client/login/login-page';
-
-export * from './client/party-form/party-form';
-
-export * from './client/parties-list/parties-list';
-
-export * from './client/party-details/party-details';
+export * from './app'
diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 7384fb3..e546839 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -27,7 +27,9 @@ Package.onUse(function(api) {
     'client/parties-list/parties-list.ts',
     'client/css/main.css',
     'system_config.js',
-    'main.ts'
+    'main.ts',
+    'client/app.html',
+    'app.ts'
     ], 'web.cordova');
 });
 
-- 
2.5.4 (Apple Git-61)

From 3accbe461dc7efe10c4f5991721fb3f683e92804 Mon Sep 17 00:00:00 2001
From: barbatus <alex.borodach@gmail.com>
Date: Tue, 9 Feb 2016 17:43:40 +0700
Subject: [PATCH 211/211] Step 22.25: add new typings to the tsconfig.json

---
 tsconfig.json | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/tsconfig.json b/tsconfig.json
index 8e951fb..de8aa63 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -11,9 +11,14 @@
     "typings/ng2-meteor-accounts/ng2-meteor-accounts.d.ts",
     "typings/ng2-pagination/ng2-pagination.d.ts",
     "typings/ng2-google-maps/ng2-google-maps.d.ts",
+    "typings/ionic2-meteor/ionic2-meteor.d.ts",
     "typings/party.d.ts",
     "typings/Counts.d.ts",
+    "typings/socially.d.ts",
     "client/app.ts",
-    "server/main.ts"
+    "server/main.ts",
+    "packages/socially-browser/main.ts",
+    "packages/socially-client/main.ts",
+    "packages/socially-mobile/main.ts"
   ]
 }
-- 
2.5.4 (Apple Git-61)
