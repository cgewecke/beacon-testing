(function(){var Meteor=Package.meteor.Meteor;var Tracker=Package.tracker.Tracker;var Deps=Package.tracker.Deps;var Retry=Package.retry.Retry;var DDP=Package["ddp-client"].DDP;var Mongo=Package.mongo.Mongo;var _=Package.underscore._;var ClientVersions,Autoupdate;(function(){var autoupdateVersion=__meteor_runtime_config__.autoupdateVersion||"unknown";var autoupdateVersionRefreshable=__meteor_runtime_config__.autoupdateVersionRefreshable||"unknown";ClientVersions=new Mongo.Collection("meteor_autoupdate_clientVersions");Autoupdate={};Autoupdate.newClientAvailable=function(){return!!ClientVersions.findOne({_id:"version",version:{$ne:autoupdateVersion}})||!!ClientVersions.findOne({_id:"version-refreshable",version:{$ne:autoupdateVersionRefreshable}})};Autoupdate._ClientVersions=ClientVersions;var knownToSupportCssOnLoad=false;var retry=new Retry({minCount:0,baseTimeout:30*1e3});var failures=0;Autoupdate._retrySubscription=function(){Meteor.subscribe("meteor_autoupdate_clientVersions",{onError:function(error){Meteor._debug("autoupdate subscription failed:",error);failures++;retry.retryLater(failures,function(){Autoupdate._retrySubscription()})},onReady:function(){if(Package.reload){var checkNewVersionDocument=function(doc){var self=this;if(doc._id==="version-refreshable"&&doc.version!==autoupdateVersionRefreshable){autoupdateVersionRefreshable=doc.version;var newCss=doc.assets&&doc.assets.allCss||[];var oldLinks=[];_.each(document.getElementsByTagName("link"),function(link){if(link.className==="__meteor-css__"){oldLinks.push(link)}});var waitUntilCssLoads=function(link,callback){var executeCallback=_.once(callback);link.onload=function(){knownToSupportCssOnLoad=true;executeCallback()};if(!knownToSupportCssOnLoad){var id=Meteor.setInterval(function(){if(link.sheet){executeCallback();Meteor.clearInterval(id)}},50)}};var removeOldLinks=_.after(newCss.length,function(){_.each(oldLinks,function(oldLink){oldLink.parentNode.removeChild(oldLink)})});var attachStylesheetLink=function(newLink){document.getElementsByTagName("head").item(0).appendChild(newLink);waitUntilCssLoads(newLink,function(){Meteor.setTimeout(removeOldLinks,200)})};if(newCss.length!==0){_.each(newCss,function(css){var newLink=document.createElement("link");newLink.setAttribute("rel","stylesheet");newLink.setAttribute("type","text/css");newLink.setAttribute("class","__meteor-css__");newLink.setAttribute("href",Meteor._relativeToSiteRootUrl(css.url));attachStylesheetLink(newLink)})}else{removeOldLinks()}}else if(doc._id==="version"&&doc.version!==autoupdateVersion){handle&&handle.stop();if(Package.reload){Package.reload.Reload._reload()}}};var handle=ClientVersions.find().observe({added:checkNewVersionDocument,changed:checkNewVersionDocument})}}})};Autoupdate._retrySubscription()}).call(this);if(typeof Package==="undefined")Package={};Package.autoupdate={Autoupdate:Autoupdate}})();(function(){var Meteor=Package.meteor.Meteor;var _=Package.underscore._;var Reload;(function(){Reload={};var KEY_NAME="Meteor_Reload";var old_data={};var old_json;var safeSessionStorage=null;try{safeSessionStorage=window.sessionStorage;if(safeSessionStorage){safeSessionStorage.setItem("__dummy__","1");safeSessionStorage.removeItem("__dummy__")}else{safeSessionStorage=null}}catch(e){safeSessionStorage=null}Reload._getData=function(){return safeSessionStorage&&safeSessionStorage.getItem(KEY_NAME)};if(safeSessionStorage){old_json=Reload._getData();safeSessionStorage.removeItem(KEY_NAME)}else{}if(!old_json)old_json="{}";var old_parsed={};try{old_parsed=JSON.parse(old_json);if(typeof old_parsed!=="object"){Meteor._debug("Got bad data on reload. Ignoring.");old_parsed={}}}catch(err){Meteor._debug("Got invalid JSON on reload. Ignoring.")}if(old_parsed.reload&&typeof old_parsed.data==="object"){old_data=old_parsed.data}var providers=[];Reload._onMigrate=function(name,callback){if(!callback){callback=name;name=undefined}providers.push({name:name,callback:callback})};Reload._migrationData=function(name){return old_data[name]};var pollProviders=function(tryReload,options){tryReload=tryReload||function(){};options=options||{};var migrationData={};var remaining=_.clone(providers);var allReady=true;while(remaining.length){var p=remaining.shift();var status=p.callback(tryReload,options);if(!status[0])allReady=false;if(status.length>1&&p.name)migrationData[p.name]=status[1]}if(allReady||options.immediateMigration)return migrationData;else return null};Reload._migrate=function(tryReload,options){var migrationData=pollProviders(tryReload,options);if(migrationData===null)return false;try{var json=JSON.stringify({data:migrationData,reload:true})}catch(err){Meteor._debug("Couldn't serialize data for migration",migrationData);throw err}if(safeSessionStorage){try{safeSessionStorage.setItem(KEY_NAME,json)}catch(err){Meteor._debug("Couldn't save data for migration to sessionStorage",err)}}else{Meteor._debug("Browser does not support sessionStorage. Not saving migration state.")}return true};Reload._withFreshProvidersForTest=function(f){var originalProviders=_.clone(providers);providers=[];try{f()}finally{providers=originalProviders}};var reloading=false;Reload._reload=function(options){options=options||{};if(reloading)return;reloading=true;var tryReload=function(){_.defer(function(){if(Reload._migrate(tryReload,options)){window.location.reload()}})};tryReload()}}).call(this);(function(){Meteor._reload={onMigrate:Reload._onMigrate,migrationData:Reload._migrationData,reload:Reload._reload}}).call(this);if(typeof Package==="undefined")Package={};Package.reload={Reload:Reload}})();(function(){var Meteor=Package.meteor.Meteor;if(typeof Package==="undefined")Package={};Package["hot-code-push"]={}})();Autoupdate=Package.autoupdate.Autoupdate;Reload=Package.reload.Reload;